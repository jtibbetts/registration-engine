  [1m[36mLti2Tp::Registry Load (6.9ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 14:17:05 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"1255704047888", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429823825", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"LI0JIzG+4QOb8B6N3JCYcdUDlS8="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.4ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University513'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 115 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
Completed 500 Internal Server Error in 183ms

TypeError - no implicit conversion of nil into String:
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:114:in `block in substitute_template_values_from_hash'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:113:in `substitute_template_values_from_hash'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:91:in `block in substitute_text_in_all_nodes'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:26:in `block in each_leaf'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:25:in `each_leaf'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:90:in `substitute_text_in_all_nodes'
  /Users/johntibbetts/git/LTI2/lti2_tp/app/models/lti2_tp/tool.rb:7:in `get_tool_profile'
  /Users/johntibbetts/git/LTI2/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:131:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/4ec477e00aae0304/variables" for 127.0.0.1 at 2015-04-23 14:17:05 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 14:17:21 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"1255704047888", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429823825", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"LI0JIzG+4QOb8B6N3JCYcdUDlS8="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Duplicate nonce to one already received
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 8ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 14:17:41 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"8109904240661", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429823861", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"IlVjbKwIAEH/PNt6MIZU7TER1+o="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University513'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 115 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
Completed 500 Internal Server Error in 36ms

TypeError - no implicit conversion of nil into String:
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:114:in `block in substitute_template_values_from_hash'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:113:in `substitute_template_values_from_hash'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:91:in `block in substitute_text_in_all_nodes'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:26:in `block in each_leaf'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:25:in `each_leaf'
  /Users/johntibbetts/git/LTI2/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:90:in `substitute_text_in_all_nodes'
  /Users/johntibbetts/git/LTI2/lti2_tp/app/models/lti2_tp/tool.rb:7:in `get_tool_profile'
  /Users/johntibbetts/git/LTI2/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:131:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/15f0945fd5b04b49/variables" for 127.0.0.1 at 2015-04-23 14:17:41 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 14:17:44 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"8109904240661", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429823861", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"IlVjbKwIAEH/PNt6MIZU7TER1+o="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Duplicate nonce to one already received
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 8ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 14:17:45 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"8109904240661", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429823861", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"IlVjbKwIAEH/PNt6MIZU7TER1+o="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Duplicate nonce to one already received
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 8ms (ActiveRecord: 0.7ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-23 16:50:32 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"9978203583469", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429833032", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"9i8ko79BPpkrbx7825Mni6GoBLE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University513'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 115 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.4ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = 'a43b527a38f9ea486ea442dabf83a514', `status` = 'received', `updated_at` = '2015-04-23 23:50:33' WHERE `lti2_tp_registrations`.`id` = 119[0m
  [1m[35m (12.5ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=119&return_url=/lti2_tp/registrations
Completed 302 Found in 196ms (ActiveRecord: 55.6ms)


Started GET "/lti_registration_wips?registration_id=119&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-23 16:50:33 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"119", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 119 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-23 23:50:33', 'Elan/LuMoS', 119, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University513', '2015-04-23 23:50:33')[0m
  [1m[35m (0.3ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (147.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (159.4ms)
Completed 200 OK in 2188ms (Views: 2150.7ms | ActiveRecord: 19.7ms)


Started PATCH "/lti_registration_wips/202" for 127.0.0.1 at 2015-04-23 16:50:37 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University513"}, "commit"=>"Update Lti registration wip", "id"=>"202"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 202 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 119 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 202 LIMIT 1[0m  [["id", "202"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 119 LIMIT 1  [["id", 119]]
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University513'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (13.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '771f6700-cc41-0132-536f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-23T23:50:37Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"74c33940-cb7b-0132-536b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0bb4f1c1f0d69b123a84158c4a9cffb2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-23 23:50:37' WHERE `lti2_tp_registrations`.`id` = 119[0m
  [1m[35m (9.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-23 23:50:37' WHERE `lti2_tp_registrations`.`id` = 119
  [1m[36m (11.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (5.9ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University513' AND `tenants`.`id` != 115) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=119
Completed 302 Found in 116ms (ActiveRecord: 41.8ms)


Started GET "/lti2_tp/registrations?status=success&&id=119" for 127.0.0.1 at 2015-04-23 16:50:38 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"119"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 119 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started PUT "/lti2_tp/tool_proxies/74c33940-cb7b-0132-536b-20c9d07c6451?correlation=771f6700-cc41-0132-536f-20c9d07c6451" for 127.0.0.1 at 2015-04-23 16:50:51 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"771f6700-cc41-0132-536f-20c9d07c6451", "id"=>"74c33940-cb7b-0132-536b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"74c33940-cb7b-0132-536b-20c9d07c6451", :oauth_nonce=>"7527558875310", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429833051", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pNTu6E2eEl7pKizxF2XxFZlyZ/M="}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"74c33940-cb7b-0132-536b-20c9d07c6451", :oauth_nonce=>"7527558875310", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429833051", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pNTu6E2eEl7pKizxF2XxFZlyZ/M="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University513'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 115 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.4ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University513' AND `tenants`.`id` != 115) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `tenants` SET `secret` = '0bb4f1c1f0d69b123a84158c4a9cffb2', `updated_at` = '2015-04-23 23:50:51' WHERE `tenants`.`id` = 115[0m
  [1m[35m (10.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '0bb4f1c1f0d69b123a84158c4a9cffb2', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-23T23:50:37Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"74c33940-cb7b-0132-536b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/74c340c0-cb7b-0132-536b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0bb4f1c1f0d69b123a84158c4a9cffb2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-23 23:50:51' WHERE `lti2_tp_registrations`.`id` = 119
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
"reregistration complete for 74c33940-cb7b-0132-536b-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 54ms (Views: 2.4ms | ActiveRecord: 13.8ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-23 16:51:01 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2401", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "custom_c"=>"1", "oauth_consumer_key"=>"74c33940-cb7b-0132-536b-20c9d07c6451", "oauth_nonce"=>"2950307071872", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429833061", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"AkrVWgLBLDo9YlA7XyTNHS6AcOI="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '74c33940-cb7b-0132-536b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 115  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.3ms)
Completed 200 OK in 6ms (Views: 0.8ms | ActiveRecord: 0.7ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-24 11:49:50 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"8673099862550", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429901390", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"2voEMAQwVGniv9DB1qG4gNiKXQQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.3ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_consumer_profile_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"13efb090-ccde-0132-5374-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', `updated_at` = '2015-04-24 18:49:51' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations
Completed 302 Found in 167ms (ActiveRecord: 43.9ms)


Started GET "/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-24 11:49:51 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"121", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-24 18:49:51', 'Elan/LuMoS', 121, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1131', '2015-04-24 18:49:51')[0m
  [1m[35m (0.3ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (137.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (150.1ms)
Completed 200 OK in 325ms (Views: 290.2ms | ActiveRecord: 20.5ms)


Started PATCH "/lti_registration_wips/209" for 127.0.0.1 at 2015-04-24 11:49:53 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1131"}, "commit"=>"Update Lti registration wip", "id"=>"209"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 209 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 209 LIMIT 1[0m  [["id", "209"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1  [["id", 121]]
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1131'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '9e1f4630-cce0-0132-5375-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-24T18:49:53Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"42a06fd979b14dfafa6969fb9b90b299\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-24 18:49:53' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (5.9ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-24 18:49:53' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (12.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=failure&lti_errormsg=500-Internal+Server+Error+&lti_errorlog=500-Internal+Server+Error+&&id=121
Completed 302 Found in 93ms (ActiveRecord: 21.5ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=500-Internal+Server+Error+&lti_errorlog=500-Internal+Server+Error+&&id=121" for 127.0.0.1 at 2015-04-24 11:49:53 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"500-Internal Server Error ", "lti_errorlog"=>"500-Internal Server Error ", "id"=>"121"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=500-Internal+Server+Error+&lti_errormsg=500-Internal+Server+Error+&status=failure
Completed 302 Found in 3ms (ActiveRecord: 0.5ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-24 11:52:45 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"5585221912330", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429901565", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"sp4gEY3tsVNrPiP/UAYhdIZyyjQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.3ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (2.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-04-24 18:52:45' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations
Completed 302 Found in 158ms (ActiveRecord: 58.5ms)


Started GET "/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-24 11:52:45 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"121", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-24 18:52:45', 'Elan/LuMoS', 121, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1131', '2015-04-24 18:52:45')[0m
  [1m[35m (0.2ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (123.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (130.7ms)
Completed 200 OK in 312ms (Views: 259.0ms | ActiveRecord: 21.3ms)


Started PATCH "/lti_registration_wips/210" for 127.0.0.1 at 2015-04-24 11:52:47 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1131"}, "commit"=>"Update Lti registration wip", "id"=>"210"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 210 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 210 LIMIT 1[0m  [["id", "210"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1  [["id", 121]]
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1131'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '06284a90-cce1-0132-5376-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-24T18:52:47Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"01ddf6b28aa10f2207e2cd64a08972bf\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-24 18:52:47' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (12.2ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-24 18:52:47' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (12.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=121
Completed 302 Found in 111ms (ActiveRecord: 27.4ms)


Started GET "/lti2_tp/registrations?status=success&&id=121" for 127.0.0.1 at 2015-04-24 11:52:47 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"121"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)


Started PUT "/lti2_tp/tool_proxies/13efae70-ccde-0132-5374-20c9d07c6451?correlation=06284a90-cce1-0132-5376-20c9d07c6451" for 127.0.0.1 at 2015-04-24 11:52:49 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"06284a90-cce1-0132-5376-20c9d07c6451", "id"=>"13efae70-ccde-0132-5374-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"1714937366375", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429901569", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pszvxQqMNR3khXkqipQBSr2+384="}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"1714937366375", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429901569", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pszvxQqMNR3khXkqipQBSr2+384="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.3ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `tenants` SET `secret` = '01ddf6b28aa10f2207e2cd64a08972bf', `updated_at` = '2015-04-24 18:52:49' WHERE `tenants`.`id` = 117[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '01ddf6b28aa10f2207e2cd64a08972bf', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-24T18:52:47Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"01ddf6b28aa10f2207e2cd64a08972bf\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-24 18:52:49' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
"reregistration complete for 13efae70-ccde-0132-5374-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 21ms (Views: 2.2ms | ActiveRecord: 3.9ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-24 11:53:00 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2419", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "custom_tp"=>"1131", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"8977272479512", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429901579", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"RbsDgJ3Z70pdi7jTqn6hehX+OEE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.4ms)
Completed 200 OK in 7ms (Views: 1.1ms | ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-24 12:40:26 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"7309728648267", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429904426", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"+nPibuByNuadKahIh5jrpayQBxc="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-04-24 19:40:26' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations
Completed 302 Found in 137ms (ActiveRecord: 5.6ms)


Started GET "/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-24 12:40:26 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"121", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-24 19:40:26', 'Elan/LuMoS', 121, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1131', '2015-04-24 19:40:26')
  [1m[36m (6.3ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (57.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (62.9ms)
Completed 200 OK in 362ms (Views: 345.2ms | ActiveRecord: 7.8ms)


Started PATCH "/lti_registration_wips/211" for 127.0.0.1 at 2015-04-24 12:40:28 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1131"}, "commit"=>"Update Lti registration wip", "id"=>"211"}
  [1m[35mLtiRegistrationWip Load (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 211 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 211 LIMIT 1  [["id", "211"]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m  [["id", 121]]
  [1m[35mTenant Load (0.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1131'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'af44ad90-cce7-0132-5376-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-24T19:40:28Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0b134cae0ce8aaab42c0b4f6aef86257\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-24 19:40:28' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (6.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-24 19:40:28' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (11.8ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=121
Completed 302 Found in 93ms (ActiveRecord: 22.3ms)


Started GET "/lti2_tp/registrations?status=success&&id=121" for 127.0.0.1 at 2015-04-24 12:40:28 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"121"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 4ms (ActiveRecord: 0.6ms)


Started PUT "/lti2_tp/tool_proxies/13efae70-ccde-0132-5374-20c9d07c6451?correlation=af44ad90-cce7-0132-5376-20c9d07c6451" for 127.0.0.1 at 2015-04-24 12:40:30 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"af44ad90-cce7-0132-5376-20c9d07c6451", "id"=>"13efae70-ccde-0132-5374-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"3206831540501", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429904430", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"5pkF7J6SasqtCYPr6gMVn82s+mk="}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"3206831540501", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429904430", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"5pkF7J6SasqtCYPr6gMVn82s+mk="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `tenants` SET `secret` = '0b134cae0ce8aaab42c0b4f6aef86257', `updated_at` = '2015-04-24 19:40:30' WHERE `tenants`.`id` = 117
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (4.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '0b134cae0ce8aaab42c0b4f6aef86257', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-24T19:40:28Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0b134cae0ce8aaab42c0b4f6aef86257\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-24 19:40:30' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (0.8ms)[0m  COMMIT
"reregistration complete for 13efae70-ccde-0132-5374-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 51ms (Views: 0.5ms | ActiveRecord: 8.4ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-24 12:40:40 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2419", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "custom_tp"=>"1131", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"7803481348764", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429904440", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"fp/jA5rwJo3brbfepcfBWXpYqXs="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.4ms)
Completed 200 OK in 8ms (Views: 0.9ms | ActiveRecord: 0.8ms)
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-25 07:06:57 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"8728590640524", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429970817", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"BIKimwrEOmonVQiTEmY0UxSFQ1o="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.4ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.9ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-04-25 14:06:58' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations
Completed 302 Found in 216ms (ActiveRecord: 60.3ms)


Started GET "/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:06:58 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"121", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (3.9ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:06:58', 'Elan/LuMoS', 121, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1131', '2015-04-25 14:06:58')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (153.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (161.5ms)
Completed 200 OK in 415ms (Views: 301.7ms | ActiveRecord: 28.9ms)


Started PATCH "/lti_registration_wips/212" for 127.0.0.1 at 2015-04-25 07:07:00 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1131"}, "commit"=>"Update Lti registration wip", "id"=>"212"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 212 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 212 LIMIT 1[0m  [["id", "212"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1  [["id", 121]]
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1131'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '442e6cc0-cd82-0132-5377-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:07:00Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"706ab044290d2a34517f296a070b1c8c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:07:00' WHERE `lti2_tp_registrations`.`id` = 121[0m
  [1m[35m (11.8ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-25 14:07:00' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (11.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (12.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=121
Completed 302 Found in 120ms (ActiveRecord: 39.1ms)


Started GET "/lti2_tp/registrations?status=success&&id=121" for 127.0.0.1 at 2015-04-25 07:07:01 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"121"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)


Started PUT "/lti2_tp/tool_proxies/13efae70-ccde-0132-5374-20c9d07c6451?correlation=442e6cc0-cd82-0132-5377-20c9d07c6451" for 127.0.0.1 at 2015-04-25 07:07:03 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"442e6cc0-cd82-0132-5377-20c9d07c6451", "id"=>"13efae70-ccde-0132-5374-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"7740033963729", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429970823", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"y9SX9d1v4rYpDkoSFPgBKvm5JHc="}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"13efae70-ccde-0132-5374-20c9d07c6451", :oauth_nonce=>"7740033963729", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429970823", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"y9SX9d1v4rYpDkoSFPgBKvm5JHc="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (6.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1131'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1131' AND `tenants`.`id` != 117) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `tenants` SET `secret` = '706ab044290d2a34517f296a070b1c8c', `updated_at` = '2015-04-25 14:07:03' WHERE `tenants`.`id` = 117[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '706ab044290d2a34517f296a070b1c8c', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:07:00Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"13efae70-ccde-0132-5374-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"706ab044290d2a34517f296a070b1c8c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:07:03' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
"reregistration complete for 13efae70-ccde-0132-5374-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 64ms (Views: 3.4ms | ActiveRecord: 13.1ms)


Started POST "/settings" for 127.0.0.1 at 2015-04-25 07:07:43 -0700
Processing by SettingsController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2416", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_tool_proxy_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451", "custom_tool_proxy_binding_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451/context/2", "custom_lti_link_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451/ltilink/2416", "custom_tp"=>"1131", "oauth_consumer_key"=>"13efae70-ccde-0132-5374-20c9d07c6451", "oauth_nonce"=>"7911439826005", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429970862", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"8/UBfFAJql0Rd4v3TCTZPsj9LWs="}
Can't verify CSRF token authenticity
PrePreProcessTenant
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '13efae70-ccde-0132-5374-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 117  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.4ms)
Completed 200 OK in 62ms (Views: 0.9ms | ActiveRecord: 0.7ms)


Started POST "/settings" for 127.0.0.1 at 2015-04-25 07:07:46 -0700
Processing by SettingsController#create as HTML
  Parameters: {"registration_id"=>"121", "custom_tool_proxy_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451", "custom_tool_proxy_binding_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451/context/2", "custom_lti_link_custom_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_settings/13efae70-ccde-0132-5374-20c9d07c6451/ltilink/2416", "toolproxy"=>"tp=1131", "toolproxybinding"=>"", "ltilink"=>""}
Can't verify CSRF token authenticity
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36mTenant Load (0.4ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 117 LIMIT 1[0m
  Rendered text template (0.1ms)
Completed 200 OK in 206ms (Views: 1.2ms | ActiveRecord: 0.9ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:08:04 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66ff6c30-cd82-0132-5378-20c9d07c6451", "reg_key"=>"66ff6a00-cd82-0132-5378-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.5ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-04-25 14:08:05', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '66ff6a00-cd82-0132-5378-20c9d07c6451', '325b68ff74e40e4b570eef8f2ac65f4f', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66ff6c30-cd82-0132-5378-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"66ff6c30-cd82-0132-5378-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-04-25 14:08:05', '2')
  [1m[36m (8.3ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=122&return_url=/lti2_tp/registrations
Completed 302 Found in 116ms (ActiveRecord: 15.3ms)


Started GET "/lti_registration_wips?registration_id=122&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:08:05 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"122", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 122 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:08:05', 'Elan/LuMoS', 122, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-04-25 14:08:05')
  [1m[36m (11.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (13.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (14.8ms)
Completed 200 OK in 53ms (Views: 35.2ms | ActiveRecord: 12.4ms)


Started PATCH "/lti_registration_wips/213" for 127.0.0.1 at 2015-04-25 07:08:10 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"M43il2V3jEVaEPp6JXt1mmJv07NVYlbO1a58pW42DXs=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University708"}, "commit"=>"Update Lti registration wip", "id"=>"213"}
  [1m[35mLtiRegistrationWip Load (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 213 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University708', `updated_at` = '2015-04-25 14:08:10' WHERE `lti_registration_wips`.`id` = 213
  [1m[36m (6.2ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 122 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University708', `updated_at` = '2015-04-25 14:08:10' WHERE `lti2_tp_registrations`.`id` = 122
  [1m[36m (6.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 213 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 122 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University708' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:08:10', 'Elan University708', '2015-04-25 14:08:10')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '6dbcf580-cd82-0132-5377-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:08:10Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"66ff6a00-cd82-0132-5378-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66ff6c30-cd82-0132-5378-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0375489430051f0f18cabb61e27992a3\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:08:10' WHERE `lti2_tp_registrations`.`id` = 122[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-04-25 14:08:10' WHERE `lti2_tp_registrations`.`id` = 122
  [1m[36m (6.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University708' AND `tenants`.`id` != 118) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `tenants` SET `secret` = '0375489430051f0f18cabb61e27992a3', `tenant_key` = '66ff6a00-cd82-0132-5378-20c9d07c6451', `updated_at` = '2015-04-25 14:08:10' WHERE `tenants`.`id` = 118
  [1m[36m (6.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (6.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_id` = 118, `updated_at` = '2015-04-25 14:08:10' WHERE `lti2_tp_registrations`.`id` = 122[0m
  [1m[35m (0.3ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=66ff6a00-cd82-0132-5378-20c9d07c6451&&id=122
Completed 302 Found in 213ms (ActiveRecord: 41.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=66ff6a00-cd82-0132-5378-20c9d07c6451&&id=122" for 127.0.0.1 at 2015-04-25 07:08:10 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"66ff6a00-cd82-0132-5378-20c9d07c6451", "id"=>"122"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 122 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=66ff6a00-cd82-0132-5378-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-25 07:08:21 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2428", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"66ff6a00-cd82-0132-5378-20c9d07c6451", "oauth_nonce"=>"9556017819982", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429970901", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"2SuteKSkKNtqhwwupgVhmxPO0zc="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '66ff6a00-cd82-0132-5378-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 118  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.4ms)
Completed 200 OK in 6ms (Views: 0.9ms | ActiveRecord: 0.6ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:10:04 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451", "reg_key"=>"af02cf60-cd82-0132-5378-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-04-25 14:10:04', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'af02cf60-cd82-0132-5378-20c9d07c6451', '926b0b232648a5f2986ea37f156dceb0', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"af02d8e0-cd82-0132-5378-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-04-25 14:10:04', '2')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=123&return_url=/lti2_tp/registrations
Completed 302 Found in 94ms (ActiveRecord: 5.5ms)


Started GET "/lti_registration_wips?registration_id=123&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:10:04 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"123", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:10:04', 'Elan/LuMoS', 123, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-04-25 14:10:04')
  [1m[36m (6.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (41.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (44.9ms)
Completed 200 OK in 89ms (Views: 75.1ms | ActiveRecord: 7.2ms)


Started PATCH "/lti_registration_wips/214" for 127.0.0.1 at 2015-04-25 07:10:10 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"M43il2V3jEVaEPp6JXt1mmJv07NVYlbO1a58pW42DXs=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University710"}, "commit"=>"Update Lti registration wip", "id"=>"214"}
  [1m[35mLtiRegistrationWip Load (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 214 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.3ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University710', `updated_at` = '2015-04-25 14:10:10' WHERE `lti_registration_wips`.`id` = 214
  [1m[36m (5.9ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University710', `updated_at` = '2015-04-25 14:10:10' WHERE `lti2_tp_registrations`.`id` = 123
  [1m[36m (5.2ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.4ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 214 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University710' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:10:10', 'Elan University710', '2015-04-25 14:10:10')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (2.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b57f5280-cd82-0132-5377-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:10:10Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"af02cf60-cd82-0132-5378-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"157f79ba9a661d61f9b374e72c22cb18\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:10:11' WHERE `lti2_tp_registrations`.`id` = 123[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-04-25 14:10:11' WHERE `lti2_tp_registrations`.`id` = 123
  [1m[36m (5.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University710' AND `tenants`.`id` != 119) LIMIT 1[0m
  [1m[35mSQL (6.3ms)[0m  UPDATE `tenants` SET `secret` = '157f79ba9a661d61f9b374e72c22cb18', `tenant_key` = 'af02cf60-cd82-0132-5378-20c9d07c6451', `updated_at` = '2015-04-25 14:10:11' WHERE `tenants`.`id` = 119
  [1m[36m (5.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_id` = 119, `updated_at` = '2015-04-25 14:10:11' WHERE `lti2_tp_registrations`.`id` = 123[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=af02cf60-cd82-0132-5378-20c9d07c6451&&id=123
Completed 302 Found in 182ms (ActiveRecord: 44.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=af02cf60-cd82-0132-5378-20c9d07c6451&&id=123" for 127.0.0.1 at 2015-04-25 07:10:11 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"af02cf60-cd82-0132-5378-20c9d07c6451", "id"=>"123"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=af02cf60-cd82-0132-5378-20c9d07c6451
Completed 302 Found in 3ms (ActiveRecord: 0.5ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-25 07:10:21 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2437", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"af02cf60-cd82-0132-5378-20c9d07c6451", "oauth_nonce"=>"2676972495340", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429971020", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"cOadan0w03Ttym6nTzxc9mzjqTM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'af02cf60-cd82-0132-5378-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 119  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (1.2ms)
Completed 200 OK in 10ms (Views: 2.0ms | ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-25 07:10:44 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"af02cf60-cd82-0132-5378-20c9d07c6451", "oauth_nonce"=>"5698327051782", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429971043", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"A+tLd6uMU3mJnwAWRITeCkLmOTo="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'af02cf60-cd82-0132-5378-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 119  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University710'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 119 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.3ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '157f79ba9a661d61f9b374e72c22cb18', `status` = 'received', `updated_at` = '2015-04-25 14:10:44' WHERE `lti2_tp_registrations`.`id` = 123
  [1m[36m (10.9ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=123&return_url=/lti2_tp/registrations
Completed 302 Found in 66ms (ActiveRecord: 18.9ms)


Started GET "/lti_registration_wips?registration_id=123&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:10:44 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"123", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:10:44', 'Elan/LuMoS', 123, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University710', '2015-04-25 14:10:44')
  [1m[36m (16.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (15.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (17.4ms)
Completed 200 OK in 56ms (Views: 34.7ms | ActiveRecord: 17.7ms)


Started PATCH "/lti_registration_wips/215" for 127.0.0.1 at 2015-04-25 07:10:46 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University710"}, "commit"=>"Update Lti registration wip", "id"=>"215"}
  [1m[35mLtiRegistrationWip Load (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 215 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 215 LIMIT 1  [["id", "215"]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1[0m  [["id", 123]]
  [1m[35mTenant Load (0.3ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University710'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'ca8c5800-cd82-0132-5377-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:10:46Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"af02cf60-cd82-0132-5378-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"06a73ecebbba07c5bfe698a1d492befe\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:10:46' WHERE `lti2_tp_registrations`.`id` = 123
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-25 14:10:46' WHERE `lti2_tp_registrations`.`id` = 123[0m
  [1m[35m (6.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.3ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University710' AND `tenants`.`id` != 119) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=123
Completed 302 Found in 76ms (ActiveRecord: 15.8ms)


Started GET "/lti2_tp/registrations?status=success&&id=123" for 127.0.0.1 at 2015-04-25 07:10:46 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"123"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 123 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started PUT "/lti2_tp/tool_proxies/af02cf60-cd82-0132-5378-20c9d07c6451?correlation=ca8c5800-cd82-0132-5377-20c9d07c6451" for 127.0.0.1 at 2015-04-25 07:10:48 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"ca8c5800-cd82-0132-5377-20c9d07c6451", "id"=>"af02cf60-cd82-0132-5378-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"af02cf60-cd82-0132-5378-20c9d07c6451", :oauth_nonce=>"451726430986", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429971048", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"tshDlwTtA6QENkqP4JxT97XVcL0="}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'af02cf60-cd82-0132-5378-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 119  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"af02cf60-cd82-0132-5378-20c9d07c6451", :oauth_nonce=>"451726430986", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429971048", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"tshDlwTtA6QENkqP4JxT97XVcL0="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University710'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 119  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 119 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University710' AND `tenants`.`id` != 119) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `tenants` SET `secret` = '06a73ecebbba07c5bfe698a1d492befe', `updated_at` = '2015-04-25 14:10:48' WHERE `tenants`.`id` = 119
  [1m[36m (5.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (4.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '06a73ecebbba07c5bfe698a1d492befe', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/13efb090-ccde-0132-5374-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:10:46Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"af02cf60-cd82-0132-5378-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/af02d8e0-cd82-0132-5378-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"06a73ecebbba07c5bfe698a1d492befe\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:10:48' WHERE `lti2_tp_registrations`.`id` = 123[0m
  [1m[35m (0.5ms)[0m  COMMIT
"reregistration complete for af02cf60-cd82-0132-5378-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 26ms (Views: 0.6ms | ActiveRecord: 12.4ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-25 07:10:58 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2437", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"af02cf60-cd82-0132-5378-20c9d07c6451", "oauth_nonce"=>"2735604181783", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429971058", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"fVN0lo7CUvQzxaAV9eIVYsLctPY="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'af02cf60-cd82-0132-5378-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 119  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.4ms)
Completed 200 OK in 7ms (Views: 1.0ms | ActiveRecord: 0.6ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:55:22 -0700
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451", "reg_key"=>"0260e530-cd89-0132-5379-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.3ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (7.1ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-04-25 14:55:22', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '0260e530-cd89-0132-5379-20c9d07c6451', '21b9cdad1c57e824005af8d5848b6136', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"0261cc10-cd89-0132-5379-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-04-25 14:55:22', '2')[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=124&return_url=/lti2_tp/registrations
Completed 302 Found in 130ms (ActiveRecord: 36.6ms)


Started GET "/lti_registration_wips?registration_id=124&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:55:22 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"124", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:55:22', 'Elan/LuMoS', 124, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-04-25 14:55:22')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (179.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (190.4ms)
Completed 200 OK in 385ms (Views: 344.8ms | ActiveRecord: 22.4ms)


Started PATCH "/lti_registration_wips/216" for 127.0.0.1 at 2015-04-25 07:55:29 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"M43il2V3jEVaEPp6JXt1mmJv07NVYlbO1a58pW42DXs=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University755"}, "commit"=>"Update Lti registration wip", "id"=>"216"}
  [1m[36mLtiRegistrationWip Load (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 216 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University755', `updated_at` = '2015-04-25 14:55:29' WHERE `lti_registration_wips`.`id` = 216[0m
  [1m[35m (11.2ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University755', `updated_at` = '2015-04-25 14:55:29' WHERE `lti2_tp_registrations`.`id` = 124[0m
  [1m[35m (5.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 216 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University755' LIMIT 1
  [1m[36mSQL (6.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:55:29', 'Elan University755', '2015-04-25 14:55:29')[0m
  [1m[35m (10.9ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '09b7d950-cd89-0132-537a-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:55:29Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"0260e530-cd89-0132-5379-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"543c4212f5dba09b9033bcc3cb8dcc2b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:55:29' WHERE `lti2_tp_registrations`.`id` = 124
  [1m[36m (11.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-04-25 14:55:29' WHERE `lti2_tp_registrations`.`id` = 124[0m
  [1m[35m (12.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.4ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University755' AND `tenants`.`id` != 120) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `tenants` SET `secret` = '543c4212f5dba09b9033bcc3cb8dcc2b', `tenant_key` = '0260e530-cd89-0132-5379-20c9d07c6451', `updated_at` = '2015-04-25 14:55:29' WHERE `tenants`.`id` = 120[0m
  [1m[35m (5.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 120, `updated_at` = '2015-04-25 14:55:29' WHERE `lti2_tp_registrations`.`id` = 124
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=0260e530-cd89-0132-5379-20c9d07c6451&&id=124
Completed 302 Found in 384ms (ActiveRecord: 91.4ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=0260e530-cd89-0132-5379-20c9d07c6451&&id=124" for 127.0.0.1 at 2015-04-25 07:55:29 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"0260e530-cd89-0132-5379-20c9d07c6451", "id"=>"124"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=0260e530-cd89-0132-5379-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-04-25 07:55:33 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"0260e530-cd89-0132-5379-20c9d07c6451", "oauth_nonce"=>"5565164592406", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429973733", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"D3f+t4hsi3+nTLupNkPVcFKEgzs="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.4ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '0260e530-cd89-0132-5379-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 120  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University755'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 120 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (6.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '543c4212f5dba09b9033bcc3cb8dcc2b', `status` = 'received', `updated_at` = '2015-04-25 14:55:33' WHERE `lti2_tp_registrations`.`id` = 124[0m
  [1m[35m (16.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=124&return_url=/lti2_tp/registrations
Completed 302 Found in 84ms (ActiveRecord: 25.8ms)


Started GET "/lti_registration_wips?registration_id=124&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-04-25 07:55:33 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"124", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-04-25 14:55:33', 'Elan/LuMoS', 124, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University755', '2015-04-25 14:55:33')[0m
  [1m[35m (6.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (12.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (14.1ms)
Completed 200 OK in 49ms (Views: 36.8ms | ActiveRecord: 6.9ms)


Started PATCH "/lti_registration_wips/217" for 127.0.0.1 at 2015-04-25 07:55:36 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IQFZGw6wnlWi/3CBlIM3+AF7VnawHoFXbIG63BJKK5Q=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University755"}, "commit"=>"Update Lti registration wip", "id"=>"217"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 217 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 217 LIMIT 1[0m  [["id", "217"]]
  [1m[35mCACHE (0.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1  [["id", 124]]
  [1m[36mTenant Load (0.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University755'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '0dc16ae0-cd89-0132-537a-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:55:36Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"0260e530-cd89-0132-5379-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"7d183162b125ae8db3424eab62d703ce\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:55:36' WHERE `lti2_tp_registrations`.`id` = 124[0m
  [1m[35m (6.4ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-04-25 14:55:36' WHERE `lti2_tp_registrations`.`id` = 124
  [1m[36m (6.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University755' AND `tenants`.`id` != 120) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=124
Completed 302 Found in 106ms (ActiveRecord: 22.3ms)


Started GET "/lti2_tp/registrations?status=success&&id=124" for 127.0.0.1 at 2015-04-25 07:55:36 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"124"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 124 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started PUT "/lti2_tp/tool_proxies/0260e530-cd89-0132-5379-20c9d07c6451?correlation=0dc16ae0-cd89-0132-537a-20c9d07c6451" for 127.0.0.1 at 2015-04-25 07:55:37 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"0dc16ae0-cd89-0132-537a-20c9d07c6451", "id"=>"0260e530-cd89-0132-5379-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"0260e530-cd89-0132-5379-20c9d07c6451", :oauth_nonce=>"394584708449", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429973737", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"oQqwjcbXPlCR1IAkAmfQtOJrRgs="}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '0260e530-cd89-0132-5379-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 120  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"0260e530-cd89-0132-5379-20c9d07c6451", :oauth_nonce=>"394584708449", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1429973737", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"oQqwjcbXPlCR1IAkAmfQtOJrRgs="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University755'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 120  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.2ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 120 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.3ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University755' AND `tenants`.`id` != 120) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `tenants` SET `secret` = '7d183162b125ae8db3424eab62d703ce', `updated_at` = '2015-04-25 14:55:37' WHERE `tenants`.`id` = 120[0m
  [1m[35m (4.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = '7d183162b125ae8db3424eab62d703ce', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-04-25T14:55:36Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"0260e530-cd89-0132-5379-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0261cc10-cd89-0132-5379-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"7d183162b125ae8db3424eab62d703ce\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-04-25 14:55:37' WHERE `lti2_tp_registrations`.`id` = 124
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
"reregistration complete for 0260e530-cd89-0132-5379-20c9d07c6451"
  Rendered text template (0.0ms)
Completed 200 OK in 26ms (Views: 2.6ms | ActiveRecord: 9.8ms)


Started POST "/echoes" for 127.0.0.1 at 2015-04-25 07:55:46 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"2446", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"0260e530-cd89-0132-5379-20c9d07c6451", "oauth_nonce"=>"3577614796015", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1429973746", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"9pK8jVq6vfY89oLBT1hrJ11P718="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '0260e530-cd89-0132-5379-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 120  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (0.3ms)
Completed 200 OK in 9ms (Views: 1.3ms | ActiveRecord: 0.8ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (0.4ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:01:21 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.8ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451", "reg_key"=>"e7a3f530-d61d-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (1.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:01:22', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'e7a3f530-d61d-0132-88ed-20c9d07c6451', '6fb272bded7b3c67af72a72cf991d280', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:01:22', '2')[0m
  [1m[35m (2.2ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=1&return_url=/lti2_tp/registrations
Completed 302 Found in 514ms (ActiveRecord: 15.2ms)


Started GET "/lti_registration_wips?registration_id=1&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:01:22 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"1", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:01:22', 'Elan/LuMoS', 1, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:01:22')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2177.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2203.9ms)
Completed 200 OK in 3275ms (Views: 3109.0ms | ActiveRecord: 4.8ms)


Started PATCH "/lti_registration_wips/1" for 127.0.0.1 at 2015-05-06 09:01:34 -0400
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"+LNGKUlHZyaIdfF/ro2I5S5tDt5OHWNN3zlEqmt/BN8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University901"}, "commit"=>"Update Lti registration wip", "id"=>"1"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 1 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University901', `updated_at` = '2015-05-06 13:01:34' WHERE `lti_registration_wips`.`id` = 1[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University901', `updated_at` = '2015-05-06 13:01:34' WHERE `lti2_tp_registrations`.`id` = 1[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (1.1ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 1 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (5.1ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University901' LIMIT 1
  [1m[36mSQL (2.3ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:01:34', 'Elan University901', '2015-05-06 13:01:34')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'a70ca6d0-d61e-0132-88ee-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-05-06T13:01:34Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"e7a3f530-d61d-0132-88ed-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"6c19707301d076fd40c12ffd53062091\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-05-06 13:06:37' WHERE `lti2_tp_registrations`.`id` = 1
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-05-06 13:06:37' WHERE `lti2_tp_registrations`.`id` = 1[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (3.1ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University901' AND `tenants`.`id` != 1) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '6c19707301d076fd40c12ffd53062091', `tenant_key` = 'e7a3f530-d61d-0132-88ed-20c9d07c6451', `updated_at` = '2015-05-06 13:06:37' WHERE `tenants`.`id` = 1[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 1, `updated_at` = '2015-05-06 13:06:37' WHERE `lti2_tp_registrations`.`id` = 1
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=e7a3f530-d61d-0132-88ed-20c9d07c6451&&id=1
Completed 302 Found in 303510ms (ActiveRecord: 32.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=e7a3f530-d61d-0132-88ed-20c9d07c6451&&id=1" for 127.0.0.1 at 2015-05-06 09:06:38 -0400
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"e7a3f530-d61d-0132-88ed-20c9d07c6451", "id"=>"1"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 1 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=e7a3f530-d61d-0132-88ed-20c9d07c6451
Completed 302 Found in 10ms (ActiveRecord: 0.6ms)
  [1m[36mLti2Tp::Registry Load (0.4ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:07:38 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c8f5c420-d61e-0132-88ed-20c9d07c6451", "reg_key"=>"c8f5c000-d61e-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.6ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:07:39', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c8f5c000-d61e-0132-88ed-20c9d07c6451', '2420bb0ddfd2fe3cde1f21c89e60dcc1', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c8f5c420-d61e-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c8f5c420-d61e-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:07:39', '2')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=2&return_url=/lti2_tp/registrations
Completed 302 Found in 473ms (ActiveRecord: 19.2ms)


Started GET "/lti_registration_wips?registration_id=2&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:07:39 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"2", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:07:39', 'Elan/LuMoS', 2, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:07:39')[0m
  [1m[35m (0.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2709.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2737.5ms)
Completed 200 OK in 3864ms (Views: 3708.6ms | ActiveRecord: 4.9ms)


Started PATCH "/lti_registration_wips/2" for 127.0.0.1 at 2015-05-06 09:07:53 -0400
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"+LNGKUlHZyaIdfF/ro2I5S5tDt5OHWNN3zlEqmt/BN8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University907"}, "commit"=>"Update Lti registration wip", "id"=>"2"}
  [1m[36mLtiRegistrationWip Load (1.1ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University907', `updated_at` = '2015-05-06 13:07:53' WHERE `lti_registration_wips`.`id` = 2[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University907', `updated_at` = '2015-05-06 13:07:53' WHERE `lti2_tp_registrations`.`id` = 2[0m
  [1m[35m (1.6ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 2 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University907' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:08:38', 'Elan University907', '2015-05-06 13:08:38')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'ef874e90-d61e-0132-88ef-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-05-06T13:08:38Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"c8f5c000-d61e-0132-88ed-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c8f5c420-d61e-0132-88ed-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"b2cf258546e16aaa90c645382b846dd7\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-05-06 13:08:39' WHERE `lti2_tp_registrations`.`id` = 2
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-05-06 13:08:39' WHERE `lti2_tp_registrations`.`id` = 2[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University907' AND `tenants`.`id` != 2) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = 'b2cf258546e16aaa90c645382b846dd7', `tenant_key` = 'c8f5c000-d61e-0132-88ed-20c9d07c6451', `updated_at` = '2015-05-06 13:08:39' WHERE `tenants`.`id` = 2[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 2, `updated_at` = '2015-05-06 13:08:39' WHERE `lti2_tp_registrations`.`id` = 2
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=c8f5c000-d61e-0132-88ed-20c9d07c6451&&id=2
Completed 302 Found in 46208ms (ActiveRecord: 22.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=c8f5c000-d61e-0132-88ed-20c9d07c6451&&id=2" for 127.0.0.1 at 2015-05-06 09:08:39 -0400
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"c8f5c000-d61e-0132-88ed-20c9d07c6451", "id"=>"2"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 2 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=c8f5c000-d61e-0132-88ed-20c9d07c6451
Completed 302 Found in 12ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:10:32 -0400
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/30ff7b40-d61f-0132-88ed-20c9d07c6451", "reg_key"=>"30ff7650-d61f-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (1.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:10:33', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '30ff7650-d61f-0132-88ed-20c9d07c6451', '2d6d77bf89ab860b6e7cce8fb7c767f7', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/30ff7b40-d61f-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"30ff7b40-d61f-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:10:33', '2')[0m
  [1m[35m (2.6ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=3&return_url=/lti2_tp/registrations
Completed 302 Found in 212ms (ActiveRecord: 4.8ms)


Started GET "/lti_registration_wips?registration_id=3&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:10:33 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"3", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 3 LIMIT 1[0m
  [1m[35m (1.7ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:16:02', 'Elan/LuMoS', 3, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:16:02')[0m
  [1m[35m (4.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (130.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (137.4ms)
Completed 200 OK in 329825ms (Views: 240.3ms | ActiveRecord: 6.9ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:16:48 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/30ff7b40-d61f-0132-88ed-20c9d07c6451", "reg_key"=>"30ff7650-d61f-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (4.6ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:16:49', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '30ff7650-d61f-0132-88ed-20c9d07c6451', '2d6d77bf89ab860b6e7cce8fb7c767f7', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/30ff7b40-d61f-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"30ff7b40-d61f-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:16:49', '2')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=4&return_url=/lti2_tp/registrations
Completed 302 Found in 469ms (ActiveRecord: 15.3ms)


Started GET "/lti_registration_wips?registration_id=4&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:16:49 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"4", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 4 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:17:15', 'Elan/LuMoS', 4, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:17:15')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2196.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2214.0ms)
Completed 200 OK in 28555ms (Views: 2972.0ms | ActiveRecord: 12.5ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:17:18 -0400
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/184372c0-d620-0132-88ed-20c9d07c6451", "reg_key"=>"18436cf0-d620-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:17:18', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '18436cf0-d620-0132-88ed-20c9d07c6451', 'b98ccfe1419af91f10844ad79de05170', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/184372c0-d620-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"184372c0-d620-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:17:18', '2')[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=5&return_url=/lti2_tp/registrations
Completed 302 Found in 186ms (ActiveRecord: 2.9ms)


Started GET "/lti_registration_wips?registration_id=5&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:17:18 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"5", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 5 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:17:29', 'Elan/LuMoS', 5, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:17:29')[0m
  [1m[35m (5.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (148.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (153.4ms)
Completed 200 OK in 11531ms (Views: 264.2ms | ActiveRecord: 7.0ms)


Started PATCH "/lti_registration_wips/5" for 127.0.0.1 at 2015-05-06 09:17:39 -0400
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"+LNGKUlHZyaIdfF/ro2I5S5tDt5OHWNN3zlEqmt/BN8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University551"}, "commit"=>"Update Lti registration wip", "id"=>"5"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 5 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University551', `updated_at` = '2015-05-06 13:17:39' WHERE `lti_registration_wips`.`id` = 5[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 5 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University551', `updated_at` = '2015-05-06 13:17:39' WHERE `lti2_tp_registrations`.`id` = 5[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 5 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 5 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University551' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:18:32', 'Elan University551', '2015-05-06 13:18:32')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '50fe9f40-d620-0132-88f0-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-05-06T13:18:32Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"18436cf0-d620-0132-88ed-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/184372c0-d620-0132-88ed-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"088efe5a7ece3998004fdf03bec0bcfd\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-05-06 13:18:32' WHERE `lti2_tp_registrations`.`id` = 5
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-05-06 13:18:32' WHERE `lti2_tp_registrations`.`id` = 5[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University551' AND `tenants`.`id` != 3) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `tenants` SET `secret` = '088efe5a7ece3998004fdf03bec0bcfd', `tenant_key` = '18436cf0-d620-0132-88ed-20c9d07c6451', `updated_at` = '2015-05-06 13:18:32' WHERE `tenants`.`id` = 3[0m
  [1m[35m (2.8ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 3, `updated_at` = '2015-05-06 13:18:32' WHERE `lti2_tp_registrations`.`id` = 5
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=18436cf0-d620-0132-88ed-20c9d07c6451&&id=5
Completed 302 Found in 53059ms (ActiveRecord: 25.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=18436cf0-d620-0132-88ed-20c9d07c6451&&id=5" for 127.0.0.1 at 2015-05-06 09:18:32 -0400
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"18436cf0-d620-0132-88ed-20c9d07c6451", "id"=>"5"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 5 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=18436cf0-d620-0132-88ed-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:19:00 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5f88a770-d620-0132-88ed-20c9d07c6451", "reg_key"=>"5f88a530-d620-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:19:01', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '5f88a530-d620-0132-88ed-20c9d07c6451', '65ff0ff138bcf5bb5fdb59fdaf2ca1b9', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5f88a770-d620-0132-88ed-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/e7a5b920-d61d-0132-88ed-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"5f88a770-d620-0132-88ed-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:19:01', '2')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=6&return_url=/lti2_tp/registrations
Completed 302 Found in 502ms (ActiveRecord: 15.6ms)


Started GET "/lti_registration_wips?registration_id=6&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:19:01 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"6", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 6 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:20:13', 'Elan/LuMoS', 6, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:20:13')[0m
  [1m[35m (0.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (947.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (961.2ms)
Completed   in 73091ms
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:20:31 -0400
  [1m[35mActiveRecord::SchemaMigration Load (1.0ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/95eedb10-d620-0132-88ed-20c9d07c6451", "reg_key"=>"95eed860-d620-0132-88ed-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 949062ms

JSON::ParserError - 795: unexpected token at '<h2>ToolConsumerProfile not found</h2>':
  json (1.8.2) lib/json/common.rb:155:in `parse'
  json (1.8.2) lib/json/common.rb:334:in `load'
   () Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/lti2-reference-ba98f8d53252/lti2_tp/app/models/lti2_tp/registration.rb:29:in `get_tool_consumer_profile'
   () Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/lti2-reference-ba98f8d53252/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:37:in `create'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/293ff0328427369d/variables" for 127.0.0.1 at 2015-05-06 09:36:21 -0400
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:42:24 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.9ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451", "reg_key"=>"a26a5770-d623-0132-88f1-20c9d07c6451", "reg_password"=>"[FILTERED]", "tc_oauth_half_secret"=>"5f0ff79ce62d8435935d0ad0f8de8319138c37635e31e65f55457715da86cd98839190b8a407563581d073e8e45d78a0e45da9e9adff5e0737b68b222e6c5090549e4b8183c766138f87349774ff68c552f343556a1f309a2995769ac059a3148727702f572f68e03dd4feb2d3514cc983f962e8e1d9ad7786f81676fe5f0a35", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_oauth_half_secret`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:42:25', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'a26a5770-d623-0132-88f1-20c9d07c6451', '95b0ed1805e8abaddd33aa6456e12f21', 'received', 5, 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"a26a59b0-d623-0132-88f1-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:42:25', '2')[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=7&return_url=/lti2_tp/registrations
Completed 302 Found in 418ms (ActiveRecord: 11.9ms)


Started GET "/lti_registration_wips?registration_id=7&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:42:25 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"7", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (8.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 7 LIMIT 1[0m
  [1m[35m (1.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 13:44:57', 'Elan/LuMoS', 7, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 13:44:57')[0m
  [1m[35m (2.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (930.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (945.6ms)
Completed   in 152373ms
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:45:21 -0400
  [1m[35mActiveRecord::SchemaMigration Load (0.9ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0d3f2000-d624-0132-88f1-20c9d07c6451", "reg_key"=>"0d3f1d00-d624-0132-88f1-20c9d07c6451", "reg_password"=>"[FILTERED]", "tc_oauth_half_secret"=>"91c68070aa180c5311709ca162eeff184362ed3ce27f10d77ffb5fc6f8327482f6474f142ac7fbc72feef50624d7b1ff27aa34bb3ae6c2cda044ec0a4e5687387b6d3e71b909fc31c7b2d2b5316d6a3da5d66beac42ca7c94891e830273180c741d16a8285a3a7dc0dba176bb9fd0ca1cf5d47e571d668268a0ef01aab4ecfcb", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_oauth_half_secret`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:45:55', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '0d3f1d00-d624-0132-88f1-20c9d07c6451', 'f0d3ccaecc3bbf926da8719aa810058a', 'received', 91, 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/0d3f2000-d624-0132-88f1-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"0d3f2000-d624-0132-88f1-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:45:55', '2')[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=8&return_url=/lti2_tp/registrations
Completed 302 Found in 219421ms (ActiveRecord: 27.8ms)
  [1m[36mLti2Tp::Registry Load (0.8ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 09:55:41 -0400
  [1m[35mActiveRecord::SchemaMigration Load (1.1ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7cb47ad0-d625-0132-88f1-20c9d07c6451", "reg_key"=>"7cb477c0-d625-0132-88f1-20c9d07c6451", "reg_password"=>"[FILTERED]", "tc_oauth_half_secret"=>"3258cc639834d9305a7561f30b2eae38301244ccf17ed97582bf6f1b63967a08f73432cfc20f53c2eeccc157285af13809d4af3ef79789c0f4056b998973d4aab3fdff438a9c74c456d96fd43a9a253da5e5d00db0ef197d95d3206b4ae2d19f7b879a57badb4f6790856a6ad14dc5a14f2cc30fa0bd22e9ec3e48f703da9ecd", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_oauth_half_secret`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 13:55:53', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '7cb477c0-d625-0132-88f1-20c9d07c6451', '488b0e4041df0ac315a283cc2522231a', 'received', '3258cc639834d9305a7561f30b2eae38301244ccf17ed97582bf6f1b63967a08f73432cfc20f53c2eeccc157285af13809d4af3ef79789c0f4056b998973d4aab3fdff438a9c74c456d96fd43a9a253da5e5d00db0ef197d95d3206b4ae2d19f7b879a57badb4f6790856a6ad14dc5a14f2cc30fa0bd22e9ec3e48f703da9ecd', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7cb47ad0-d625-0132-88f1-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"7cb47ad0-d625-0132-88f1-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 13:55:53', '2')[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=9&return_url=/lti2_tp/registrations
Completed 302 Found in 398761ms (ActiveRecord: 11.5ms)


Started GET "/lti_registration_wips?registration_id=9&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 10:02:20 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"9", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 9 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 14:02:21', 'Elan/LuMoS', 9, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 14:02:21')[0m
  [1m[35m (1.3ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (838.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (853.7ms)
Completed   in 1007ms
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 10:04:45 -0400
  [1m[35mActiveRecord::SchemaMigration Load (1.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c36b3de0-d626-0132-88f1-20c9d07c6451", "reg_key"=>"c36b3b70-d626-0132-88f1-20c9d07c6451", "reg_password"=>"[FILTERED]", "tc_oauth_half_secret"=>"342dfb57e1327e4de7588b514bc8d49bd0ec13079f5b470733abd5a891a9bdf9fc4f6f60404df6755664b4ac04f71dfe64008fec99c342b2ec8c1511e37d092fa03a764c5a0bb5e04f12f39b6e98bc577d7e69ff735595d12b4e2ce97e0c6594ee39fa025d25804c258180c2b65b4d21d343f8652b3153733e1b15dc9e4beea5", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.7ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_oauth_half_secret`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 14:04:56', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c36b3b70-d626-0132-88f1-20c9d07c6451', '8c011c1b400e225c00733fef839e6d0c', 'received', '342dfb57e1327e4de7588b514bc8d49bd0ec13079f5b470733abd5a891a9bdf9fc4f6f60404df6755664b4ac04f71dfe64008fec99c342b2ec8c1511e37d092fa03a764c5a0bb5e04f12f39b6e98bc577d7e69ff735595d12b4e2ce97e0c6594ee39fa025d25804c258180c2b65b4d21d343f8652b3153733e1b15dc9e4beea5', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c36b3de0-d626-0132-88f1-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c36b3de0-d626-0132-88f1-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 14:04:56', '2')[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=10&return_url=/lti2_tp/registrations
Completed 302 Found in 10107ms (ActiveRecord: 12.9ms)


Started GET "/lti_registration_wips?registration_id=10&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 10:04:56 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"10", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 14:05:03', 'Elan/LuMoS', 10, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 14:05:03')[0m
  [1m[35m (2.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2212.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2233.3ms)
Completed 200 OK in 9970ms (Views: 3073.4ms | ActiveRecord: 9.0ms)


Started PATCH "/lti_registration_wips/9" for 127.0.0.1 at 2015-05-06 10:05:17 -0400
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"+LNGKUlHZyaIdfF/ro2I5S5tDt5OHWNN3zlEqmt/BN8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"1005Elan University"}, "commit"=>"Update Lti registration wip", "id"=>"9"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 9 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = '1005Elan University', `updated_at` = '2015-05-06 14:05:17' WHERE `lti_registration_wips`.`id` = 9[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = '1005Elan University', `updated_at` = '2015-05-06 14:05:17' WHERE `lti2_tp_registrations`.`id` = 10[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 9 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '1005Elan University' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 14:05:17', '1005Elan University', '2015-05-06 14:05:17')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (4.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (8.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '3acdd9b0-d62b-0132-88f2-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a26a59b0-d623-0132-88f1-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-05-06T14:05:17Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"c36b3b70-d626-0132-88f1-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c36b3de0-d626-0132-88f1-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"dc88e399ef4b072ab4be7fb06297f7c1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-05-06 14:36:39' WHERE `lti2_tp_registrations`.`id` = 10
  [1m[36m (6.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-05-06 14:36:39' WHERE `lti2_tp_registrations`.`id` = 10[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '1005Elan University' AND `tenants`.`id` != 4) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `tenants` SET `secret` = 'dc88e399ef4b072ab4be7fb06297f7c1', `tenant_key` = 'c36b3b70-d626-0132-88f1-20c9d07c6451', `updated_at` = '2015-05-06 14:36:39' WHERE `tenants`.`id` = 4[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 4, `updated_at` = '2015-05-06 14:36:39' WHERE `lti2_tp_registrations`.`id` = 10
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=c36b3b70-d626-0132-88f1-20c9d07c6451&&id=10
Completed 302 Found in 1882194ms (ActiveRecord: 38.8ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 11:04:49 -0400
  [1m[35mActiveRecord::SchemaMigration Load (1.0ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451", "reg_key"=>"272ca1c0-d62f-0132-88f5-20c9d07c6451", "reg_password"=>"[FILTERED]", "tc_oauth_half_secret"=>"445174cd7a14bde86948fbad786b0558f8614f80bf3a682a418d9e1d21ec4822e0f1d1ce7780f0ed3858b141491d7b30454ad1b955d3400b3d8cc7e32929929db10d570fbfec1ba31c69f99460e3109962f56821a5d5ca557a81d473b0dc83d857045997add6c7353373b5a8f233b48367fa6ed465104d1d7f2e2dd5dd827651", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (1.1ms)[0m  BEGIN
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_oauth_half_secret`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-05-06 15:04:51', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '272ca1c0-d62f-0132-88f5-20c9d07c6451', '82b63a7fb8233d197c0574953b92c99f', 'received', '445174cd7a14bde86948fbad786b0558f8614f80bf3a682a418d9e1d21ec4822e0f1d1ce7780f0ed3858b141491d7b30454ad1b955d3400b3d8cc7e32929929db10d570fbfec1ba31c69f99460e3109962f56821a5d5ca557a81d473b0dc83d857045997add6c7353373b5a8f233b48367fa6ed465104d1d7f2e2dd5dd827651', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"272caa40-d62f-0132-88f5-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-05-06 15:04:51', '2')[0m
  [1m[35m (1.8ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=12&return_url=/lti2_tp/registrations
Completed 302 Found in 484ms (ActiveRecord: 17.8ms)


Started GET "/lti_registration_wips?registration_id=12&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-05-06 11:04:51 -0400
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"12", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 12 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 15:04:51', 'Elan/LuMoS', 12, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-05-06 15:04:51')[0m
  [1m[35m (2.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2809.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2835.8ms)
Completed 200 OK in 4179ms (Views: 3951.5ms | ActiveRecord: 8.9ms)


Started PATCH "/lti_registration_wips/11" for 127.0.0.1 at 2015-05-06 11:05:04 -0400
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"+LNGKUlHZyaIdfF/ro2I5S5tDt5OHWNN3zlEqmt/BN8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1105"}, "commit"=>"Update Lti registration wip", "id"=>"11"}
  [1m[36mLtiRegistrationWip Load (1.1ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 11 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University1105', `updated_at` = '2015-05-06 15:05:04' WHERE `lti_registration_wips`.`id` = 11[0m
  [1m[35m (1.9ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 12 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University1105', `updated_at` = '2015-05-06 15:05:04' WHERE `lti2_tp_registrations`.`id` = 12[0m
  [1m[35m (1.8ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.9ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 11 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 12 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.2ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University1105' LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-05-06 15:05:04', 'Elan University1105', '2015-05-06 15:05:04')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '3e02e280-d62f-0132-88f6-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-05-06T15:05:05Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"272ca1c0-d62f-0132-88f5-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/272caa40-d62f-0132-88f5-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"2a4aac72d9e07bbbba225495952e7491\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-05-06 15:05:22' WHERE `lti2_tp_registrations`.`id` = 12
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-05-06 15:05:23' WHERE `lti2_tp_registrations`.`id` = 12[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1105' AND `tenants`.`id` != 6) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '2a4aac72d9e07bbbba225495952e7491', `tenant_key` = '272ca1c0-d62f-0132-88f5-20c9d07c6451', `updated_at` = '2015-05-06 15:05:23' WHERE `tenants`.`id` = 6[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_id` = 6, `updated_at` = '2015-05-06 15:05:23' WHERE `lti2_tp_registrations`.`id` = 12
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=272ca1c0-d62f-0132-88f5-20c9d07c6451&&id=12
Completed 302 Found in 18482ms (ActiveRecord: 27.4ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=272ca1c0-d62f-0132-88f5-20c9d07c6451&&id=12" for 127.0.0.1 at 2015-05-06 11:05:23 -0400
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"272ca1c0-d62f-0132-88f5-20c9d07c6451", "id"=>"12"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 12 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=272ca1c0-d62f-0132-88f5-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.6ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[36mLti2Tp::Registry Load (0.4ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 11:42:02 -0700
  [1m[36mActiveRecord::SchemaMigration Load (1.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/736d6b70-fc05-0132-2e20-20c9d07c6451", "reg_key"=>"736d6850-fc05-0132-2e20-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (1.0ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.0ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-23 18:42:03', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '736d6850-fc05-0132-2e20-20c9d07c6451', 'd40e402b79ef7c3c2fa2078707f9afd4', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/736d6b70-fc05-0132-2e20-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/cf6e1180-fc04-0132-2e20-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/cf6e1180-fc04-0132-2e20-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"736d6b70-fc05-0132-2e20-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-23 18:42:03', '2')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=22&return_url=/lti2_tp/registrations
Completed 302 Found in 627ms (ActiveRecord: 18.1ms)


Started GET "/lti_registration_wips?registration_id=22&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 11:42:04 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"22", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (3.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 22 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 18:42:04', 'Elan/LuMoS', 22, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-23 18:42:04')
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (3178.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (3206.8ms)
Completed 200 OK in 4670ms (Views: 4421.6ms | ActiveRecord: 10.4ms)


Started PATCH "/lti_registration_wips/25" for 127.0.0.1 at 2015-06-23 11:42:15 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"1142Elan University"}, "commit"=>"Update Lti registration wip", "id"=>"25"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 25 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = '1142Elan University', `updated_at` = '2015-06-23 18:42:15' WHERE `lti_registration_wips`.`id` = 25
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 22 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = '1142Elan University', `updated_at` = '2015-06-23 18:42:15' WHERE `lti2_tp_registrations`.`id` = 22
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 25 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 22 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '1142Elan University' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 18:42:15', '1142Elan University', '2015-06-23 18:42:15')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '7e3718e0-fc05-0132-2e22-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/cf6e1180-fc04-0132-2e20-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T18:42:15Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"736d6850-fc05-0132-2e20-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/736d6b70-fc05-0132-2e20-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"daae440668576d74911d5c5d0f434cf294249f1c14b2cbc703f7b48cfa01c7f49d26969e136042846f9e4a1576bc5124deb7c4b6ed760681ab634dbd315033f5\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 18:42:15' WHERE `lti2_tp_registrations`.`id` = 22[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (3.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (7.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '---\n\"@context\": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\n\"@type\": ToolProxy\n\"@id\": http://rails.kinexis.com:4000/tools/736d6850-fc05-0132-2e20-20c9d07c6451\ntool_proxy_guid: 736d6850-fc05-0132-2e20-20c9d07c6451\ntc_half_shared_secret: 772b9cd2e385958a820f14029e9cf1b4cc5605ec7172e82953d8d26d2f3dd0ea47a98b24ccac194c091f9132f3aaeb1f2c7b1f1f4fee860cecf12b7d373511cf\n', `updated_at` = '2015-06-23 18:42:16' WHERE `lti2_tp_registrations`.`id` = 22
  [1m[36m (13.7ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 49056ms

NoMethodError - undefined method `+@' for #<String:0x007f97e2be9f20>:
  app/controllers/lti_registration_wips_controller.rb:56:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:28:in `show'
  app/controllers/lti_registration_wips_controller.rb:91:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/1432b10cdc6a682a/variables" for 127.0.0.1 at 2015-06-23 11:43:04 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:43:28 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:43:38 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:44:05 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:44:35 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:44:43 -0700


Started POST "/__better_errors/1432b10cdc6a682a/eval" for 127.0.0.1 at 2015-06-23 11:44:46 -0700
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (4.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '1142Elan University' AND `tenants`.`id` != 21) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = '772b9cd2e385958a820f14029e9cf1b4cc5605ec7172e82953d8d26d2f3dd0ea47a98b24ccac194c091f9132f3aaeb1f2c7b1f1f4fee860cecf12b7d373511cfdaae440668576d74911d5c5d0f434cf294249f1c14b2cbc703f7b48cfa01c7f49d26969e136042846f9e4a1576bc5124deb7c4b6ed760681ab634dbd315033f5', `tenant_key` = '736d6850-fc05-0132-2e20-20c9d07c6451', `updated_at` = '2015-06-23 18:44:46' WHERE `tenants`.`id` = 21
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-23 13:44:28 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a8b38d70-fc13-0132-2e28-20c9d07c6451", "oauth_nonce"=>"8289728874149", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435092268", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"tf+VgPxBJq8QDsLvRQlALbE/41E="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a8b38d70-fc13-0132-2e28-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 25  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University123'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 25 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-23 20:44:30' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (8.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations
Completed 302 Found in 644ms (ActiveRecord: 43.4ms)


Started GET "/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 13:44:30 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"26", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 20:44:30', 'Elan/LuMoS', 26, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University123', '2015-06-23 20:44:30')
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2810.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2832.4ms)
Completed 200 OK in 3829ms (Views: 3675.8ms | ActiveRecord: 6.8ms)


Started PATCH "/lti_registration_wips/34" for 127.0.0.1 at 2015-06-23 13:44:40 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University123"}, "commit"=>"Update Lti registration wip", "id"=>"34"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 34 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 34 LIMIT 1  [["id", "34"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m  [["id", 26]]
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University123'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.4ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '9d6b9d10-fc16-0132-2e2d-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T20:44:49Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"a8b38d70-fc13-0132-2e28-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"ab8a050e4892a053d6d4088390e6f9c70d77e841133efb95a2dd1770b97db4769ec32c471447f63571fb497da934e8f15e9d9b21496e2403eab9d2e7ec0b97dc\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 20:44:49' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-23 20:44:51' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (2.5ms)[0m  COMMIT
Completed 500 Internal Server Error in 17847ms

MultiJson::ParseError - 795: unexpected token at '---
"@context": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId
"@type": ToolProxy
"@id": http://rails.kinexis.com:4000/tools/a8b38d70-fc13-0132-2e28-20c9d07c6451
tool_proxy_guid: a8b38d70-fc13-0132-2e28-20c9d07c6451
tc_half_shared_secret: 64c4c79635efd630fdb07bfef0bfe517b8d10b339bce006e2b25b4b5cb79d02fa808d0f29d0538f096e3c0b54133a4fb0dc40750bd4e725a9a89549bdaba581a
':
  multi_json (1.11.0) lib/multi_json/parse_error.rb:9:in `block (2 levels) in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:7:in `block in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:6:in `build'
  multi_json (1.11.0) lib/multi_json.rb:121:in `rescue in load'
  multi_json (1.11.0) lib/multi_json.rb:118:in `load'
  jsonpath (0.5.1) lib/jsonpath.rb:78:in `process_object'
  jsonpath (0.5.1) lib/jsonpath.rb:64:in `enum_on'
  jsonpath (0.5.1) lib/jsonpath.rb:56:in `on'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:10:in `initialize'
  app/controllers/lti_registration_wips_controller.rb:94:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:66:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:83:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/847df999f0d6c935/variables" for 127.0.0.1 at 2015-06-23 13:44:58 -0700


Started POST "/__better_errors/847df999f0d6c935/eval" for 127.0.0.1 at 2015-06-23 13:45:29 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-23 13:47:46 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a8b38d70-fc13-0132-2e28-20c9d07c6451", "oauth_nonce"=>"5030461434296", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435092465", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"uXMXISeHu6toWHgtGKjCfn7yfy8="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a8b38d70-fc13-0132-2e28-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 25  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University123'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 25 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.3ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-23 20:47:46' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (2.5ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations
Completed 302 Found in 294ms (ActiveRecord: 8.5ms)


Started GET "/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 13:47:46 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"26", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 20:47:46', 'Elan/LuMoS', 26, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University123', '2015-06-23 20:47:46')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (155.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (163.2ms)
Completed 200 OK in 339ms (Views: 295.2ms | ActiveRecord: 2.6ms)


Started PATCH "/lti_registration_wips/35" for 127.0.0.1 at 2015-06-23 13:47:49 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University123"}, "commit"=>"Update Lti registration wip", "id"=>"35"}
  [1m[36mLtiRegistrationWip Load (1.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mCACHE (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 35 LIMIT 1[0m  [["id", "35"]]
  [1m[35mCACHE (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1  [["id", 26]]
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University123'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '0ca35c40-fc17-0132-2e2d-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T20:47:56Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"a8b38d70-fc13-0132-2e28-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"29a03173889b2c3b6c1552923b4a70457465809a548746748b2b152915a054cbc0c29cad453427be45a07fbfa4e6f4422ccba217473606edd930da0626a9057a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 20:47:56' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-23 20:47:58' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 206393ms

MultiJson::ParseError - 795: unexpected token at '---
"@context": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId
"@type": ToolProxy
"@id": http://rails.kinexis.com:4000/tools/a8b38d70-fc13-0132-2e28-20c9d07c6451
tool_proxy_guid: a8b38d70-fc13-0132-2e28-20c9d07c6451
tc_half_shared_secret: 64c4c79635efd630fdb07bfef0bfe517b8d10b339bce006e2b25b4b5cb79d02fa808d0f29d0538f096e3c0b54133a4fb0dc40750bd4e725a9a89549bdaba581a
':
  multi_json (1.11.0) lib/multi_json/parse_error.rb:9:in `block (2 levels) in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:7:in `block in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:6:in `build'
  multi_json (1.11.0) lib/multi_json.rb:121:in `rescue in load'
  multi_json (1.11.0) lib/multi_json.rb:118:in `load'
  jsonpath (0.5.1) lib/jsonpath.rb:78:in `process_object'
  jsonpath (0.5.1) lib/jsonpath.rb:64:in `enum_on'
  jsonpath (0.5.1) lib/jsonpath.rb:56:in `on'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:10:in `initialize'
  app/controllers/lti_registration_wips_controller.rb:94:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:66:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:83:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/9de1150ebb58e523/variables" for 127.0.0.1 at 2015-06-23 13:51:15 -0700
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[36mLti2Tp::Registry Load (6.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.7ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-23 14:00:01 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a8b38d70-fc13-0132-2e28-20c9d07c6451", "oauth_nonce"=>"3997307410210", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435093201", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"xOQN6mq1P2NhIcq0QtXFbEXDzhc="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a8b38d70-fc13-0132-2e28-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 25  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University123'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 25 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-23 21:00:03' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations
Completed 302 Found in 790ms (ActiveRecord: 58.2ms)


Started GET "/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 14:00:03 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"26", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.4ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 21:00:03', 'Elan/LuMoS', 26, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University123', '2015-06-23 21:00:03')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (3251.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (3272.2ms)
Completed 200 OK in 4690ms (Views: 4386.4ms | ActiveRecord: 14.8ms)


Started PATCH "/lti_registration_wips/40" for 127.0.0.1 at 2015-06-23 14:00:11 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University123"}, "commit"=>"Update Lti registration wip", "id"=>"40"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 40 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 40 LIMIT 1  [["id", "40"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m  [["id", 26]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University123'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'cebc5650-fc18-0132-2e32-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T21:00:31Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"a8b38d70-fc13-0132-2e28-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"ea5b66e2a5244f0456fdcd9915b445f2cdf6314423ad2d1d546b70e2019562f3352816c20c3e5a1684ebf63b9a72f63c32a959065bbeee05cc9a426ff82ff830\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 21:00:31' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-23 21:02:06' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (1.4ms)[0m  COMMIT
Completed 500 Internal Server Error in 115040ms

MultiJson::ParseError - 795: unexpected token at '---
"@context": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId
"@type": ToolProxy
"@id": http://rails.kinexis.com:4000/tools/a8b38d70-fc13-0132-2e28-20c9d07c6451
tool_proxy_guid: a8b38d70-fc13-0132-2e28-20c9d07c6451
tc_half_shared_secret: 64c4c79635efd630fdb07bfef0bfe517b8d10b339bce006e2b25b4b5cb79d02fa808d0f29d0538f096e3c0b54133a4fb0dc40750bd4e725a9a89549bdaba581a
':
  multi_json (1.11.0) lib/multi_json/parse_error.rb:9:in `block (2 levels) in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:7:in `block in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:6:in `build'
  multi_json (1.11.0) lib/multi_json.rb:121:in `rescue in load'
  multi_json (1.11.0) lib/multi_json.rb:118:in `load'
  jsonpath (0.5.1) lib/jsonpath.rb:78:in `process_object'
  jsonpath (0.5.1) lib/jsonpath.rb:64:in `enum_on'
  jsonpath (0.5.1) lib/jsonpath.rb:56:in `on'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:10:in `initialize'
  app/controllers/lti_registration_wips_controller.rb:94:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:66:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:83:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/b70aafc2b6e3cb29/variables" for 127.0.0.1 at 2015-06-23 14:02:06 -0700
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-23 14:02:42 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a8b38d70-fc13-0132-2e28-20c9d07c6451", "oauth_nonce"=>"9652018793907", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435093361", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"M0FZvOsFTg76kB7aI/Ab7siCwxY="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a8b38d70-fc13-0132-2e28-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 25  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University123'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 25 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-23 21:02:43' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (6.8ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations
Completed 302 Found in 655ms (ActiveRecord: 42.2ms)


Started GET "/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 14:02:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"26", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 21:02:43', 'Elan/LuMoS', 26, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University123', '2015-06-23 21:02:43')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (3276.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (3305.1ms)
Completed 200 OK in 4430ms (Views: 4240.6ms | ActiveRecord: 7.5ms)


Started PATCH "/lti_registration_wips/41" for 127.0.0.1 at 2015-06-23 14:02:51 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University123"}, "commit"=>"Update Lti registration wip", "id"=>"41"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 41 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 41 LIMIT 1  [["id", "41"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m  [["id", 26]]
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University123'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (3.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '24f9dd10-fc19-0132-2e33-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T21:02:55Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"a8b38d70-fc13-0132-2e28-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"23a6c1db53af757f4d54e09e5d069b7a2456e1f8f47aea1ac5dba4239ae331fc031f7ff0eb7c08321fb21c58dafc0f143dab117cba3ea8ecd0a0ef2f2da4a942\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 21:02:56' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (3.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-23 21:03:10' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (2.9ms)[0m  COMMIT
Completed 500 Internal Server Error in 33580ms

MultiJson::ParseError - 795: unexpected token at '---
"@context": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId
"@type": ToolProxy
"@id": http://rails.kinexis.com:4000/tools/a8b38d70-fc13-0132-2e28-20c9d07c6451
tool_proxy_guid: a8b38d70-fc13-0132-2e28-20c9d07c6451
tc_half_shared_secret: 64c4c79635efd630fdb07bfef0bfe517b8d10b339bce006e2b25b4b5cb79d02fa808d0f29d0538f096e3c0b54133a4fb0dc40750bd4e725a9a89549bdaba581a
':
  multi_json (1.11.0) lib/multi_json/parse_error.rb:9:in `block (2 levels) in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:7:in `block in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:6:in `build'
  multi_json (1.11.0) lib/multi_json.rb:121:in `rescue in load'
  multi_json (1.11.0) lib/multi_json.rb:118:in `load'
  jsonpath (0.5.1) lib/jsonpath.rb:78:in `process_object'
  jsonpath (0.5.1) lib/jsonpath.rb:64:in `enum_on'
  jsonpath (0.5.1) lib/jsonpath.rb:56:in `on'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:10:in `initialize'
  app/controllers/lti_registration_wips_controller.rb:94:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:66:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:83:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/a5ebb98554161023/variables" for 127.0.0.1 at 2015-06-23 14:03:24 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-23 14:03:39 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a8b38d70-fc13-0132-2e28-20c9d07c6451", "oauth_nonce"=>"1626021509911", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435093418", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"H0sIvNYFWVqwjIMX7g63kYpdRkE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a8b38d70-fc13-0132-2e28-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 25  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University123'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 25 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-23 21:03:39' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (3.2ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations
Completed 302 Found in 291ms (ActiveRecord: 9.0ms)


Started GET "/lti_registration_wips?registration_id=26&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-23 14:03:39 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"26", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-23 21:03:39', 'Elan/LuMoS', 26, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University123', '2015-06-23 21:03:39')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (180.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (186.8ms)
Completed 200 OK in 387ms (Views: 319.7ms | ActiveRecord: 4.1ms)


Started PATCH "/lti_registration_wips/42" for 127.0.0.1 at 2015-06-23 14:03:41 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University123"}, "commit"=>"Update Lti registration wip", "id"=>"42"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 42 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 42 LIMIT 1[0m  [["id", "42"]]
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 26 LIMIT 1  [["id", 26]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University123'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '44a4b910-fc19-0132-2e33-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-23T21:03:49Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"a8b38d70-fc13-0132-2e28-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a8b65f70-fc13-0132-2e28-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"3eb3be000d06df301771d34a71cb31de0437bf9ab3e024036da5af8deb7e20e6f97168210aeac55744c87e290ca9099245d7307cce305ba16dc5a580c2803d30\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-23 21:03:49' WHERE `lti2_tp_registrations`.`id` = 26[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-23 21:04:05' WHERE `lti2_tp_registrations`.`id` = 26
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 9640611ms

MultiJson::ParseError - 795: unexpected token at '---
"@context": http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId
"@type": ToolProxy
"@id": http://rails.kinexis.com:4000/tools/a8b38d70-fc13-0132-2e28-20c9d07c6451
tool_proxy_guid: a8b38d70-fc13-0132-2e28-20c9d07c6451
tc_half_shared_secret: 64c4c79635efd630fdb07bfef0bfe517b8d10b339bce006e2b25b4b5cb79d02fa808d0f29d0538f096e3c0b54133a4fb0dc40750bd4e725a9a89549bdaba581a
':
  multi_json (1.11.0) lib/multi_json/parse_error.rb:9:in `block (2 levels) in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:7:in `block in build'
  multi_json (1.11.0) lib/multi_json/parse_error.rb:6:in `build'
  multi_json (1.11.0) lib/multi_json.rb:121:in `rescue in load'
  multi_json (1.11.0) lib/multi_json.rb:118:in `load'
  jsonpath (0.5.1) lib/jsonpath.rb:78:in `process_object'
  jsonpath (0.5.1) lib/jsonpath.rb:64:in `enum_on'
  jsonpath (0.5.1) lib/jsonpath.rb:56:in `on'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/json_wrapper.rb:10:in `initialize'
  app/controllers/lti_registration_wips_controller.rb:94:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:66:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:83:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/33992ad09244f415/variables" for 127.0.0.1 at 2015-06-23 16:44:23 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:12:08 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"6118578949888", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435169479", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"49nqMVwfyXM6LazQQZj/hDWuFZw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:12:10' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (7.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 658ms (ActiveRecord: 42.1ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:12:10 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:12:10', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:12:10')
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2927.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2949.1ms)
Completed 200 OK in 4063ms (Views: 3838.9ms | ActiveRecord: 26.2ms)


Started PATCH "/lti_registration_wips/74" for 127.0.0.1 at 2015-06-24 11:12:21 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"74"}
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 74 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 74 LIMIT 1  [["id", "74"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '7f8ef250-fcca-0132-2e46-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:12:28Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b83ddb9d898c2a8908cc387da5a0a2396e955ebbbf08be99eae809d942913e8bb1f6613da01be8bb83198030bddabe05880b259c9df2ab4569445d5655dd6d8a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:12:28' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-24 18:13:15' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (6.5ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 54418ms (ActiveRecord: 15.5ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:13:15 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"37"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 16ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:15:34 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"6565119387800", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435169733", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"xMIg+i0BXtum76Smfv+ub595m8s="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.9ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:15:34' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.4ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 432ms (ActiveRecord: 8.6ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:15:34 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (2.9ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:15:34', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:15:34')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (230.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (240.1ms)
Completed 200 OK in 530ms (Views: 446.5ms | ActiveRecord: 4.8ms)


Started PATCH "/lti_registration_wips/75" for 127.0.0.1 at 2015-06-24 11:15:38 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"75"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 75 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (1.1ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 75 LIMIT 1[0m  [["id", "75"]]
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1  [["id", 37]]
  [1m[36mTenant Load (1.0ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f55764e0-fcca-0132-2e46-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:15:46Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"83bf09f260aa8ad2c5743a5c2159628c31769063d8bd7d27eb3816ca4d83962641595aa52562f20607b3d589d61d14df58ad0f9c5e05ae730ba4eebd24eef7a1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:15:46' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (7.3ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-24 18:16:27' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (1.0ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1[0m
  [1m[35m (0.4ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 48945ms (ActiveRecord: 21.6ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:16:27 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"37"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:16:33 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"9080328617990", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435169792", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"qzOLK18Ukt/jfCFGF13Q//0bP5M="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.1ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (1.0ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.0ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:16:33' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 524ms (ActiveRecord: 10.6ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:16:33 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:16:33', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:16:33')
  [1m[36m (2.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (314.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (321.4ms)
Completed 200 OK in 620ms (Views: 548.0ms | ActiveRecord: 4.8ms)


Started PATCH "/lti_registration_wips/76" for 127.0.0.1 at 2015-06-24 11:16:38 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"76"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 76 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 76 LIMIT 1  [["id", "76"]]
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (1.2ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '14500ee0-fccb-0132-2e46-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:16:38Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"87ea7d665cf3a49a0bacce9d8f5dddea0172326934cb750e09f6aab67cc763d98fee66c76acc8f93759397f2922e4d2de680d0755f6e80e3845c6056f0a998ee\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:16:38' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-24 18:17:02' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 23825ms (ActiveRecord: 17.4ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:17:02 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"37"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 21ms (ActiveRecord: 1.1ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:17:06 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"1663665553995", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435169825", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"kafxIl/vpAOM2V8jWINqdmnA3ik="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.4ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:17:06' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (4.2ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 568ms (ActiveRecord: 12.2ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:17:06 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:17:06', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:17:06')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (262.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (275.6ms)
Completed 200 OK in 542ms (Views: 456.3ms | ActiveRecord: 3.4ms)


Started PATCH "/lti_registration_wips/77" for 127.0.0.1 at 2015-06-24 11:17:10 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"77"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 77 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 77 LIMIT 1[0m  [["id", "77"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1  [["id", 37]]
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '400607f0-fccb-0132-2e46-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:17:18Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"e02b3f3ba291f9341c9768b796101dd136f4e54b9fc8ff5127523ff959984c8b5108079f0d7db61832246562c8354f9903f85f5dbbeec95b79acd53005a907c2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:17:51' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-24 18:18:45' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (1.7ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 94923ms (ActiveRecord: 14.5ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:18:45 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"37"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 12ms (ActiveRecord: 0.6ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:27:27 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"6840940375845", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435170447", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"bewrhewuy5oAe//h7pY3wUVMxYw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:27:28' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (7.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 646ms (ActiveRecord: 49.5ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:27:28 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:27:29', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:27:29')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2522.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2548.8ms)
Completed 200 OK in 3558ms (Views: 3401.9ms | ActiveRecord: 8.7ms)


Started PATCH "/lti_registration_wips/78" for 127.0.0.1 at 2015-06-24 11:27:35 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"78"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 78 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 78 LIMIT 1  [["id", "78"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '9be28080-fccc-0132-2e47-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:27:35Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"019110fa94ab51ac56d15cc9e499f01d1130f38dc950d5344f32acdbe81a6c4e3d8e262eb3fbaf1c50625a6b3cce95a77a2bca39e24df23899d277adda628e06\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:27:35' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '344baaf675f1d3059517aa209f7c7e818175adeb50446844545ff2a861dc63599381ff28b907890b970630c571f8ed70b9f74b407e97e2d53f01514cb89fe617a00f061b6f8e4f8adb2b5cb7e108f13d27bfce6250216f74f5a98eae0cdfabb89ea4c4673b376d3cb5b240ae4d1cb3bd7a59322cbe9e064da1fe438952ea56fa', `status` = 'reregistered', `updated_at` = '2015-06-24 18:28:10' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (12.2ms)[0m  COMMIT
  [1m[36m (1.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 169245ms (ActiveRecord: 24.5ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:30:24 -0700
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 11:42:50 -0700
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"5474069788251", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435171370", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"y5EIPxqomtYsLHz0NrWOgCTK7+U="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1102'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 35 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 18:42:51' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (10.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 636ms (ActiveRecord: 49.3ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 11:42:51 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (2.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 18:42:52', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1102', '2015-06-24 18:42:52')
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2608.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2630.0ms)
Completed 200 OK in 3675ms (Views: 3488.9ms | ActiveRecord: 8.6ms)


Started PATCH "/lti_registration_wips/80" for 127.0.0.1 at 2015-06-24 11:42:58 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1102"}, "commit"=>"Update Lti registration wip", "id"=>"80"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 80 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 80 LIMIT 1  [["id", "80"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1102'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'c2122fd0-fcce-0132-2e49-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T18:42:58Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"05aa7e20-fcc9-0132-2e44-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"7185c550897d2be97db49150a51ad3ba9f55bfc99abeda9fc53c25b33f7d6d37a16c5b69f8f2ce395668347a7209d90bb68640d4a922e3b0c5a2a858bf814a81\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 18:45:37' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (12.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-06-24 18:46:39' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (4.6ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (2.2ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1102' AND `tenants`.`id` != 35) LIMIT 1
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 221484ms (ActiveRecord: 28.1ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-06-24 11:46:39 -0700
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:40:00 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"05aa7e20-fcc9-0132-2e44-20c9d07c6451", "oauth_nonce"=>"5882133119774", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435174799", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"RdmeEe8DdPvqAGAFXEKtSXsngbE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '05aa7e20-fcc9-0132-2e44-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 35  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: ac1a4ca07bf54d29fe0257906520999b489927499846d4c4f0240a85d51352318576cee97d9f7d89ec5424e997f9c3c27720b85b7b8b8b7170cda41a2af5f119630abc6fde7a972aeb2d7f0d1f4660a68b96354bd6281753d4801752b25d10249280af293cca2fe64b14a5ed2283ab85afdedc13555476e6a23c41ce3afa14d4
Verify_signature--send_signature: RdmeEe8DdPvqAGAFXEKtSXsngbE=  test_signature: WcbXvA3IAkRfRtM3y8QVK0E98AM=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D05aa7e20-fcc9-0132-2e44-20c9d07c6451%26oauth_nonce%3D5882133119774%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435174799%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F05ab9100-fcc9-0132-2e44-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 527ms (ActiveRecord: 19.1ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:40:18 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451", "reg_key"=>"c16e6000-fcd6-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 19:40:19', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c16e6000-fcd6-0132-2e4b-20c9d07c6451', 'a5e011e71cc58c32bd672b13d344ba07', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c16e6270-fcd6-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 19:40:19', '2')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=38&return_url=/lti2_tp/registrations
Completed 302 Found in 316ms (ActiveRecord: 16.3ms)


Started GET "/lti_registration_wips?registration_id=38&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:40:19 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"38", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 38 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:40:19', 'Elan/LuMoS', 38, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 19:40:19')
  [1m[36m (2.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2994.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (3017.2ms)
Completed 200 OK in 4097ms (Views: 3909.1ms | ActiveRecord: 13.7ms)


Started PATCH "/lti_registration_wips/83" for 127.0.0.1 at 2015-06-24 12:41:18 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1241"}, "commit"=>"Update Lti registration wip", "id"=>"83"}
  [1m[35mLtiRegistrationWip Load (1.1ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 83 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University1241', `updated_at` = '2015-06-24 19:41:21' WHERE `lti_registration_wips`.`id` = 83
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 38 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (4.1ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University1241', `updated_at` = '2015-06-24 19:41:21' WHERE `lti2_tp_registrations`.`id` = 38
  [1m[36m (5.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (1.1ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 83 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 38 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University1241' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:41:22', 'Elan University1241', '2015-06-24 19:41:22')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'ea705220-fcd6-0132-2e4c-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:41:22Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"c16e6000-fcd6-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"003ab9a23ae45b765822a7e763966e2fc1c1714e47e451c043412b1b420cac546003fef4066079daaf4e269c364355abbdb8f90ae3c8661252e6d64d62dece2c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 19:41:28' WHERE `lti2_tp_registrations`.`id` = 38[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"c16e6000-fcd6-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"f3f63b78793b4cf08d955407d083b0e3d007a36b8da3c6f18617da0aa88094a5159ddb0764d02dd0ec863618aa53b4cabb42243c677320906b8f07e881dfccc3\"}', `updated_at` = '2015-06-24 19:41:36' WHERE `lti2_tp_registrations`.`id` = 38
  [1m[36m (3.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University1241' AND `tenants`.`id` != 36) LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `tenants` SET `secret` = 'f3f63b78793b4cf08d955407d083b0e3d007a36b8da3c6f18617da0aa88094a5159ddb0764d02dd0ec863618aa53b4cabb42243c677320906b8f07e881dfccc3003ab9a23ae45b765822a7e763966e2fc1c1714e47e451c043412b1b420cac546003fef4066079daaf4e269c364355abbdb8f90ae3c8661252e6d64d62dece2c', `updated_at` = '2015-06-24 19:41:36' WHERE `tenants`.`id` = 36
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'f3f63b78793b4cf08d955407d083b0e3d007a36b8da3c6f18617da0aa88094a5159ddb0764d02dd0ec863618aa53b4cabb42243c677320906b8f07e881dfccc3003ab9a23ae45b765822a7e763966e2fc1c1714e47e451c043412b1b420cac546003fef4066079daaf4e269c364355abbdb8f90ae3c8661252e6d64d62dece2c', `tenant_id` = 36, `updated_at` = '2015-06-24 19:41:36' WHERE `lti2_tp_registrations`.`id` = 38[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=c16e6000-fcd6-0132-2e4b-20c9d07c6451&&id=38
Completed 302 Found in 15121ms (ActiveRecord: 44.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=c16e6000-fcd6-0132-2e4b-20c9d07c6451&&id=38" for 127.0.0.1 at 2015-06-24 12:41:36 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"c16e6000-fcd6-0132-2e4b-20c9d07c6451", "id"=>"38"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 38 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=c16e6000-fcd6-0132-2e4b-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:41:44 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c16e6000-fcd6-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"1157573832100", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435174903", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"QJRm0Wx52ihaLMmQQaz1cVQ+NzA="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c16e6000-fcd6-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 70ms

NoMethodError - undefined method `id' for nil:NilClass:
  app/controllers/application_controller.rb:34:in `pre_process_tenant'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:103:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/e660405b9a25d55d/variables" for 127.0.0.1 at 2015-06-24 12:41:45 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:43:25 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c16e6000-fcd6-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"8556094640583", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175005", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"YhAVyCDeNZqofOKGgL6K01G15Kg="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c16e6000-fcd6-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 43ms

NoMethodError - undefined method `id' for nil:NilClass:
  app/controllers/application_controller.rb:34:in `pre_process_tenant'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:103:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/d369a286e27a4952/variables" for 127.0.0.1 at 2015-06-24 12:43:26 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:43:30 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c16e6270-fcd6-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c16e6000-fcd6-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"8556094640583", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175005", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"YhAVyCDeNZqofOKGgL6K01G15Kg="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.1ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c16e6000-fcd6-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 52ms

NoMethodError - undefined method `id' for nil:NilClass:
  app/controllers/application_controller.rb:34:in `pre_process_tenant'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:103:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/866edcda6bc6d251/variables" for 127.0.0.1 at 2015-06-24 12:43:30 -0700


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:45:05 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/6cbd8a20-fcd7-0132-2e4b-20c9d07c6451", "reg_key"=>"6cbd8790-fcd7-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (1.2ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 19:45:05', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '6cbd8790-fcd7-0132-2e4b-20c9d07c6451', '47f66ed46c68311d54c7b9e867680f42', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/6cbd8a20-fcd7-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"6cbd8a20-fcd7-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 19:45:05', '2')[0m
  [1m[35m (2.5ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=39&return_url=/lti2_tp/registrations
Completed 302 Found in 272ms (ActiveRecord: 5.1ms)


Started GET "/lti_registration_wips?registration_id=39&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:45:05 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"39", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 39 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:45:05', 'Elan/LuMoS', 39, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 19:45:05')[0m
  [1m[35m (2.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (230.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (238.8ms)
Completed 200 OK in 425ms (Views: 370.2ms | ActiveRecord: 3.7ms)


Started PATCH "/lti_registration_wips/84" for 127.0.0.1 at 2015-06-24 12:45:11 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University45"}, "commit"=>"Update Lti registration wip", "id"=>"84"}
  [1m[36mLtiRegistrationWip Load (1.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 84 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University45', `updated_at` = '2015-06-24 19:45:11' WHERE `lti_registration_wips`.`id` = 84[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 39 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University45', `updated_at` = '2015-06-24 19:45:11' WHERE `lti2_tp_registrations`.`id` = 39[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 84 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 39 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University45' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:45:15', 'Elan University45', '2015-06-24 19:45:15')[0m
  [1m[35m (2.1ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '7539f130-fcd7-0132-2e4c-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:45:15Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"6cbd8790-fcd7-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/6cbd8a20-fcd7-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f9dba97144dae58f994a2b4ac5245a5d76b923e9cfad8980ebec63b9d1c264d21c9d9d5d9a3fd96c643f5e678ff3602d5666c9ef8d7f996b35b99cf5b9e71892\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 19:45:15' WHERE `lti2_tp_registrations`.`id` = 39
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"6cbd8790-fcd7-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"c1a7520ab8879954045c8acd9fa4191e30b60e08a8ad6fd163065c315c162d57cb1f7de10f960be175af5007d4627048a5aa1e54219fc8505b40d8234cf07b5e\"}', `updated_at` = '2015-06-24 19:45:15' WHERE `lti2_tp_registrations`.`id` = 39[0m
  [1m[35m (11.8ms)[0m  COMMIT
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University45' AND `tenants`.`id` != 37) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = 'c1a7520ab8879954045c8acd9fa4191e30b60e08a8ad6fd163065c315c162d57cb1f7de10f960be175af5007d4627048a5aa1e54219fc8505b40d8234cf07b5ef9dba97144dae58f994a2b4ac5245a5d76b923e9cfad8980ebec63b9d1c264d21c9d9d5d9a3fd96c643f5e678ff3602d5666c9ef8d7f996b35b99cf5b9e71892', `updated_at` = '2015-06-24 19:45:15' WHERE `tenants`.`id` = 37[0m
  [1m[35m (10.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'c1a7520ab8879954045c8acd9fa4191e30b60e08a8ad6fd163065c315c162d57cb1f7de10f960be175af5007d4627048a5aa1e54219fc8505b40d8234cf07b5ef9dba97144dae58f994a2b4ac5245a5d76b923e9cfad8980ebec63b9d1c264d21c9d9d5d9a3fd96c643f5e678ff3602d5666c9ef8d7f996b35b99cf5b9e71892', `tenant_id` = 37, `updated_at` = '2015-06-24 19:45:15' WHERE `lti2_tp_registrations`.`id` = 39
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=6cbd8790-fcd7-0132-2e4b-20c9d07c6451&&id=39
Completed 302 Found in 4165ms (ActiveRecord: 42.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=6cbd8790-fcd7-0132-2e4b-20c9d07c6451&&id=39" for 127.0.0.1 at 2015-06-24 12:45:15 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"6cbd8790-fcd7-0132-2e4b-20c9d07c6451", "id"=>"39"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 39 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=6cbd8790-fcd7-0132-2e4b-20c9d07c6451
Completed 302 Found in 16ms (ActiveRecord: 0.8ms)


Started POST "/echoes" for 127.0.0.1 at 2015-06-24 12:45:40 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"184", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"6cbd8790-fcd7-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"9030043929905", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175139", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"3pgoC2ntxsc5BoeK6oFL6jusU8c="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6cbd8790-fcd7-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 29ms

NoMethodError - undefined method `id' for nil:NilClass:
  app/controllers/application_controller.rb:34:in `pre_process_tenant'
  activesupport (4.1.9) lib/active_support/callbacks.rb:424:in `block in make_lambda'
  activesupport (4.1.9) lib/active_support/callbacks.rb:160:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/4cc979dcf06cb444/variables" for 127.0.0.1 at 2015-06-24 12:45:40 -0700


Started POST "/echoes" for 127.0.0.1 at 2015-06-24 12:46:48 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"184", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"6cbd8790-fcd7-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"1117738336385", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175207", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"IEoQWgJhoZSC9wLnXdXaFV0IyJw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6cbd8790-fcd7-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 37  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (1.9ms)
Completed 200 OK in 60ms (Views: 6.4ms | ActiveRecord: 1.3ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:55:05 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"4274877215740", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175705", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"LddMldCXpfdF4kinLcE3VpOH9cQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1250'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 39 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations
Completed 302 Found in 757ms (ActiveRecord: 40.8ms)


Started GET "/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:55:07 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"41", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:55:07', 'Elan/LuMoS', 41, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1250', '2015-06-24 19:55:07')[0m
  [1m[35m (2.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2652.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2673.1ms)
Completed 200 OK in 3746ms (Views: 3543.3ms | ActiveRecord: 11.1ms)


Started PATCH "/lti_registration_wips/89" for 127.0.0.1 at 2015-06-24 12:55:13 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1250"}, "commit"=>"Update Lti registration wip", "id"=>"89"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 89 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 89 LIMIT 1[0m  [["id", "89"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1  [["id", 41]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1250'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'e0771f00-fcd8-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:55:24Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"7f243ebed4daf636fb3eda5fa6ff85e4699d1384d31f75d6bb41842112d1bd57f8f773a255f9c2456d9a04554483bda53b82ec86c375a0c2e398f4948b5008a6\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 19:55:24' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:55:24Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"7f243ebed4daf636fb3eda5fa6ff85e4699d1384d31f75d6bb41842112d1bd57f8f773a255f9c2456d9a04554483bda53b82ec86c375a0c2e398f4948b5008a6\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"0b1587def424de53fcbe0999e4148fabba49a1daa779b698c26c2d774dbd13fcfee664491dfc4e9340a15bf1ccb33f7a46bdbec441b870297dfb7b4260374e77\"}', `updated_at` = '2015-06-24 19:55:24' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '0b1587def424de53fcbe0999e4148fabba49a1daa779b698c26c2d774dbd13fcfee664491dfc4e9340a15bf1ccb33f7a46bdbec441b870297dfb7b4260374e777f243ebed4daf636fb3eda5fa6ff85e4699d1384d31f75d6bb41842112d1bd57f8f773a255f9c2456d9a04554483bda53b82ec86c375a0c2e398f4948b5008a6', `status` = 'reregistered', `updated_at` = '2015-06-24 19:55:24' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41
Completed 302 Found in 10745ms (ActiveRecord: 11.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41" for 127.0.0.1 at 2015-06-24 12:55:24 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "id"=>"41"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451
Completed 302 Found in 13ms (ActiveRecord: 0.6ms)


Started PUT "/lti2_tp/tool_proxies/25382b80-fcd8-0132-2e4b-20c9d07c6451?correlation=e0771f00-fcd8-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 12:55:38 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"e0771f00-fcd8-0132-2e4f-20c9d07c6451", "id"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"8875779311505", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175738", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"tOKdqFui69MlhcHnDv7QmxFDwVU="}
  [1m[35mTenant Load (1.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"8875779311505", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175738", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"tOKdqFui69MlhcHnDv7QmxFDwVU="}
in verify_signature
Secret: test
Verify_signature--send_signature: tOKdqFui69MlhcHnDv7QmxFDwVU=  test_signature: orv5A63G/6SY6yxIkVMYkclBK9Y=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F25382b80-fcd8-0132-2e4b-20c9d07c6451&correlation%3De0771f00-fcd8-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D8875779311505%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435175738%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 216ms (ActiveRecord: 2.4ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 12:55:39 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (3.8ms)
Completed 200 OK in 196ms (Views: 190.5ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:55:44 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"9808450757713", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175744", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"4F7ZRdvWae8jd88qLUVwslSTbpw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: test
Verify_signature--send_signature: 4F7ZRdvWae8jd88qLUVwslSTbpw=  test_signature: BfT4FdL/19yUb7p9O4CrjUS5KiY=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D9808450757713%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435175744%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F25382eb0-fcd8-0132-2e4b-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 126ms (ActiveRecord: 2.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:57:49 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"7988767314805", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175869", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"FUTJpXhH3FRtS6VE4ZO7MyYpYnA="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1250'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 39 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 19:57:49' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations
Completed 302 Found in 263ms (ActiveRecord: 6.1ms)


Started GET "/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:57:49 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"41", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:57:49', 'Elan/LuMoS', 41, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1250', '2015-06-24 19:57:49')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (176.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (182.1ms)
Completed 200 OK in 344ms (Views: 294.2ms | ActiveRecord: 2.6ms)


Started PATCH "/lti_registration_wips/90" for 127.0.0.1 at 2015-06-24 12:58:01 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1250"}, "commit"=>"Update Lti registration wip", "id"=>"90"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 90 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 90 LIMIT 1  [["id", "90"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m  [["id", 41]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1250'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '44287970-fcd9-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:58:11Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5f326ee92e884853cc306c2e9142d6959dcfcc1b9b7cf6cdd42a7a47b4d66a38f66ccfff0b85708122789ba98e0c4ba3c924006b46a208aa900bf3bf92fe0f3b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 19:58:11' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (2.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:58:11Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5f326ee92e884853cc306c2e9142d6959dcfcc1b9b7cf6cdd42a7a47b4d66a38f66ccfff0b85708122789ba98e0c4ba3c924006b46a208aa900bf3bf92fe0f3b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"1de4e9f8774ac781c41ef2680cd5ef1342f0b981ee11ab01a69493f9b9c6a05d9eb13ed60e6116e58a0c33c8654220da0282f24375725d06ca10b3c331c83e31\"}', `updated_at` = '2015-06-24 19:58:11' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '1de4e9f8774ac781c41ef2680cd5ef1342f0b981ee11ab01a69493f9b9c6a05d9eb13ed60e6116e58a0c33c8654220da0282f24375725d06ca10b3c331c83e315f326ee92e884853cc306c2e9142d6959dcfcc1b9b7cf6cdd42a7a47b4d66a38f66ccfff0b85708122789ba98e0c4ba3c924006b46a208aa900bf3bf92fe0f3b', `status` = 'reregistered', `updated_at` = '2015-06-24 19:58:12' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41
Completed 302 Found in 10392ms (ActiveRecord: 13.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41" for 127.0.0.1 at 2015-06-24 12:58:12 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "id"=>"41"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/25382b80-fcd8-0132-2e4b-20c9d07c6451?correlation=44287970-fcd9-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 12:58:17 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"44287970-fcd9-0132-2e4f-20c9d07c6451", "id"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"9098459235031", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175897", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"VQlNEwcMqGzwS1d1AeIyDhtVziE="}
  [1m[36mTenant Load (1.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"9098459235031", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175897", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"VQlNEwcMqGzwS1d1AeIyDhtVziE="}
in verify_signature
Secret: test
Verify_signature--send_signature: VQlNEwcMqGzwS1d1AeIyDhtVziE=  test_signature: ReWGb8FEwnQVAoCFbr+XHeQKvpo=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F25382b80-fcd8-0132-2e4b-20c9d07c6451&correlation%3D44287970-fcd9-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D9098459235031%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435175897%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 179ms (ActiveRecord: 3.3ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 12:58:18 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.5ms)
Completed 200 OK in 170ms (Views: 165.8ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 12:59:30 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"2458184158163", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435175970", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"ReVWFHbQ1cyiG/szw364dLRBkZ4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1250'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 39 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 19:59:30' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (12.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations
Completed 302 Found in 338ms (ActiveRecord: 17.8ms)


Started GET "/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 12:59:30 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"41", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 19:59:30', 'Elan/LuMoS', 41, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1250', '2015-06-24 19:59:30')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (175.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (181.5ms)
Completed 200 OK in 345ms (Views: 296.0ms | ActiveRecord: 2.6ms)


Started PATCH "/lti_registration_wips/91" for 127.0.0.1 at 2015-06-24 12:59:33 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1250"}, "commit"=>"Update Lti registration wip", "id"=>"91"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 91 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 91 LIMIT 1[0m  [["id", "91"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1  [["id", 41]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1250'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '77eaa470-fcd9-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:59:38Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"37b05d67cbce63a62f330a2e151c4df4b5a501439e637c9edfcb20a9de9b2d27dd17ac05d4e62ff7d418dcdce315da41367d9fffb17a638fbe9e3626986845e8\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 19:59:38' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.9ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T19:59:38Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"37b05d67cbce63a62f330a2e151c4df4b5a501439e637c9edfcb20a9de9b2d27dd17ac05d4e62ff7d418dcdce315da41367d9fffb17a638fbe9e3626986845e8\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"7084b2cce8ff3d6a8dc5130415d07bb513530174c6c4fd9329ddf40fe433be9f7d2521e2bb48e4976ec382fb16662cba5efd7c6c4561b3d391bf18d849dac5dc\"}', `updated_at` = '2015-06-24 19:59:38' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '7084b2cce8ff3d6a8dc5130415d07bb513530174c6c4fd9329ddf40fe433be9f7d2521e2bb48e4976ec382fb16662cba5efd7c6c4561b3d391bf18d849dac5dc37b05d67cbce63a62f330a2e151c4df4b5a501439e637c9edfcb20a9de9b2d27dd17ac05d4e62ff7d418dcdce315da41367d9fffb17a638fbe9e3626986845e8', `status` = 'reregistered', `updated_at` = '2015-06-24 19:59:38' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41
Completed 302 Found in 5402ms (ActiveRecord: 12.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41" for 127.0.0.1 at 2015-06-24 12:59:38 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "id"=>"41"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/25382b80-fcd8-0132-2e4b-20c9d07c6451?correlation=77eaa470-fcd9-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 12:59:46 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"77eaa470-fcd9-0132-2e4f-20c9d07c6451", "id"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"8517501423237", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175986", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"iHUccirekZ6Np3hVmbqjhyr6nc4="}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"8517501423237", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435175986", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"iHUccirekZ6Np3hVmbqjhyr6nc4="}
in verify_signature
Secret: test
Verify_signature--send_signature: iHUccirekZ6Np3hVmbqjhyr6nc4=  test_signature: SAQjy25hkotE7aSgohDH7Au4GE4=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F25382b80-fcd8-0132-2e4b-20c9d07c6451&correlation%3D77eaa470-fcd9-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D8517501423237%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435175986%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 143ms (ActiveRecord: 1.7ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 12:59:46 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.6ms)
Completed 200 OK in 130ms (Views: 126.7ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:08:21 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"618427419230", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435176501", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"mxTGMV5mHrBqVQta+iaBh7vWcqk="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1250'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 39 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 20:08:22' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (11.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations
Completed 302 Found in 296ms (ActiveRecord: 16.9ms)


Started GET "/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:08:22 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"41", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:08:22', 'Elan/LuMoS', 41, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1250', '2015-06-24 20:08:22')
  [1m[36m (6.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (179.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (186.2ms)
Completed 200 OK in 372ms (Views: 305.8ms | ActiveRecord: 9.5ms)


Started PATCH "/lti_registration_wips/92" for 127.0.0.1 at 2015-06-24 13:08:25 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1250"}, "commit"=>"Update Lti registration wip", "id"=>"92"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 92 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 92 LIMIT 1  [["id", "92"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m  [["id", 41]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1250'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b1cf4cb0-fcda-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:08:25Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8cae617b27f15a9cb8062691f4c570e4f7d7f8c2aeeeb1100ffedf1b199a6d51eb45eb31037cc24c7c0bf2b34923e60429a424b42deee073138fa360dfd4a3dd\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:08:25' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:08:25Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8cae617b27f15a9cb8062691f4c570e4f7d7f8c2aeeeb1100ffedf1b199a6d51eb45eb31037cc24c7c0bf2b34923e60429a424b42deee073138fa360dfd4a3dd\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"4fe812690451106f0cc833cd1637b28b0edd6a7ef58f642ecf80e3919a5b05bb6d98eb10f0e3913bddfe3fb92a690d58821cd25a768129782cb7bb9ea1a75494\"}', `updated_at` = '2015-06-24 20:08:25' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.6ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '4fe812690451106f0cc833cd1637b28b0edd6a7ef58f642ecf80e3919a5b05bb6d98eb10f0e3913bddfe3fb92a690d58821cd25a768129782cb7bb9ea1a754948cae617b27f15a9cb8062691f4c570e4f7d7f8c2aeeeb1100ffedf1b199a6d51eb45eb31037cc24c7c0bf2b34923e60429a424b42deee073138fa360dfd4a3dd', `status` = 'reregistered', `updated_at` = '2015-06-24 20:08:25' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41
Completed 302 Found in 491ms (ActiveRecord: 15.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41" for 127.0.0.1 at 2015-06-24 13:08:25 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "id"=>"41"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.6ms)


Started PUT "/lti2_tp/tool_proxies/25382b80-fcd8-0132-2e4b-20c9d07c6451?correlation=b1cf4cb0-fcda-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:08:29 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"b1cf4cb0-fcda-0132-2e4f-20c9d07c6451", "id"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"6734278032945", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176509", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"9Xb+FjivtgYAewENi4SevfJsOW0="}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"6734278032945", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176509", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"9Xb+FjivtgYAewENi4SevfJsOW0="}
in verify_signature
Secret: test
Verify_signature--send_signature: 9Xb+FjivtgYAewENi4SevfJsOW0=  test_signature: cNvR+CWLj7X9mQEYHTCWPs6rsSA=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F25382b80-fcd8-0132-2e4b-20c9d07c6451&correlation%3Db1cf4cb0-fcda-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D6734278032945%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176509%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 13475ms (ActiveRecord: 1.5ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 13:08:49 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.6ms)
Completed 200 OK in 118ms (Views: 114.3ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:09:14 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"9416114522231", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435176553", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"VXrgJBLE3N/wztrHNaH1Rmm87xk="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University1250'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 39 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-06-24 20:09:14' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations
Completed 302 Found in 264ms (ActiveRecord: 6.2ms)


Started GET "/lti_registration_wips?registration_id=41&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:09:14 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"41", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:09:14', 'Elan/LuMoS', 41, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University1250', '2015-06-24 20:09:14')[0m
  [1m[35m (2.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (174.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (180.3ms)
Completed 200 OK in 447ms (Views: 314.9ms | ActiveRecord: 5.6ms)


Started PATCH "/lti_registration_wips/93" for 127.0.0.1 at 2015-06-24 13:09:16 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University1250"}, "commit"=>"Update Lti registration wip", "id"=>"93"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 93 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 93 LIMIT 1[0m  [["id", "93"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1  [["id", 41]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University1250'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd0b9edf0-fcda-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:09:17Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b60f7eb5c1a21d52d1e212f86c4338a1a8f89afe97b8d4b1b3bc4c7fcc51b1c2d7a20372bf59c4029d01d153f79831c0dae056330f5524a4ad1eee1a3c3040e4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:09:17' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:09:17Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/25382eb0-fcd8-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b60f7eb5c1a21d52d1e212f86c4338a1a8f89afe97b8d4b1b3bc4c7fcc51b1c2d7a20372bf59c4029d01d153f79831c0dae056330f5524a4ad1eee1a3c3040e4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"25382b80-fcd8-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"7bbc3d011dead85052cdf4179c8f8413e2e341a8bd76fe4ee5e9ebd4b24cd9e8461e8179e8c40bf11e6a2ac432814414ab83e14a5f9823f1b63051965c736f8e\"}', `updated_at` = '2015-06-24 20:09:17' WHERE `lti2_tp_registrations`.`id` = 41
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '7bbc3d011dead85052cdf4179c8f8413e2e341a8bd76fe4ee5e9ebd4b24cd9e8461e8179e8c40bf11e6a2ac432814414ab83e14a5f9823f1b63051965c736f8eb60f7eb5c1a21d52d1e212f86c4338a1a8f89afe97b8d4b1b3bc4c7fcc51b1c2d7a20372bf59c4029d01d153f79831c0dae056330f5524a4ad1eee1a3c3040e4', `status` = 'reregistered', `updated_at` = '2015-06-24 20:09:17' WHERE `lti2_tp_registrations`.`id` = 41[0m
  [1m[35m (1.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41
Completed 302 Found in 409ms (ActiveRecord: 13.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451&&id=41" for 127.0.0.1 at 2015-06-24 13:09:17 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", "id"=>"41"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 41 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=25382b80-fcd8-0132-2e4b-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started PUT "/lti2_tp/tool_proxies/25382b80-fcd8-0132-2e4b-20c9d07c6451?correlation=d0b9edf0-fcda-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:09:19 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"d0b9edf0-fcda-0132-2e4f-20c9d07c6451", "id"=>"25382b80-fcd8-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"7386774647572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176559", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"nPvUfraPsu4hlr0svZfTMCD1gX0="}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '25382b80-fcd8-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 39  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"25382b80-fcd8-0132-2e4b-20c9d07c6451", :oauth_nonce=>"7386774647572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176559", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"nPvUfraPsu4hlr0svZfTMCD1gX0="}
in verify_signature
Secret: test
Verify_signature--send_signature: nPvUfraPsu4hlr0svZfTMCD1gX0=  test_signature: VxMil2kZXXNTj3hgp2V1p4ecVAw=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F25382b80-fcd8-0132-2e4b-20c9d07c6451&correlation%3Dd0b9edf0-fcda-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D25382b80-fcd8-0132-2e4b-20c9d07c6451%26oauth_nonce%3D7386774647572%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176559%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 51209ms (ActiveRecord: 1.5ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 13:10:10 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 107ms (Views: 104.3ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:10:21 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451", "reg_key"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 20:10:21', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'f43a6680-fcda-0132-2e4b-20c9d07c6451', '0dc5e3b9e2e06910d880f250bb1cb35e', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 20:10:21', '2')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations
Completed 302 Found in 207ms (ActiveRecord: 2.7ms)


Started GET "/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:10:21 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"42", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:10:21', 'Elan/LuMoS', 42, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 20:10:21')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (181.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (188.4ms)
Completed 200 OK in 410ms (Views: 333.6ms | ActiveRecord: 3.1ms)


Started PATCH "/lti_registration_wips/94" for 127.0.0.1 at 2015-06-24 13:10:29 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University110"}, "commit"=>"Update Lti registration wip", "id"=>"94"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 94 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University110', `updated_at` = '2015-06-24 20:10:29' WHERE `lti_registration_wips`.`id` = 94
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University110', `updated_at` = '2015-06-24 20:10:29' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 94 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (1.9ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University110' LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:10:33', 'Elan University110', '2015-06-24 20:10:33')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (3.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'fe5f3940-fcda-0132-2e4f-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:10:33Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"fda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:10:33' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (2.0ms)[0m  COMMIT
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7d\"}', `updated_at` = '2015-06-24 20:10:34' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (4.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.9ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University110' AND `tenants`.`id` != 40) LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `tenants` SET `secret` = 'c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7dfda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c', `tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451', `updated_at` = '2015-06-24 20:10:34' WHERE `tenants`.`id` = 40
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7dfda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c', `tenant_id` = 40, `updated_at` = '2015-06-24 20:10:34' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (7.7ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42
Completed 302 Found in 4990ms (ActiveRecord: 36.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42" for 127.0.0.1 at 2015-06-24 13:10:34 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "id"=>"42"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451
Completed 302 Found in 18ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:10:43 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"797868452382", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435176642", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"GQ9lcxj7R2J+PbOuyK6oXc1sEuw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University110'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 40 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = 'c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7dfda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c', `status` = 'received', `updated_at` = '2015-06-24 20:10:43' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations
Completed 302 Found in 263ms (ActiveRecord: 7.1ms)


Started GET "/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:10:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"42", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:10:43', 'Elan/LuMoS', 42, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University110', '2015-06-24 20:10:43')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (155.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (160.6ms)
Completed 200 OK in 318ms (Views: 279.0ms | ActiveRecord: 2.3ms)


Started PATCH "/lti_registration_wips/95" for 127.0.0.1 at 2015-06-24 13:10:46 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University110"}, "commit"=>"Update Lti registration wip", "id"=>"95"}
  [1m[35mLtiRegistrationWip Load (1.1ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 95 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 95 LIMIT 1  [["id", "95"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m  [["id", 42]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University110'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '065f2460-fcdb-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:10:47Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"aefe6cf79985f487c7e7e70103f323f69aaa26ac67219479506a2a32b00e46ed28f75c204130a6cbbde8c9f806573ec099a746476a623bb0b2acad67674ad378\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:10:47' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:10:47Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"aefe6cf79985f487c7e7e70103f323f69aaa26ac67219479506a2a32b00e46ed28f75c204130a6cbbde8c9f806573ec099a746476a623bb0b2acad67674ad378\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"513a9685c30e738408a0d39b4f5c622f6d3e1d4d9b42add1046f000f2aafcae53385e9805040c8283be51f86f3365e0c64989a96f4cea2585513576f6e73e814\"}', `updated_at` = '2015-06-24 20:10:47' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '513a9685c30e738408a0d39b4f5c622f6d3e1d4d9b42add1046f000f2aafcae53385e9805040c8283be51f86f3365e0c64989a96f4cea2585513576f6e73e814aefe6cf79985f487c7e7e70103f323f69aaa26ac67219479506a2a32b00e46ed28f75c204130a6cbbde8c9f806573ec099a746476a623bb0b2acad67674ad378', `status` = 'reregistered', `updated_at` = '2015-06-24 20:10:47' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42
Completed 302 Found in 397ms (ActiveRecord: 15.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42" for 127.0.0.1 at 2015-06-24 13:10:47 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "id"=>"42"}
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451
Completed 302 Found in 24ms (ActiveRecord: 1.2ms)


Started PUT "/lti2_tp/tool_proxies/f43a6680-fcda-0132-2e4b-20c9d07c6451?correlation=065f2460-fcdb-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:10:55 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"065f2460-fcdb-0132-2e4f-20c9d07c6451", "id"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"6235343731583", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176655", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jugKJuZo6kYXOIP7UpIenSNpK7w="}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"6235343731583", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176655", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jugKJuZo6kYXOIP7UpIenSNpK7w="}
in verify_signature
Secret: c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7dfda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c
Verify_signature--send_signature: jugKJuZo6kYXOIP7UpIenSNpK7w=  test_signature: gAwS9OVZzj/LJstx6QCsUrmTlpw=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2Ff43a6680-fcda-0132-2e4b-20c9d07c6451&correlation%3D065f2460-fcdb-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Df43a6680-fcda-0132-2e4b-20c9d07c6451%26oauth_nonce%3D6235343731583%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176655%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 12772ms (ActiveRecord: 1.3ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 13:11:08 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.5ms)
Completed 200 OK in 172ms (Views: 168.6ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:11:15 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"1843345120098", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435176674", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"3glvAIOetvLNJ/QJnHeTEh8nj+w="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: c373f2a30224684cf34f5114c866a04e724e956a47d14d71763095dd61c54e7127be77e2cd87bb4881c4227b0978769b3508eeeb6bbda68b8afe1f84a2b6db7dfda79db581df6cfd5bd2b3e2b1502603319d3f556513c164e2a0c7c0bb84843130eb61c77999079e45ccb379a9a631c86ec9ff8584086b3d493428a4220afa9c
Verify_signature--send_signature: 3glvAIOetvLNJ/QJnHeTEh8nj+w=  test_signature: jNJm8pSTFjhnH7CaqSuNwI35+xU=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Df43a6680-fcda-0132-2e4b-20c9d07c6451%26oauth_nonce%3D1843345120098%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176674%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Ff43a69c0-fcda-0132-2e4b-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 63ms (ActiveRecord: 1.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:12:29 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"2562685293570", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435176748", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"YBS/m7LdY34XXBQ759TMJBll2rE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.0ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University110'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 40 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = 'test', `status` = 'received', `updated_at` = '2015-06-24 20:12:29' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (2.7ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations
Completed 302 Found in 298ms (ActiveRecord: 8.0ms)


Started GET "/lti_registration_wips?registration_id=42&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:12:29 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"42", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:12:29', 'Elan/LuMoS', 42, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University110', '2015-06-24 20:12:29')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (153.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (159.8ms)
Completed 200 OK in 324ms (Views: 279.4ms | ActiveRecord: 2.5ms)


Started PATCH "/lti_registration_wips/96" for 127.0.0.1 at 2015-06-24 13:12:32 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University110"}, "commit"=>"Update Lti registration wip", "id"=>"96"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 96 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 96 LIMIT 1[0m  [["id", "96"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1  [["id", 42]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University110'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '453cfc80-fcdb-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:12:32Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"4b99ffbdd8d3043ecd4d8690555b44d1d41e2d40c5bc0af8057ac1ef135d9289c452407cb64acdc1253b8f0f242510cb4dc04cf1ded62f6babc8b50d33abefe5\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:12:32' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:12:32Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f43a69c0-fcda-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"4b99ffbdd8d3043ecd4d8690555b44d1d41e2d40c5bc0af8057ac1ef135d9289c452407cb64acdc1253b8f0f242510cb4dc04cf1ded62f6babc8b50d33abefe5\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"f43a6680-fcda-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"3f0d3252d4939e7750e62aa518a5934169d774e99f65bd8b65ca474bf48d810c216545400d7d5485552064b1ca520a8fd9b5a2df7cdc8199f390fbe85125b802\"}', `updated_at` = '2015-06-24 20:12:32' WHERE `lti2_tp_registrations`.`id` = 42
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '3f0d3252d4939e7750e62aa518a5934169d774e99f65bd8b65ca474bf48d810c216545400d7d5485552064b1ca520a8fd9b5a2df7cdc8199f390fbe85125b8024b99ffbdd8d3043ecd4d8690555b44d1d41e2d40c5bc0af8057ac1ef135d9289c452407cb64acdc1253b8f0f242510cb4dc04cf1ded62f6babc8b50d33abefe5', `status` = 'reregistered', `updated_at` = '2015-06-24 20:12:32' WHERE `lti2_tp_registrations`.`id` = 42[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42
Completed 302 Found in 377ms (ActiveRecord: 13.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451&&id=42" for 127.0.0.1 at 2015-06-24 13:12:32 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", "id"=>"42"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 42 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=f43a6680-fcda-0132-2e4b-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/f43a6680-fcda-0132-2e4b-20c9d07c6451?correlation=453cfc80-fcdb-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:12:35 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"453cfc80-fcdb-0132-2e4f-20c9d07c6451", "id"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"2189747677572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176755", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jzbUSfo2gVdxKvS4opmz4u9QCj4="}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"2189747677572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176755", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jzbUSfo2gVdxKvS4opmz4u9QCj4="}
in verify_signature
Secret: test
Verify_signature--send_signature: jzbUSfo2gVdxKvS4opmz4u9QCj4=  test_signature: 06JTO4nNxRWghQwE2r11lwneDJ8=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2Ff43a6680-fcda-0132-2e4b-20c9d07c6451&correlation%3D453cfc80-fcdb-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Df43a6680-fcda-0132-2e4b-20c9d07c6451%26oauth_nonce%3D2189747677572%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176755%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 830274ms (ActiveRecord: 1.5ms)


Started PUT "/lti2_tp/tool_proxies/f43a6680-fcda-0132-2e4b-20c9d07c6451?correlation=453cfc80-fcdb-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:26:26 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"453cfc80-fcdb-0132-2e4f-20c9d07c6451", "id"=>"f43a6680-fcda-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"2189747677572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176755", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jzbUSfo2gVdxKvS4opmz4u9QCj4="}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'f43a6680-fcda-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"f43a6680-fcda-0132-2e4b-20c9d07c6451", :oauth_nonce=>"2189747677572", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435176755", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jzbUSfo2gVdxKvS4opmz4u9QCj4="}
in verify_signature
Secret: test
Verify_signature--send_signature: jzbUSfo2gVdxKvS4opmz4u9QCj4=  test_signature: 06JTO4nNxRWghQwE2r11lwneDJ8=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2Ff43a6680-fcda-0132-2e4b-20c9d07c6451&correlation%3D453cfc80-fcdb-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Df43a6680-fcda-0132-2e4b-20c9d07c6451%26oauth_nonce%3D2189747677572%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435176755%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 5877ms (ActiveRecord: 10.6ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:26:56 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451", "reg_key"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 20:26:56', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '45a536c0-fcdd-0132-2e4b-20c9d07c6451', 'fb8f7d3543e73aa3fdb2b9b3490b22f1', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"45a538d0-fcdd-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 20:26:56', '2')
  [1m[36m (12.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=43&return_url=/lti2_tp/registrations
Completed 302 Found in 259ms (ActiveRecord: 15.3ms)


Started GET "/lti_registration_wips?registration_id=43&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:26:56 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"43", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:26:57', 'Elan/LuMoS', 43, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 20:26:57')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (162.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (169.0ms)
Completed 200 OK in 581ms (Views: 334.1ms | ActiveRecord: 25.4ms)


Started PATCH "/lti_registration_wips/97" for 127.0.0.1 at 2015-06-24 13:27:02 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University127"}, "commit"=>"Update Lti registration wip", "id"=>"97"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 97 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University127', `updated_at` = '2015-06-24 20:27:02' WHERE `lti_registration_wips`.`id` = 97
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University127', `updated_at` = '2015-06-24 20:27:02' WHERE `lti2_tp_registrations`.`id` = 43
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 97 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University127' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:27:02', 'Elan University127', '2015-06-24 20:27:02')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (4.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '4c0b7060-fcdd-0132-2e4f-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:27:02Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"45a536c0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:27:02' WHERE `lti2_tp_registrations`.`id` = 43[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (1.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"45a536c0-fcdd-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322\"}', `updated_at` = '2015-06-24 20:27:03' WHERE `lti2_tp_registrations`.`id` = 43
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mTenant Exists (2.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University127' AND `tenants`.`id` != 41) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = '60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4', `tenant_key` = '45a536c0-fcdd-0132-2e4b-20c9d07c6451', `updated_at` = '2015-06-24 20:27:03' WHERE `tenants`.`id` = 41
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4', `tenant_id` = 41, `updated_at` = '2015-06-24 20:27:03' WHERE `lti2_tp_registrations`.`id` = 43[0m
  [1m[35m (1.6ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451&&id=43
Completed 302 Found in 619ms (ActiveRecord: 27.4ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451&&id=43" for 127.0.0.1 at 2015-06-24 13:27:03 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", "id"=>"43"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451
Completed 302 Found in 28ms (ActiveRecord: 1.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 13:27:14 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"3338418662091", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435177633", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"aMxSdTwyJu22VnlB3vqu9cdxb8Y="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '45a536c0-fcdd-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University127'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4', `status` = 'received', `updated_at` = '2015-06-24 20:27:14' WHERE `lti2_tp_registrations`.`id` = 43
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=43&return_url=/lti2_tp/registrations
Completed 302 Found in 267ms (ActiveRecord: 8.2ms)


Started GET "/lti_registration_wips?registration_id=43&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 13:27:14 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"43", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 20:27:14', 'Elan/LuMoS', 43, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University127', '2015-06-24 20:27:14')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (182.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (189.4ms)
Completed 200 OK in 360ms (Views: 312.7ms | ActiveRecord: 2.8ms)


Started PATCH "/lti_registration_wips/98" for 127.0.0.1 at 2015-06-24 13:27:18 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University127"}, "commit"=>"Update Lti registration wip", "id"=>"98"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 98 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 98 LIMIT 1  [["id", "98"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1[0m  [["id", 43]]
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University127'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '55247370-fcdd-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:27:18Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"45a536c0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5c70a43724657ce755bc729c978ee9914b0ec50181228e6eaaa661b78837308631e73d66d9da2c40bf4d861166ae6d96bfaf0cdb235fefe335b8a2bd3f14cee2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 20:27:18' WHERE `lti2_tp_registrations`.`id` = 43
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (1.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T20:27:18Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"45a536c0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5c70a43724657ce755bc729c978ee9914b0ec50181228e6eaaa661b78837308631e73d66d9da2c40bf4d861166ae6d96bfaf0cdb235fefe335b8a2bd3f14cee2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"45a536c0-fcdd-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"6ec0a5edfa1bc87e81e7b1424c51c5a590d7186db4735a4fec47a6bf5d03f06388fc57767371be46187bc1ae38cd0141d9ea2934ee467dea00f1d2a990e1aae1\"}', `updated_at` = '2015-06-24 20:27:18' WHERE `lti2_tp_registrations`.`id` = 43[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '6ec0a5edfa1bc87e81e7b1424c51c5a590d7186db4735a4fec47a6bf5d03f06388fc57767371be46187bc1ae38cd0141d9ea2934ee467dea00f1d2a990e1aae15c70a43724657ce755bc729c978ee9914b0ec50181228e6eaaa661b78837308631e73d66d9da2c40bf4d861166ae6d96bfaf0cdb235fefe335b8a2bd3f14cee2', `status` = 'reregistered', `updated_at` = '2015-06-24 20:27:18' WHERE `lti2_tp_registrations`.`id` = 43
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451&&id=43
Completed 302 Found in 475ms (ActiveRecord: 15.4ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451&&id=43" for 127.0.0.1 at 2015-06-24 13:27:18 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", "id"=>"43"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 43 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=45a536c0-fcdd-0132-2e4b-20c9d07c6451
Completed 302 Found in 16ms (ActiveRecord: 0.8ms)


Started PUT "/lti2_tp/tool_proxies/45a536c0-fcdd-0132-2e4b-20c9d07c6451?correlation=55247370-fcdd-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 13:27:21 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"55247370-fcdd-0132-2e4f-20c9d07c6451", "id"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", :oauth_nonce=>"336740454766", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435177641", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"3aDD61pWYAolv0h4jSy6t2gRDaI="}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '45a536c0-fcdd-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", :oauth_nonce=>"336740454766", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435177641", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"3aDD61pWYAolv0h4jSy6t2gRDaI="}
in verify_signature
Secret: 60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4
Verify_signature--send_signature: 3aDD61pWYAolv0h4jSy6t2gRDaI=  test_signature: GzQvi+6GePKNFPmMWISp1DPYkdk=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F45a536c0-fcdd-0132-2e4b-20c9d07c6451&correlation%3D55247370-fcdd-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D45a536c0-fcdd-0132-2e4b-20c9d07c6451%26oauth_nonce%3D336740454766%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435177641%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 5506ms (ActiveRecord: 1.6ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 13:27:27 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (0.7ms)
Completed 200 OK in 118ms (Views: 114.8ms | ActiveRecord: 0.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:24:11 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/45a538d0-fcdd-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"45a536c0-fcdd-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"6235202769837", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435184651", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"13AaCBU2Hsn2obIRATE2JNnfLIE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '45a536c0-fcdd-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 60c0aee78f4b5be77a48c22866e37c6b4f99b4de1101cbf9d8067b5d29a6d6e579cff9897d19aa62ffe2f176aee845a20a6673f9145963fef7004b3d4746b322e900000642e4279c854a432c4af237621254785d931701f18e8c89b4e79b7cbe2e084412802756f410b669fb9fd8e8d6fa444fd33ea335d240d7dc2a227bc2d4
Verify_signature--send_signature: 13AaCBU2Hsn2obIRATE2JNnfLIE=  test_signature: 33q+4rbYC6VZWUMtSN7p9PRD1DA=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D45a536c0-fcdd-0132-2e4b-20c9d07c6451%26oauth_nonce%3D6235202769837%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435184651%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F45a538d0-fcdd-0132-2e4b-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 118452ms (ActiveRecord: 31.8ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:26:44 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451", "reg_key"=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 22:26:44', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '01ae3610-fcee-0132-2e4b-20c9d07c6451', 'c9347a8597509e8dac844bb26091cbee', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"01ae4330-fcee-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 22:26:44', '2')[0m
  [1m[35m (1.4ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=44&return_url=/lti2_tp/registrations
Completed 302 Found in 284ms (ActiveRecord: 4.2ms)


Started GET "/lti_registration_wips?registration_id=44&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:26:44 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"44", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:26:45', 'Elan/LuMoS', 44, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 22:26:45')[0m
  [1m[35m (2.3ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (167.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (173.0ms)
Completed 200 OK in 479ms (Views: 295.2ms | ActiveRecord: 25.5ms)


Started PATCH "/lti_registration_wips/99" for 127.0.0.1 at 2015-06-24 15:26:51 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University326"}, "commit"=>"Update Lti registration wip", "id"=>"99"}
  [1m[36mLtiRegistrationWip Load (1.0ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 99 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University326', `updated_at` = '2015-06-24 22:26:51' WHERE `lti_registration_wips`.`id` = 99[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University326', `updated_at` = '2015-06-24 22:26:51' WHERE `lti2_tp_registrations`.`id` = 44[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 99 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University326' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:26:51', 'Elan University326', '2015-06-24 22:26:51')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '08cf6870-fcee-0132-2e4f-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:26:51Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"01ae3610-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"3691a166ef4aa8c4f3eb8508d9205cefb0246e285e5f34a572d1aec0e3f0058abb0b55050c9d3ce3b3188d2157322435fd914f39e708e01097434d1a344341fc\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:26:51' WHERE `lti2_tp_registrations`.`id` = 44
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"01ae3610-fcee-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"eced803d388cfcf7cf2df3c23a1ec914fa0a3369ffe12f2e533d02f83f86786caf1b36e84496287ee6d0c22b310ad6cf810cf368110b96f5bf1eb77c7576cf5e\"}', `updated_at` = '2015-06-24 22:26:51' WHERE `lti2_tp_registrations`.`id` = 44[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.1ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University326' AND `tenants`.`id` != 42) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = 'eced803d388cfcf7cf2df3c23a1ec914fa0a3369ffe12f2e533d02f83f86786caf1b36e84496287ee6d0c22b310ad6cf810cf368110b96f5bf1eb77c7576cf5e3691a166ef4aa8c4f3eb8508d9205cefb0246e285e5f34a572d1aec0e3f0058abb0b55050c9d3ce3b3188d2157322435fd914f39e708e01097434d1a344341fc', `tenant_key` = '01ae3610-fcee-0132-2e4b-20c9d07c6451', `updated_at` = '2015-06-24 22:26:51' WHERE `tenants`.`id` = 42[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'eced803d388cfcf7cf2df3c23a1ec914fa0a3369ffe12f2e533d02f83f86786caf1b36e84496287ee6d0c22b310ad6cf810cf368110b96f5bf1eb77c7576cf5e3691a166ef4aa8c4f3eb8508d9205cefb0246e285e5f34a572d1aec0e3f0058abb0b55050c9d3ce3b3188d2157322435fd914f39e708e01097434d1a344341fc', `tenant_id` = 42, `updated_at` = '2015-06-24 22:26:51' WHERE `lti2_tp_registrations`.`id` = 44
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451&&id=44
Completed 302 Found in 587ms (ActiveRecord: 20.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451&&id=44" for 127.0.0.1 at 2015-06-24 15:26:52 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", "id"=>"44"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451
Completed 302 Found in 28ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:27:19 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"554223938311", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435184838", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"c12fvuNl2wZHgU4nU8QnwzsMQIg="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '01ae3610-fcee-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 42  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University326'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 42 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = 'eced803d388cfcf7cf2df3c23a1ec914fa0a3369ffe12f2e533d02f83f86786caf1b36e84496287ee6d0c22b310ad6cf810cf368110b96f5bf1eb77c7576cf5e3691a166ef4aa8c4f3eb8508d9205cefb0246e285e5f34a572d1aec0e3f0058abb0b55050c9d3ce3b3188d2157322435fd914f39e708e01097434d1a344341fc', `status` = 'received', `updated_at` = '2015-06-24 22:27:19' WHERE `lti2_tp_registrations`.`id` = 44[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=44&return_url=/lti2_tp/registrations
Completed 302 Found in 268ms (ActiveRecord: 6.5ms)


Started GET "/lti_registration_wips?registration_id=44&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:27:19 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"44", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:27:19', 'Elan/LuMoS', 44, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University326', '2015-06-24 22:27:19')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (168.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (175.3ms)
Completed 200 OK in 336ms (Views: 292.3ms | ActiveRecord: 2.7ms)


Started PATCH "/lti_registration_wips/100" for 127.0.0.1 at 2015-06-24 15:27:22 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University326"}, "commit"=>"Update Lti registration wip", "id"=>"100"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 100 LIMIT 1[0m  [["id", "100"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1  [["id", 44]]
  [1m[36mTenant Load (1.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University326'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '1b6c62f0-fcee-0132-2e4f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:27:22Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"01ae3610-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"68bd2b3edf2b8cb616bc8e3669398a51ceef169e7302d3a068ece2c6aa46179446bb482a4ac24151c134fe25aabcf23e1c6252950338e8d2b9e51425b49d25c0\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:27:22' WHERE `lti2_tp_registrations`.`id` = 44[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:27:22Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"01ae3610-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01ae4330-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"68bd2b3edf2b8cb616bc8e3669398a51ceef169e7302d3a068ece2c6aa46179446bb482a4ac24151c134fe25aabcf23e1c6252950338e8d2b9e51425b49d25c0\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"01ae3610-fcee-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"28ac689c35dda56a3f5e759f800211a2f9372aaafabf5efcbc2c38e1e1ac606337cb6289bc157162d552480722c5a98fa1be10cf7fce9da5e9e0aa0ef31bf521\"}', `updated_at` = '2015-06-24 22:27:23' WHERE `lti2_tp_registrations`.`id` = 44
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '28ac689c35dda56a3f5e759f800211a2f9372aaafabf5efcbc2c38e1e1ac606337cb6289bc157162d552480722c5a98fa1be10cf7fce9da5e9e0aa0ef31bf52168bd2b3edf2b8cb616bc8e3669398a51ceef169e7302d3a068ece2c6aa46179446bb482a4ac24151c134fe25aabcf23e1c6252950338e8d2b9e51425b49d25c0', `status` = 'reregistered', `updated_at` = '2015-06-24 22:27:23' WHERE `lti2_tp_registrations`.`id` = 44[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451&&id=44
Completed 302 Found in 499ms (ActiveRecord: 15.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451&&id=44" for 127.0.0.1 at 2015-06-24 15:27:23 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", "id"=>"44"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 44 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=01ae3610-fcee-0132-2e4b-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/01ae3610-fcee-0132-2e4b-20c9d07c6451?correlation=1b6c62f0-fcee-0132-2e4f-20c9d07c6451" for 127.0.0.1 at 2015-06-24 15:28:25 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"1b6c62f0-fcee-0132-2e4f-20c9d07c6451", "id"=>"01ae3610-fcee-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", :oauth_nonce=>"964235705224", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435184905", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"FpRS+legnB7sTXt+Dk53Stbt5j0="}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '01ae3610-fcee-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 42  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"01ae3610-fcee-0132-2e4b-20c9d07c6451", :oauth_nonce=>"964235705224", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435184905", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"FpRS+legnB7sTXt+Dk53Stbt5j0="}
in verify_signature
Secret: eced803d388cfcf7cf2df3c23a1ec914fa0a3369ffe12f2e533d02f83f86786caf1b36e84496287ee6d0c22b310ad6cf810cf368110b96f5bf1eb77c7576cf5e3691a166ef4aa8c4f3eb8508d9205cefb0246e285e5f34a572d1aec0e3f0058abb0b55050c9d3ce3b3188d2157322435fd914f39e708e01097434d1a344341fc
Verify_signature--send_signature: FpRS+legnB7sTXt+Dk53Stbt5j0=  test_signature: nMCROnnDeHXg09BxNrv5C1NebdQ=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F01ae3610-fcee-0132-2e4b-20c9d07c6451&correlation%3D1b6c62f0-fcee-0132-2e4f-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D01ae3610-fcee-0132-2e4b-20c9d07c6451%26oauth_nonce%3D964235705224%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435184905%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 246370ms (ActiveRecord: 1.5ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 15:32:31 -0700
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:33:47 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451", "reg_key"=>"fe018690-fcee-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 22:33:48', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'fe018690-fcee-0132-2e4b-20c9d07c6451', 'a4e859bd48a9a8cbf7214609eff1e600', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"fe0188c0-fcee-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 22:33:48', '2')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=45&return_url=/lti2_tp/registrations
Completed 302 Found in 442ms (ActiveRecord: 10.9ms)


Started GET "/lti_registration_wips?registration_id=45&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:33:48 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"45", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:33:48', 'Elan/LuMoS', 45, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 22:33:48')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2478.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2500.3ms)
Completed 200 OK in 3452ms (Views: 3297.0ms | ActiveRecord: 6.6ms)


Started PATCH "/lti_registration_wips/101" for 127.0.0.1 at 2015-06-24 15:33:57 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University333"}, "commit"=>"Update Lti registration wip", "id"=>"101"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 101 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University333', `updated_at` = '2015-06-24 22:33:57' WHERE `lti_registration_wips`.`id` = 101
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University333', `updated_at` = '2015-06-24 22:33:57' WHERE `lti2_tp_registrations`.`id` = 45
  [1m[36m (16.9ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 101 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University333' LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:33:57', 'Elan University333', '2015-06-24 22:33:57')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '06faca90-fcef-0132-2e50-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:33:57Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"fe018690-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:33:58' WHERE `lti2_tp_registrations`.`id` = 45[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"fe018690-fcee-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542\"}', `updated_at` = '2015-06-24 22:33:58' WHERE `lti2_tp_registrations`.`id` = 45
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University333' AND `tenants`.`id` != 43) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = '598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048', `tenant_key` = 'fe018690-fcee-0132-2e4b-20c9d07c6451', `updated_at` = '2015-06-24 22:33:58' WHERE `tenants`.`id` = 43
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048', `tenant_id` = 43, `updated_at` = '2015-06-24 22:33:58' WHERE `lti2_tp_registrations`.`id` = 45[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451&&id=45
Completed 302 Found in 704ms (ActiveRecord: 38.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451&&id=45" for 127.0.0.1 at 2015-06-24 15:33:58 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"fe018690-fcee-0132-2e4b-20c9d07c6451", "id"=>"45"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:34:02 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"fe018690-fcee-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"5835600341367", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435185241", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"OIbymLjPGu+92cYJAjm0mV+mREo="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'fe018690-fcee-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 43  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University333'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 43 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048', `status` = 'received', `updated_at` = '2015-06-24 22:34:02' WHERE `lti2_tp_registrations`.`id` = 45
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=45&return_url=/lti2_tp/registrations
Completed 302 Found in 272ms (ActiveRecord: 5.6ms)


Started GET "/lti_registration_wips?registration_id=45&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:34:02 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"45", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:34:02', 'Elan/LuMoS', 45, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University333', '2015-06-24 22:34:02')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (149.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (153.5ms)
Completed 200 OK in 332ms (Views: 279.4ms | ActiveRecord: 2.6ms)


Started PATCH "/lti_registration_wips/102" for 127.0.0.1 at 2015-06-24 15:34:05 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University333"}, "commit"=>"Update Lti registration wip", "id"=>"102"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 102 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 102 LIMIT 1  [["id", "102"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1[0m  [["id", 45]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University333'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '0b523db0-fcef-0132-2e50-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:34:05Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"fe018690-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8839cd3f4d0750958ef20e59a509e63ee3bc400789c9f39154bfefea38c1e259a31455c6e466e1eb8c9c84af23267f638a29051dc36d5b8573dbb6f57ca4c732\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:34:05' WHERE `lti2_tp_registrations`.`id` = 45
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:34:05Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"fe018690-fcee-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fe0188c0-fcee-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8839cd3f4d0750958ef20e59a509e63ee3bc400789c9f39154bfefea38c1e259a31455c6e466e1eb8c9c84af23267f638a29051dc36d5b8573dbb6f57ca4c732\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"fe018690-fcee-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"452c8a03f6bcf4c0f2f793211b1b2f0b49d63c2a6c06007a8d80324a8d1059b7708697b1769182e6f1e9c5ea20c551d64ba9b0ed7a7327853d1aa336fffbd0ba\"}', `updated_at` = '2015-06-24 22:34:05' WHERE `lti2_tp_registrations`.`id` = 45[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '452c8a03f6bcf4c0f2f793211b1b2f0b49d63c2a6c06007a8d80324a8d1059b7708697b1769182e6f1e9c5ea20c551d64ba9b0ed7a7327853d1aa336fffbd0ba8839cd3f4d0750958ef20e59a509e63ee3bc400789c9f39154bfefea38c1e259a31455c6e466e1eb8c9c84af23267f638a29051dc36d5b8573dbb6f57ca4c732', `status` = 'reregistered', `updated_at` = '2015-06-24 22:34:05' WHERE `lti2_tp_registrations`.`id` = 45
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451&&id=45
Completed 302 Found in 439ms (ActiveRecord: 13.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451&&id=45" for 127.0.0.1 at 2015-06-24 15:34:05 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"fe018690-fcee-0132-2e4b-20c9d07c6451", "id"=>"45"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 45 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=fe018690-fcee-0132-2e4b-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/fe018690-fcee-0132-2e4b-20c9d07c6451?correlation=0b523db0-fcef-0132-2e50-20c9d07c6451" for 127.0.0.1 at 2015-06-24 15:35:19 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"0b523db0-fcef-0132-2e50-20c9d07c6451", "id"=>"fe018690-fcee-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"fe018690-fcee-0132-2e4b-20c9d07c6451", :oauth_nonce=>"1505980871845", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435185319", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"BcxGyrLjUbLvbYNvjsZMJwM2xRc="}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'fe018690-fcee-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 43  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"fe018690-fcee-0132-2e4b-20c9d07c6451", :oauth_nonce=>"1505980871845", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435185319", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"BcxGyrLjUbLvbYNvjsZMJwM2xRc="}
in verify_signature
Secret: 598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048
Verify_signature--send_signature: BcxGyrLjUbLvbYNvjsZMJwM2xRc=  test_signature: FbvsiRzr33UwzWkf6MfyTbUi4K4=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2Ffe018690-fcee-0132-2e4b-20c9d07c6451&correlation%3D0b523db0-fcef-0132-2e50-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Dfe018690-fcee-0132-2e4b-20c9d07c6451%26oauth_nonce%3D1505980871845%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435185319%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 34704ms (ActiveRecord: 1.6ms)


Started GET "/?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature" for 127.0.0.1 at 2015-06-24 15:35:54 -0700
Processing by HomeController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"Invalid signature", "lti_errorlog"=>"Invalid signature"}
  Rendered home/index.html.erb within layouts/application (2.4ms)
Completed 200 OK in 117ms (Views: 115.2ms | ActiveRecord: 0.0ms)


Started POST "/echoes" for 127.0.0.1 at 2015-06-24 15:37:33 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"238", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"fe018690-fcee-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"5076058751901", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435185452", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"LcdaX+klC/iPV11uTtdhTk5AM3I="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'fe018690-fcee-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 43  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 598f0eb320d0c156eeecbc93d6b38e84f808e4a5cd199af5be8d73f36bef3f170470cbb6c9401bf33d21c30e0d78af9a0b7b34b1fc73158a7be0b19244587542d717b97d8729b2c450fa4ac5704a010cf2b9ee1236a17c99615b26ab01c59f2ae510d514f835ce7fe8bb91c3bafb6b0d5e615d1af6ad9404a050bd9ad1f19048
Verify_signature--send_signature: LcdaX+klC/iPV11uTtdhTk5AM3I=  test_signature: A2V371P0xx0pdmPZHS851fz8pWM=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Fechoes&context_id%3D2%26context_label%3DSMPL101A%26context_title%3DNursing%2520Compendium%26custom_discipline%3DSMPL101A%26custom_pi%3D3.14159%26custom_referrer%3DNarcissus%26custom_user_primary_email%3Dadmin%2540lumos.org%26launch_presentation_document_target%3Dwindow%26launch_presentation_locale%3Den_US%26launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Fcourse_page%253Fmethod%253Dshow%2526course_id%253D2%26lis_course_section_sourcedid%3D2%26lti_message_type%3Dbasic-lti-launch-request%26lti_version%3DLTI-2p0%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Dfe018690-fcee-0132-2e4b-20c9d07c6451%26oauth_nonce%3D5076058751901%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435185452%26oauth_version%3D1.0%26resource_link_id%3D238%26roles%3DInstructor%26tool_consumer_info_product_family_code%3DLuMoS%26tool_consumer_info_version%3D3.1%26user_id%3D2
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Filter chain halted as :pre_process_tenant rendered or redirected
Completed 302 Found in 3143ms (ActiveRecord: 1.2ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:37:58 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451", "reg_key"=>"9386d100-fcef-0132-2e4b-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (4.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 22:37:59', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '9386d100-fcef-0132-2e4b-20c9d07c6451', 'a9924429a8bbae06c4a0b5b935f76e13', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"9386d3b0-fcef-0132-2e4b-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 22:37:59', '2')[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=46&return_url=/lti2_tp/registrations
Completed 302 Found in 238ms (ActiveRecord: 6.7ms)


Started GET "/lti_registration_wips?registration_id=46&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:37:59 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"46", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:37:59', 'Elan/LuMoS', 46, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 22:37:59')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (157.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (163.8ms)
Completed 200 OK in 399ms (Views: 349.1ms | ActiveRecord: 3.2ms)


Started PATCH "/lti_registration_wips/103" for 127.0.0.1 at 2015-06-24 15:38:01 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University"}, "commit"=>"Update Lti registration wip", "id"=>"103"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 103 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 103 LIMIT 1[0m  [["id", "103"]]
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1  [["id", 46]]
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:38:01', 'Elan University', '2015-06-24 22:38:01')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '98693f50-fcef-0132-2e50-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:38:01Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"9386d100-fcef-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"9a35edb43a1914409c21bfbe5fe4e24087e7c64d3530ca0a40da1351381d21b8541514c8f36f4350e9da425cf15fc337a63dcb4275660c2f3c381fc871d1db8b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:38:02' WHERE `lti2_tp_registrations`.`id` = 46
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"9386d100-fcef-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"3ecb61169660a594f12fe6837106d6c1a067ebba649c979522301deb88d245a45fd52d1d29ba63589e286a8a0493ca57e5568307652617f60c1095f51237217b\"}', `updated_at` = '2015-06-24 22:38:02' WHERE `lti2_tp_registrations`.`id` = 46[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University' AND `tenants`.`id` != 44) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '3ecb61169660a594f12fe6837106d6c1a067ebba649c979522301deb88d245a45fd52d1d29ba63589e286a8a0493ca57e5568307652617f60c1095f51237217b9a35edb43a1914409c21bfbe5fe4e24087e7c64d3530ca0a40da1351381d21b8541514c8f36f4350e9da425cf15fc337a63dcb4275660c2f3c381fc871d1db8b', `tenant_key` = '9386d100-fcef-0132-2e4b-20c9d07c6451', `updated_at` = '2015-06-24 22:38:02' WHERE `tenants`.`id` = 44[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '3ecb61169660a594f12fe6837106d6c1a067ebba649c979522301deb88d245a45fd52d1d29ba63589e286a8a0493ca57e5568307652617f60c1095f51237217b9a35edb43a1914409c21bfbe5fe4e24087e7c64d3530ca0a40da1351381d21b8541514c8f36f4350e9da425cf15fc337a63dcb4275660c2f3c381fc871d1db8b', `tenant_id` = 44, `updated_at` = '2015-06-24 22:38:02' WHERE `lti2_tp_registrations`.`id` = 46
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451&&id=46
Completed 302 Found in 561ms (ActiveRecord: 16.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451&&id=46" for 127.0.0.1 at 2015-06-24 15:38:02 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"9386d100-fcef-0132-2e4b-20c9d07c6451", "id"=>"46"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451
Completed 302 Found in 16ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:40:08 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"9386d100-fcef-0132-2e4b-20c9d07c6451", "oauth_nonce"=>"7107080706545", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435185608", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"AksAdz3EykCmJTXhoc9fzmryOwQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '9386d100-fcef-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.9ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '3ecb61169660a594f12fe6837106d6c1a067ebba649c979522301deb88d245a45fd52d1d29ba63589e286a8a0493ca57e5568307652617f60c1095f51237217b9a35edb43a1914409c21bfbe5fe4e24087e7c64d3530ca0a40da1351381d21b8541514c8f36f4350e9da425cf15fc337a63dcb4275660c2f3c381fc871d1db8b', `status` = 'received', `updated_at` = '2015-06-24 22:40:08' WHERE `lti2_tp_registrations`.`id` = 46[0m
  [1m[35m (12.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=46&return_url=/lti2_tp/registrations
Completed 302 Found in 305ms (ActiveRecord: 18.2ms)


Started GET "/lti_registration_wips?registration_id=46&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:40:08 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"46", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:40:08', 'Elan/LuMoS', 46, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 22:40:08')[0m
  [1m[35m (2.2ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (179.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (185.4ms)
Completed 200 OK in 401ms (Views: 329.1ms | ActiveRecord: 5.2ms)


Started PATCH "/lti_registration_wips/104" for 127.0.0.1 at 2015-06-24 15:40:11 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University"}, "commit"=>"Update Lti registration wip", "id"=>"104"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 104 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 104 LIMIT 1[0m  [["id", "104"]]
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1  [["id", 46]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'e5d885e0-fcef-0132-2e50-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:40:11Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"9386d100-fcef-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"078ea6c2641a30768078db9626bea3d7783d43b53ee3af18ba1e3ac3417439f6444f94263c78434653605524389d83b690bf8b326213f755e7ba68d472537f44\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:40:11' WHERE `lti2_tp_registrations`.`id` = 46[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/05ab9100-fcc9-0132-2e44-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:40:11Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"9386d100-fcef-0132-2e4b-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9386d3b0-fcef-0132-2e4b-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"078ea6c2641a30768078db9626bea3d7783d43b53ee3af18ba1e3ac3417439f6444f94263c78434653605524389d83b690bf8b326213f755e7ba68d472537f44\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"9386d100-fcef-0132-2e4b-20c9d07c6451\",\"tc_half_shared_secret\":\"8b0f1cf3a7cee1edbeb79c8423b35856d167205e2c1d7628a0f4652a443b393ff0480a0e220159f8179ea6a6f0be7ffeca9a9a881baaaa6099a3312a774586ac\"}', `updated_at` = '2015-06-24 22:40:12' WHERE `lti2_tp_registrations`.`id` = 46
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '8b0f1cf3a7cee1edbeb79c8423b35856d167205e2c1d7628a0f4652a443b393ff0480a0e220159f8179ea6a6f0be7ffeca9a9a881baaaa6099a3312a774586ac078ea6c2641a30768078db9626bea3d7783d43b53ee3af18ba1e3ac3417439f6444f94263c78434653605524389d83b690bf8b326213f755e7ba68d472537f44', `status` = 'reregistered', `updated_at` = '2015-06-24 22:40:12' WHERE `lti2_tp_registrations`.`id` = 46[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451&&id=46
Completed 302 Found in 428ms (ActiveRecord: 14.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451&&id=46" for 127.0.0.1 at 2015-06-24 15:40:12 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"9386d100-fcef-0132-2e4b-20c9d07c6451", "id"=>"46"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 46 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=9386d100-fcef-0132-2e4b-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/9386d100-fcef-0132-2e4b-20c9d07c6451?correlation=e5d885e0-fcef-0132-2e50-20c9d07c6451" for 127.0.0.1 at 2015-06-24 15:45:48 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"e5d885e0-fcef-0132-2e50-20c9d07c6451", "id"=>"9386d100-fcef-0132-2e4b-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"9386d100-fcef-0132-2e4b-20c9d07c6451", :oauth_nonce=>"5640770859253", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435185813", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pgbi5mf3xztYVurNOVmb8RSFhaw="}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '9386d100-fcef-0132-2e4b-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"9386d100-fcef-0132-2e4b-20c9d07c6451", :oauth_nonce=>"5640770859253", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435185813", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"pgbi5mf3xztYVurNOVmb8RSFhaw="}
in verify_signature
Secret: 3ecb61169660a594f12fe6837106d6c1a067ebba649c979522301deb88d245a45fd52d1d29ba63589e286a8a0493ca57e5568307652617f60c1095f51237217b9a35edb43a1914409c21bfbe5fe4e24087e7c64d3530ca0a40da1351381d21b8541514c8f36f4350e9da425cf15fc337a63dcb4275660c2f3c381fc871d1db8b
Verify_signature--send_signature: pgbi5mf3xztYVurNOVmb8RSFhaw=  test_signature: gMK8ScK7sjTZbVZWc1Q+byNn4bY=
Verify signature_base_string: PUT&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Ftool_proxies%2F9386d100-fcef-0132-2e4b-20c9d07c6451&correlation%3De5d885e0-fcef-0132-2e50-20c9d07c6451%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D9386d100-fcef-0132-2e4b-20c9d07c6451%26oauth_nonce%3D5640770859253%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435185813%26oauth_version%3D1.0
Invalid signature
Redirected to http://rails.kinexis.com:5000?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 6986ms (ActiveRecord: 14.0ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:47:00 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451", "reg_key"=>"d2017bf0-fcf0-0132-2e51-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (1.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-06-24 22:47:01', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'd2017bf0-fcf0-0132-2e51-20c9d07c6451', 'b1e56b6619efbf3187ea84124848a212', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"d2069e90-fcf0-0132-2e51-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitsecret\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-06-24 22:47:01', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=47&return_url=/lti2_tp/registrations
Completed 302 Found in 577ms (ActiveRecord: 3.7ms)


Started GET "/lti_registration_wips?registration_id=47&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:47:01 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"47", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 47 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:47:01', 'Elan/LuMoS', 47, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University', '2015-06-24 22:47:01')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (163.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (169.6ms)
Completed 200 OK in 431ms (Views: 285.2ms | ActiveRecord: 6.3ms)


Started PATCH "/lti_registration_wips/105" for 127.0.0.1 at 2015-06-24 15:47:10 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"wcvHkqh2uPkNNzIEMd03o+aTP72xce7O55sTOmDO8jY=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University347"}, "commit"=>"Update Lti registration wip", "id"=>"105"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 105 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Elan University347', `updated_at` = '2015-06-24 22:47:10' WHERE `lti_registration_wips`.`id` = 105
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 47 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University347', `updated_at` = '2015-06-24 22:47:10' WHERE `lti2_tp_registrations`.`id` = 47
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 105 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 47 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University347' LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:47:10', 'Elan University347', '2015-06-24 22:47:10')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'df4344d0-fcf0-0132-2e50-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:47:10Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"d2017bf0-fcf0-0132-2e51-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"66a4ab9bd89e14ba7d71b30de38b46660bc0d1a023ce1a2d40ab96e8e041744afb0c74da9250bded13ee471db9e46a5f1e92478182c4445bba003379bf2122be\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:47:10' WHERE `lti2_tp_registrations`.`id` = 47[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"d2017bf0-fcf0-0132-2e51-20c9d07c6451\",\"tc_half_shared_secret\":\"502d76293ef7d54b1b750faf6a4691e7025e4607a322135aac06f60cc059284b139e03e1470ccb79ef12b8e5253e0baf9f397560b1ad2c9cc6e5712c3ba954cc\"}', `updated_at` = '2015-06-24 22:47:19' WHERE `lti2_tp_registrations`.`id` = 47
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mTenant Exists (1.0ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University347' AND `tenants`.`id` != 45) LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `tenants` SET `secret` = '502d76293ef7d54b1b750faf6a4691e7025e4607a322135aac06f60cc059284b139e03e1470ccb79ef12b8e5253e0baf9f397560b1ad2c9cc6e5712c3ba954cc66a4ab9bd89e14ba7d71b30de38b46660bc0d1a023ce1a2d40ab96e8e041744afb0c74da9250bded13ee471db9e46a5f1e92478182c4445bba003379bf2122be', `tenant_key` = 'd2017bf0-fcf0-0132-2e51-20c9d07c6451', `updated_at` = '2015-06-24 22:47:19' WHERE `tenants`.`id` = 45
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '502d76293ef7d54b1b750faf6a4691e7025e4607a322135aac06f60cc059284b139e03e1470ccb79ef12b8e5253e0baf9f397560b1ad2c9cc6e5712c3ba954cc66a4ab9bd89e14ba7d71b30de38b46660bc0d1a023ce1a2d40ab96e8e041744afb0c74da9250bded13ee471db9e46a5f1e92478182c4445bba003379bf2122be', `tenant_id` = 45, `updated_at` = '2015-06-24 22:47:19' WHERE `lti2_tp_registrations`.`id` = 47[0m
  [1m[35m (1.5ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=d2017bf0-fcf0-0132-2e51-20c9d07c6451&&id=47
Completed 302 Found in 9274ms (ActiveRecord: 23.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=d2017bf0-fcf0-0132-2e51-20c9d07c6451&&id=47" for 127.0.0.1 at 2015-06-24 15:47:19 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"d2017bf0-fcf0-0132-2e51-20c9d07c6451", "id"=>"47"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 47 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=d2017bf0-fcf0-0132-2e51-20c9d07c6451
Completed 302 Found in 20ms (ActiveRecord: 1.1ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:47:35 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d2069e90-fcf0-0132-2e51-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d2017bf0-fcf0-0132-2e51-20c9d07c6451", "oauth_nonce"=>"9750418681275", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435186053", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"0qnmzKDTRdP8HY1jJYSfZIUAsqc="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.1ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd2017bf0-fcf0-0132-2e51-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 45  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: 502d76293ef7d54b1b750faf6a4691e7025e4607a322135aac06f60cc059284b139e03e1470ccb79ef12b8e5253e0baf9f397560b1ad2c9cc6e5712c3ba954cc66a4ab9bd89e14ba7d71b30de38b46660bc0d1a023ce1a2d40ab96e8e041744afb0c74da9250bded13ee471db9e46a5f1e92478182c4445bba003379bf2122be
Verify_signature--send_signature: 0qnmzKDTRdP8HY1jJYSfZIUAsqc=  test_signature: M8EZ0qjkel6Vn4qWgW+Oto01VJk=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Dd2017bf0-fcf0-0132-2e51-20c9d07c6451%26oauth_nonce%3D9750418681275%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1435186053%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fd2069e90-fcf0-0132-2e51-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 5214ms (ActiveRecord: 2.1ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-06-24 15:55:44 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9ae9f600-fcf1-0132-2e54-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"9ae91bf0-fcf1-0132-2e54-20c9d07c6451", "oauth_nonce"=>"5779874083861", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1435186543", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"3/3aWLKygqC5wqB9JRvkoXfTcqw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '9ae91bf0-fcf1-0132-2e54-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 48  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University352'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 48 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = '04a9d79ec399a107dabc24a86d80cac07d1a90c8eaa5a28edc596492fb8f9d6b40d4ce7f0413756f62548008d456e42cb5ecda40b8f75550f90d454d646c03fa9d8c37de3eabda098c924eacfd5e549d537786168edda834c66b29b69a105745a0e7a0582f3781dc583e52d43f3e7048005547e29f7d1738d7d1ec9282d509e4', `status` = 'received', `updated_at` = '2015-06-24 22:55:45' WHERE `lti2_tp_registrations`.`id` = 50
  [1m[36m (11.7ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=50&return_url=/lti2_tp/registrations
Completed 302 Found in 641ms (ActiveRecord: 55.4ms)


Started GET "/lti_registration_wips?registration_id=50&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-06-24 15:55:45 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"50", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 50 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-06-24 22:55:45', 'Elan/LuMoS', 50, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University352', '2015-06-24 22:55:45')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2578.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2602.1ms)
Completed 200 OK in 3605ms (Views: 3453.8ms | ActiveRecord: 6.9ms)


Started PATCH "/lti_registration_wips/110" for 127.0.0.1 at 2015-06-24 15:55:52 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"38TOeVRbIIudbP1yxKWAufBoMGDF9SM1MmCQh3XNLsk=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University352"}, "commit"=>"Update Lti registration wip", "id"=>"110"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 110 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 50 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 110 LIMIT 1  [["id", "110"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 50 LIMIT 1[0m  [["id", 50]]
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University352'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '164c8b50-fcf2-0132-2e56-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9ae9f600-fcf1-0132-2e54-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:55:52Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"9ae91bf0-fcf1-0132-2e54-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9ae9f600-fcf1-0132-2e54-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"d29016a0a0ef0a1194d20cc1a1fa53c54661f6b351de85bf8aeefc5ed5a7f18dce624ec67222c16c74ea71193e60ad85334f60f4694221338920fdda23d67757\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-06-24 22:55:52' WHERE `lti2_tp_registrations`.`id` = 50
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9ae9f600-fcf1-0132-2e54-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"@id\":\"ToolProxyProposal_at_2015-06-24T22:55:52Z\",\"lti_version\":\"LTI-2p0\",\"tool_proxy_guid\":\"9ae91bf0-fcf1-0132-2e54-20c9d07c6451\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9ae9f600-fcf1-0132-2e54-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"CourseSection.label\",\"CourseSection.title\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"d29016a0a0ef0a1194d20cc1a1fa53c54661f6b351de85bf8aeefc5ed5a7f18dce624ec67222c16c74ea71193e60ad85334f60f4694221338920fdda23d67757\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"9ae91bf0-fcf1-0132-2e54-20c9d07c6451\",\"tc_half_shared_secret\":\"e5933a7c2a1c750593ada0443666d80e097797cbb54352e300f2dbd27118559d2de95d79a0fb68d1211959649f47cbe84ee970b4a7bf60467d014a52200ad522\"}', `updated_at` = '2015-06-24 22:55:52' WHERE `lti2_tp_registrations`.`id` = 50[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'e5933a7c2a1c750593ada0443666d80e097797cbb54352e300f2dbd27118559d2de95d79a0fb68d1211959649f47cbe84ee970b4a7bf60467d014a52200ad522d29016a0a0ef0a1194d20cc1a1fa53c54661f6b351de85bf8aeefc5ed5a7f18dce624ec67222c16c74ea71193e60ad85334f60f4694221338920fdda23d67757', `status` = 'reregistered', `updated_at` = '2015-06-24 22:55:52' WHERE `lti2_tp_registrations`.`id` = 50
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=9ae91bf0-fcf1-0132-2e54-20c9d07c6451&&id=50
Completed 302 Found in 411ms (ActiveRecord: 12.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=9ae91bf0-fcf1-0132-2e54-20c9d07c6451&&id=50" for 127.0.0.1 at 2015-06-24 15:55:52 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"9ae91bf0-fcf1-0132-2e54-20c9d07c6451", "id"=>"50"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 50 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=9ae91bf0-fcf1-0132-2e54-20c9d07c6451
Completed 302 Found in 21ms (ActiveRecord: 1.0ms)


Started PUT "/lti2_tp/tool_proxies/9ae91bf0-fcf1-0132-2e54-20c9d07c6451?correlation=164c8b50-fcf2-0132-2e56-20c9d07c6451" for 127.0.0.1 at 2015-06-24 15:55:55 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"164c8b50-fcf2-0132-2e56-20c9d07c6451", "id"=>"9ae91bf0-fcf1-0132-2e54-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"9ae91bf0-fcf1-0132-2e54-20c9d07c6451", :oauth_nonce=>"6727123864301", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435186555", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"WCtE7F2a/2LTqBmdlP8SG3p3M28="}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '9ae91bf0-fcf1-0132-2e54-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 48  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"9ae91bf0-fcf1-0132-2e54-20c9d07c6451", :oauth_nonce=>"6727123864301", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1435186555", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"WCtE7F2a/2LTqBmdlP8SG3p3M28="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University352'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 48  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (9.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 48 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mTenant Exists (0.9ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University352' AND `tenants`.`id` != 48) LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-06-24 22:59:06' WHERE `tenants`.`id` = 48
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `updated_at` = '2015-06-24 22:59:06' WHERE `lti2_tp_registrations`.`id` = 50[0m
  [1m[35m (0.9ms)[0m  COMMIT
"reregistration complete for 9ae91bf0-fcf1-0132-2e54-20c9d07c6451"
  Rendered text template (0.2ms)
Completed 200 OK in 191606ms (Views: 5.6ms | ActiveRecord: 17.4ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (49.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.3ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mActiveRecord::SchemaMigration Load (27.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Migrating to AddSessionsTable (20150709175556)
  [1m[35m (54.2ms)[0m  CREATE TABLE `sessions` (`id` int(11) auto_increment PRIMARY KEY, `session_id` varchar(255) NOT NULL, `data` text, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (32.6ms)[0m  [1mCREATE UNIQUE INDEX `index_sessions_on_session_id`  ON `sessions` (`session_id`) [0m
  [1m[35m (33.2ms)[0m  CREATE  INDEX `index_sessions_on_updated_at`  ON `sessions` (`updated_at`) 
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20150709175556')
  [1m[36m (5.7ms)[0m  [1mCOMMIT[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 08:44:05 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/11125e10-1124-0133-55ee-20c9d07c6451", "reg_key"=>"111259d0-1124-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"bab58cc91a8aeb873c0cea767937ec29", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 15:44:06', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '111259d0-1124-0133-55ee-20c9d07c6451', '39d111fa25e1c268a7d769e4f717044a', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/11125e10-1124-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"11125e10-1124-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'bab58cc91a8aeb873c0cea767937ec29', '2015-07-20 15:44:06', '2')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=79&return_url=/lti2_tp/registrations
Completed 302 Found in 404ms (ActiveRecord: 14.3ms)


Started GET "/lti_registration_wips?registration_id=79&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 08:44:06 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"79", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 79 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 15:44:07', 'Elan/LuMoS', 79, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0844.07', '2015-07-20 15:44:07')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2601.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2623.3ms)
Completed 200 OK in 3673ms (Views: 3469.2ms | ActiveRecord: 14.0ms)


Started PATCH "/lti_registration_wips/143" for 127.0.0.1 at 2015-07-20 08:44:14 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0844.07"}, "commit"=>"Update Lti registration wip", "id"=>"143"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 143 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 79 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0844.07', `updated_at` = '2015-07-20 15:44:14' WHERE `lti2_tp_registrations`.`id` = 79[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 143 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 79 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.1ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0844.07' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 15:44:14', 'Elan University-0844.07', '2015-07-20 15:44:14')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.4ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '18e9b7b0-1124-0133-55f0-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bab58cc91a8aeb873c0cea767937ec29\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/11125e10-1124-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"38d86896dc3e0049f96b2b926b55bd76\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 15:44:14' WHERE `lti2_tp_registrations`.`id` = 79
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 15:47:35' WHERE `lti2_tp_registrations`.`id` = 79[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.2ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0844.07' AND `tenants`.`id` != 71) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = '38d86896dc3e0049f96b2b926b55bd76', `tenant_key` = 'bab58cc91a8aeb873c0cea767937ec29', `updated_at` = '2015-07-20 15:47:35' WHERE `tenants`.`id` = 71[0m
  [1m[35m (1.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '38d86896dc3e0049f96b2b926b55bd76', `tenant_id` = 71, `updated_at` = '2015-07-20 15:47:35' WHERE `lti2_tp_registrations`.`id` = 79
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=bab58cc91a8aeb873c0cea767937ec29&&id=79
Completed 302 Found in 201122ms (ActiveRecord: 27.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=bab58cc91a8aeb873c0cea767937ec29&&id=79" for 127.0.0.1 at 2015-07-20 08:47:35 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"bab58cc91a8aeb873c0cea767937ec29", "id"=>"79"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 79 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=bab58cc91a8aeb873c0cea767937ec29
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 08:47:52 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/97b70770-1124-0133-55ee-20c9d07c6451", "reg_key"=>"97b70520-1124-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"d7b70f6888092841adeefa787ea2dff6", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 15:47:53', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '97b70520-1124-0133-55ee-20c9d07c6451', 'f74cc02539c337157e450905cd10e028', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/97b70770-1124-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"97b70770-1124-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'd7b70f6888092841adeefa787ea2dff6', '2015-07-20 15:47:53', '2')[0m
  [1m[35m (2.7ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=80&return_url=/lti2_tp/registrations
Completed 302 Found in 223ms (ActiveRecord: 4.5ms)


Started GET "/lti_registration_wips?registration_id=80&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 08:47:53 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"80", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 80 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 15:47:53', 'Elan/LuMoS', 80, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0847.53', '2015-07-20 15:47:53')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (173.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (179.3ms)
Completed 200 OK in 358ms (Views: 307.0ms | ActiveRecord: 3.5ms)


Started PATCH "/lti_registration_wips/144" for 127.0.0.1 at 2015-07-20 08:47:55 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0847.53"}, "commit"=>"Update Lti registration wip", "id"=>"144"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 144 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 80 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0847.53', `updated_at` = '2015-07-20 15:47:55' WHERE `lti2_tp_registrations`.`id` = 80
  [1m[36m (1.8ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 144 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 80 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0847.53' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 15:47:55', 'Elan University-0847.53', '2015-07-20 15:47:55')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (2.0ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '08c99870-1125-0133-55f0-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d7b70f6888092841adeefa787ea2dff6\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/97b70770-1124-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"ae465c1cef3d21c22b4075988f05b968\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 15:50:57' WHERE `lti2_tp_registrations`.`id` = 80[0m
  [1m[35m (3.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 15:51:01' WHERE `lti2_tp_registrations`.`id` = 80
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0847.53' AND `tenants`.`id` != 72) LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `tenants` SET `secret` = 'ae465c1cef3d21c22b4075988f05b968', `tenant_key` = 'd7b70f6888092841adeefa787ea2dff6', `updated_at` = '2015-07-20 15:51:01' WHERE `tenants`.`id` = 72
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'ae465c1cef3d21c22b4075988f05b968', `tenant_id` = 72, `updated_at` = '2015-07-20 15:51:01' WHERE `lti2_tp_registrations`.`id` = 80[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=d7b70f6888092841adeefa787ea2dff6&&id=80
Completed 302 Found in 185449ms (ActiveRecord: 21.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=d7b70f6888092841adeefa787ea2dff6&&id=80" for 127.0.0.1 at 2015-07-20 08:51:01 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"d7b70f6888092841adeefa787ea2dff6", "id"=>"80"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 80 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=d7b70f6888092841adeefa787ea2dff6
Completed 302 Found in 18ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:36:36 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66cb5d90-112b-0133-55ee-20c9d07c6451", "reg_key"=>"66cb5b80-112b-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"5a0269dd4cfd300ae82497382081202d", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:36:38', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '66cb5b80-112b-0133-55ee-20c9d07c6451', 'c69208a1077023f5babe318c48f0cc77', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66cb5d90-112b-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"66cb5d90-112b-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '5a0269dd4cfd300ae82497382081202d', '2015-07-20 16:36:38', '2')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=81&return_url=/lti2_tp/registrations
Completed 302 Found in 402ms (ActiveRecord: 32.4ms)


Started GET "/lti_registration_wips?registration_id=81&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:36:38 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"81", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 81 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:36:39', 'Elan/LuMoS', 81, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0936.38', '2015-07-20 16:36:39')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (169.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (176.7ms)
Completed 200 OK in 431ms (Views: 300.9ms | ActiveRecord: 3.4ms)


Started PATCH "/lti_registration_wips/145" for 127.0.0.1 at 2015-07-20 09:36:41 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0936.38"}, "commit"=>"Update Lti registration wip", "id"=>"145"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 145 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 81 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0936.38', `updated_at` = '2015-07-20 16:36:41' WHERE `lti2_tp_registrations`.`id` = 81[0m
  [1m[35m (2.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 145 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 81 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0936.38' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:36:41', 'Elan University-0936.38', '2015-07-20 16:36:41')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (1.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b7cc5f50-112b-0133-55f0-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"5a0269dd4cfd300ae82497382081202d\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/66cb5d90-112b-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"d8791e4e199009061047e3212f0cc5a5\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 16:38:47' WHERE `lti2_tp_registrations`.`id` = 81
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 16:38:47' WHERE `lti2_tp_registrations`.`id` = 81[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0936.38' AND `tenants`.`id` != 73) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = 'd8791e4e199009061047e3212f0cc5a5', `tenant_key` = '5a0269dd4cfd300ae82497382081202d', `updated_at` = '2015-07-20 16:38:48' WHERE `tenants`.`id` = 73[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'd8791e4e199009061047e3212f0cc5a5', `tenant_id` = 73, `updated_at` = '2015-07-20 16:38:48' WHERE `lti2_tp_registrations`.`id` = 81
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=5a0269dd4cfd300ae82497382081202d&&id=81
Completed 302 Found in 126604ms (ActiveRecord: 20.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=5a0269dd4cfd300ae82497382081202d&&id=81" for 127.0.0.1 at 2015-07-20 09:38:48 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"5a0269dd4cfd300ae82497382081202d", "id"=>"81"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 81 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=5a0269dd4cfd300ae82497382081202d
Completed 302 Found in 85ms (ActiveRecord: 4.9ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.7ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:39:48 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d8edcc40-112b-0133-55ee-20c9d07c6451", "reg_key"=>"d8edc990-112b-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"819bff10823543351882120886dac278", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:39:49', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'd8edc990-112b-0133-55ee-20c9d07c6451', 'd5e8de4cf8bb0e6520ab700be590d786', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d8edcc40-112b-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"d8edcc40-112b-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '819bff10823543351882120886dac278', '2015-07-20 16:39:49', '2')
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=82&return_url=/lti2_tp/registrations
Completed 302 Found in 409ms (ActiveRecord: 15.5ms)


Started GET "/lti_registration_wips?registration_id=82&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:39:49 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"82", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 82 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:39:49', 'Elan/LuMoS', 82, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0939.49', '2015-07-20 16:39:49')
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2467.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2492.3ms)
Completed 200 OK in 3523ms (Views: 3354.3ms | ActiveRecord: 11.4ms)


Started PATCH "/lti_registration_wips/146" for 127.0.0.1 at 2015-07-20 09:39:55 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0939.49"}, "commit"=>"Update Lti registration wip", "id"=>"146"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 146 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 82 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0939.49', `updated_at` = '2015-07-20 16:39:55' WHERE `lti2_tp_registrations`.`id` = 82[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 146 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 82 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0939.49' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:39:55', 'Elan University-0939.49', '2015-07-20 16:39:55')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '3c64f190-112c-0133-55f1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"819bff10823543351882120886dac278\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d8edcc40-112b-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"2161f9ab0efc137795b076973302cb8f\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 16:42:30' WHERE `lti2_tp_registrations`.`id` = 82
  [1m[36m (11.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 16:42:30' WHERE `lti2_tp_registrations`.`id` = 82[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0939.49' AND `tenants`.`id` != 74) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '2161f9ab0efc137795b076973302cb8f', `tenant_key` = '819bff10823543351882120886dac278', `updated_at` = '2015-07-20 16:42:30' WHERE `tenants`.`id` = 74[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '2161f9ab0efc137795b076973302cb8f', `tenant_id` = 74, `updated_at` = '2015-07-20 16:42:30' WHERE `lti2_tp_registrations`.`id` = 82
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=819bff10823543351882120886dac278&&id=82
Completed 302 Found in 154781ms (ActiveRecord: 31.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=819bff10823543351882120886dac278&&id=82" for 127.0.0.1 at 2015-07-20 09:42:30 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"819bff10823543351882120886dac278", "id"=>"82"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 82 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=819bff10823543351882120886dac278
Completed 302 Found in 16ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:42:38 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3f5e1310-112c-0133-55ee-20c9d07c6451", "reg_key"=>"3f5e0f80-112c-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"da2aa20bc46da2f8db96f826aaf75aca", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (1.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:42:38', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '3f5e0f80-112c-0133-55ee-20c9d07c6451', 'c78bbc4d07148075e76b932cb57df274', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3f5e1310-112c-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"3f5e1310-112c-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'da2aa20bc46da2f8db96f826aaf75aca', '2015-07-20 16:42:38', '2')[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=83&return_url=/lti2_tp/registrations
Completed 302 Found in 249ms (ActiveRecord: 3.2ms)


Started GET "/lti_registration_wips?registration_id=83&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:42:39 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"83", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 83 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:42:39', 'Elan/LuMoS', 83, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0942.39', '2015-07-20 16:42:39')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (199.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (205.4ms)
Completed 200 OK in 402ms (Views: 345.6ms | ActiveRecord: 3.8ms)


Started PATCH "/lti_registration_wips/147" for 127.0.0.1 at 2015-07-20 09:42:42 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0942.39"}, "commit"=>"Update Lti registration wip", "id"=>"147"}
  [1m[36mLtiRegistrationWip Load (0.9ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 147 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 83 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0942.39', `updated_at` = '2015-07-20 16:42:42' WHERE `lti2_tp_registrations`.`id` = 83
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 147 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 83 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0942.39' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:42:42', 'Elan University-0942.39', '2015-07-20 16:42:42')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b3004d50-112c-0133-55f1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"da2aa20bc46da2f8db96f826aaf75aca\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3f5e1310-112c-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"2549cdae084734c5fd28fa065614281d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 16:45:49' WHERE `lti2_tp_registrations`.`id` = 83[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 16:45:49' WHERE `lti2_tp_registrations`.`id` = 83
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0942.39' AND `tenants`.`id` != 75) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = '2549cdae084734c5fd28fa065614281d', `tenant_key` = 'da2aa20bc46da2f8db96f826aaf75aca', `updated_at` = '2015-07-20 16:45:49' WHERE `tenants`.`id` = 75
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '2549cdae084734c5fd28fa065614281d', `tenant_id` = 75, `updated_at` = '2015-07-20 16:45:49' WHERE `lti2_tp_registrations`.`id` = 83[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=da2aa20bc46da2f8db96f826aaf75aca&&id=83
Completed 302 Found in 186780ms (ActiveRecord: 21.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=da2aa20bc46da2f8db96f826aaf75aca&&id=83" for 127.0.0.1 at 2015-07-20 09:45:49 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"da2aa20bc46da2f8db96f826aaf75aca", "id"=>"83"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 83 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=da2aa20bc46da2f8db96f826aaf75aca
Completed 302 Found in 142ms (ActiveRecord: 4.9ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:47:13 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e21a3890-112c-0133-55ee-20c9d07c6451", "reg_key"=>"e21a3510-112c-0133-55ee-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"8bee51eda31dfb9765ff8a689a459e3a", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:47:14', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'e21a3510-112c-0133-55ee-20c9d07c6451', '86ecf65eaa7c1e305af93fe7378e105a', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e21a3890-112c-0133-55ee-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/5937a270-1090-0133-55ee-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"e21a3890-112c-0133-55ee-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '8bee51eda31dfb9765ff8a689a459e3a', '2015-07-20 16:47:14', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=84&return_url=/lti2_tp/registrations
Completed 302 Found in 414ms (ActiveRecord: 13.2ms)


Started GET "/lti_registration_wips?registration_id=84&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:47:14 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"84", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 84 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:47:14', 'Elan/LuMoS', 84, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0947.14', '2015-07-20 16:47:14')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2553.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2577.6ms)
Completed 200 OK in 3688ms (Views: 3496.1ms | ActiveRecord: 11.9ms)


Started PATCH "/lti_registration_wips/148" for 127.0.0.1 at 2015-07-20 09:47:39 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0947.14"}, "commit"=>"Update Lti registration wip", "id"=>"148"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 148 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 84 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0947.14', `updated_at` = '2015-07-20 16:47:39' WHERE `lti2_tp_registrations`.`id` = 84[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 148 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 84 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0947.14' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:47:39', 'Elan University-0947.14', '2015-07-20 16:47:39')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (1.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'bb6e24a0-112d-0133-55f2-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8bee51eda31dfb9765ff8a689a459e3a\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/e21a3890-112c-0133-55ee-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"de9c508023329f2aa447e2b70ed6d291\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 16:53:12' WHERE `lti2_tp_registrations`.`id` = 84
  [1m[36m (3.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 16:53:13' WHERE `lti2_tp_registrations`.`id` = 84[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0947.14' AND `tenants`.`id` != 76) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `tenants` SET `secret` = 'de9c508023329f2aa447e2b70ed6d291', `tenant_key` = '8bee51eda31dfb9765ff8a689a459e3a', `updated_at` = '2015-07-20 16:53:13' WHERE `tenants`.`id` = 76[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'de9c508023329f2aa447e2b70ed6d291', `tenant_id` = 76, `updated_at` = '2015-07-20 16:53:13' WHERE `lti2_tp_registrations`.`id` = 84
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=8bee51eda31dfb9765ff8a689a459e3a&&id=84
Completed 302 Found in 334266ms (ActiveRecord: 30.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8bee51eda31dfb9765ff8a689a459e3a&&id=84" for 127.0.0.1 at 2015-07-20 09:53:13 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"8bee51eda31dfb9765ff8a689a459e3a", "id"=>"84"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 84 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=8bee51eda31dfb9765ff8a689a459e3a
Completed 302 Found in 92ms (ActiveRecord: 5.9ms)
  [1m[36mLti2Tp::Registry Load (0.4ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:57:04 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451", "reg_key"=>"429c8220-112e-0133-55f3-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"20b7e306aa928de8cda569e4ea0742ef", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.4ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:57:05', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '429c8220-112e-0133-55f3-20c9d07c6451', '3c3950127d282c70e041614967f856e3', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"429de450-112e-0133-55f3-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '20b7e306aa928de8cda569e4ea0742ef', '2015-07-20 16:57:05', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=85&return_url=/lti2_tp/registrations
Completed 302 Found in 409ms (ActiveRecord: 13.1ms)


Started GET "/lti_registration_wips?registration_id=85&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:57:05 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"85", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 85 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:57:05', 'Elan/LuMoS', 85, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0957.05', '2015-07-20 16:57:05')
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2495.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2518.6ms)
Completed 200 OK in 3533ms (Views: 3371.9ms | ActiveRecord: 12.4ms)


Started PATCH "/lti_registration_wips/149" for 127.0.0.1 at 2015-07-20 09:57:12 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0957.05"}, "commit"=>"Update Lti registration wip", "id"=>"149"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 149 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 85 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0957.05', `updated_at` = '2015-07-20 16:57:12' WHERE `lti2_tp_registrations`.`id` = 85[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 149 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 85 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0957.05' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:57:12', 'Elan University-0957.05', '2015-07-20 16:57:12')[0m
  [1m[35m (2.2ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: []
Could not install resource_handler.message due to missing capabilities: []
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '6d325370-112e-0133-55f4-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"20b7e306aa928de8cda569e4ea0742ef\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"6f498af3f0fd3e0346b76dec4933ddc4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 16:58:11' WHERE `lti2_tp_registrations`.`id` = 85
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 16:58:11' WHERE `lti2_tp_registrations`.`id` = 85[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0957.05' AND `tenants`.`id` != 77) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `tenants` SET `secret` = '6f498af3f0fd3e0346b76dec4933ddc4', `tenant_key` = '20b7e306aa928de8cda569e4ea0742ef', `updated_at` = '2015-07-20 16:58:11' WHERE `tenants`.`id` = 77[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '6f498af3f0fd3e0346b76dec4933ddc4', `tenant_id` = 77, `updated_at` = '2015-07-20 16:58:11' WHERE `lti2_tp_registrations`.`id` = 85
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=20b7e306aa928de8cda569e4ea0742ef&&id=85
Completed 302 Found in 59050ms (ActiveRecord: 24.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=20b7e306aa928de8cda569e4ea0742ef&&id=85" for 127.0.0.1 at 2015-07-20 09:58:11 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"20b7e306aa928de8cda569e4ea0742ef", "id"=>"85"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 85 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=20b7e306aa928de8cda569e4ea0742ef
Completed 302 Found in 93ms (ActiveRecord: 5.3ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:59:54 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a620bf20-112e-0133-55f3-20c9d07c6451", "reg_key"=>"a620bcd0-112e-0133-55f3-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"cf056452acf23255b7e89c628184b873", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 16:59:55', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'a620bcd0-112e-0133-55f3-20c9d07c6451', 'be9336e9ca763023d32a0f43d67df0dc', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a620bf20-112e-0133-55f3-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"a620bf20-112e-0133-55f3-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'cf056452acf23255b7e89c628184b873', '2015-07-20 16:59:55', '2')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=86&return_url=/lti2_tp/registrations
Completed 302 Found in 394ms (ActiveRecord: 13.3ms)


Started GET "/lti_registration_wips?registration_id=86&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 09:59:55 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"86", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 86 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 16:59:55', 'Elan/LuMoS', 86, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0959.55', '2015-07-20 16:59:55')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2517.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2538.6ms)
Completed 200 OK in 3557ms (Views: 3385.0ms | ActiveRecord: 11.4ms)


Started PATCH "/lti_registration_wips/150" for 127.0.0.1 at 2015-07-20 10:00:01 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0959.55"}, "commit"=>"Update Lti registration wip", "id"=>"150"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 150 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 86 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0959.55', `updated_at` = '2015-07-20 17:00:01' WHERE `lti2_tp_registrations`.`id` = 86[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 150 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 86 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0959.55' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 17:00:02', 'Elan University-0959.55', '2015-07-20 17:00:02')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Completed 500 Internal Server Error in 100109ms

NoMethodError - undefined method `<<' for #<Hash:0x007fdda33ea4d0>:
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:205:in `block in resolve_tool_profile'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:185:in `resolve_tool_profile'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:22:in `create_tool_proxy'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:38:in `prepare_tool_proxy'
  app/controllers/lti_registration_wips_controller.rb:45:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:91:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/661d473b9232e1ad/variables" for 127.0.0.1 at 2015-07-20 10:01:42 -0700
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 10:02:25 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01e7e7d0-112f-0133-55f3-20c9d07c6451", "reg_key"=>"01e7e460-112f-0133-55f3-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"1741dd29eeb6ac869f98f96f7175fe95", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-20 17:02:26', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '01e7e460-112f-0133-55f3-20c9d07c6451', '955c6cc6eac8ab46cfaa570381e08e30', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01e7e7d0-112f-0133-55f3-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/429de450-112e-0133-55f3-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"01e7e7d0-112f-0133-55f3-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '1741dd29eeb6ac869f98f96f7175fe95', '2015-07-20 17:02:26', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=87&return_url=/lti2_tp/registrations
Completed 302 Found in 388ms (ActiveRecord: 14.8ms)


Started GET "/lti_registration_wips?registration_id=87&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 10:02:27 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"87", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 87 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 17:02:27', 'Elan/LuMoS', 87, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-1002.27', '2015-07-20 17:02:27')
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2467.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2489.3ms)
Completed 200 OK in 3522ms (Views: 3348.2ms | ActiveRecord: 12.3ms)


Started PATCH "/lti_registration_wips/151" for 127.0.0.1 at 2015-07-20 10:02:33 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"g6HeFg9BG6bq2KDZ8EOuDo2QMAA7Qpn2GB0k72mVH8Y=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-1002.27"}, "commit"=>"Update Lti registration wip", "id"=>"151"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 87 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-1002.27', `updated_at` = '2015-07-20 17:02:33' WHERE `lti2_tp_registrations`.`id` = 87[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 87 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-1002.27' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-20 17:02:34', 'Elan University-1002.27', '2015-07-20 17:02:34')[0m
  [1m[35m (1.3ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '246fd0f0-112f-0133-55f5-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1741dd29eeb6ac869f98f96f7175fe95\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01e7e7d0-112f-0133-55f3-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"1784f016f6f7345663fe55308b173b97\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-20 17:03:18' WHERE `lti2_tp_registrations`.`id` = 87
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-20 17:03:18' WHERE `lti2_tp_registrations`.`id` = 87[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-1002.27' AND `tenants`.`id` != 79) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = '1784f016f6f7345663fe55308b173b97', `tenant_key` = '1741dd29eeb6ac869f98f96f7175fe95', `updated_at` = '2015-07-20 17:03:18' WHERE `tenants`.`id` = 79[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '1784f016f6f7345663fe55308b173b97', `tenant_id` = 79, `updated_at` = '2015-07-20 17:03:18' WHERE `lti2_tp_registrations`.`id` = 87
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=1741dd29eeb6ac869f98f96f7175fe95&&id=87
Completed 302 Found in 45003ms (ActiveRecord: 23.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1741dd29eeb6ac869f98f96f7175fe95&&id=87" for 127.0.0.1 at 2015-07-20 10:03:18 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1741dd29eeb6ac869f98f96f7175fe95", "id"=>"87"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 87 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=1741dd29eeb6ac869f98f96f7175fe95
Completed 302 Found in 16ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 10:07:36 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01e7e7d0-112f-0133-55f3-20c9d07c6451", "reg_key"=>"01e7e460-112f-0133-55f3-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"1741dd29eeb6ac869f98f96f7175fe95", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 33ms

Errno::ECONNREFUSED - Connection refused - connect(2) for "rails.kinexis.com" port 4000:
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:879:in `block in connect'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/timeout.rb:91:in `block in timeout'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/timeout.rb:101:in `timeout'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:878:in `connect'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:863:in `do_start'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:852:in `start'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:1369:in `request'
  httparty (0.8.3) lib/httparty/request.rb:76:in `perform'
  httparty (0.8.3) lib/httparty.rb:400:in `perform_request'
  httparty (0.8.3) lib/httparty.rb:347:in `get'
  httparty (0.8.3) lib/httparty.rb:432:in `get'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/message_support.rb:135:in `invoke_unsigned_service'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:32:in `get_tool_consumer_profile'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:38:in `create'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/9c77e62f8a621fbb/variables" for 127.0.0.1 at 2015-07-20 10:07:36 -0700


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-20 10:07:37 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/01e7e7d0-112f-0133-55f3-20c9d07c6451", "reg_key"=>"01e7e460-112f-0133-55f3-20c9d07c6451", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"1741dd29eeb6ac869f98f96f7175fe95", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 38ms

Errno::ECONNREFUSED - Connection refused - connect(2) for "rails.kinexis.com" port 4000:
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:879:in `block in connect'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/timeout.rb:91:in `block in timeout'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/timeout.rb:101:in `timeout'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:878:in `connect'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:863:in `do_start'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:852:in `start'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/net/http.rb:1369:in `request'
  httparty (0.8.3) lib/httparty/request.rb:76:in `perform'
  httparty (0.8.3) lib/httparty.rb:400:in `perform_request'
  httparty (0.8.3) lib/httparty.rb:347:in `get'
  httparty (0.8.3) lib/httparty.rb:432:in `get'
  /Users/johntibbetts/git/LTI2-Reference/lib/lti2_commons/lib/lti2_commons/message_support.rb:135:in `invoke_unsigned_service'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:32:in `get_tool_consumer_profile'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:38:in `create'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/1fba062edb9b739b/variables" for 127.0.0.1 at 2015-07-20 10:07:37 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:20:58 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e015f60-1865-0133-7948-406c8f40a599", "reg_key"=>"9e0158e0-1865-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"8fae0750f683d25e2a58fdd0ca4f3f1f", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:20:59', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '9e0158e0-1865-0133-7948-406c8f40a599', '8acbfad0cabbb32f40f31c6f7d80aa7b', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e015f60-1865-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"9e015f60-1865-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '8fae0750f683d25e2a58fdd0ca4f3f1f', '2015-07-29 21:20:59', '2')
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=6&return_url=/lti2_tp/registrations
Completed 302 Found in 415ms (ActiveRecord: 13.7ms)


Started GET "/lti_registration_wips?registration_id=6&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:20:59 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"6", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 6 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:20:59', 'Elan/LuMoS', 6, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0220.59', '2015-07-29 21:20:59')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2618.3ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2644.1ms)
Completed 200 OK in 3697ms (Views: 3528.3ms | ActiveRecord: 12.9ms)


Started PATCH "/lti_registration_wips/6" for 127.0.0.1 at 2015-07-29 14:21:11 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0220.59"}, "commit"=>"Update Lti registration wip", "id"=>"6"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 6 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 6 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0220.59', `updated_at` = '2015-07-29 21:21:11' WHERE `lti2_tp_registrations`.`id` = 6[0m
  [1m[35m (1.6ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 6 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 6 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0220.59' LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:21:11', 'Elan University-0220.59', '2015-07-29 21:21:11')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'a910b040-1865-0133-7949-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8fae0750f683d25e2a58fdd0ca4f3f1f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e015f60-1865-0133-7948-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"277a59f7af99eec8413db7a8cd988536\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-29 21:21:11' WHERE `lti2_tp_registrations`.`id` = 6
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-29 21:21:12' WHERE `lti2_tp_registrations`.`id` = 6[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0220.59' AND `tenants`.`id` != 6) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = '277a59f7af99eec8413db7a8cd988536', `tenant_key` = '8fae0750f683d25e2a58fdd0ca4f3f1f', `updated_at` = '2015-07-29 21:21:12' WHERE `tenants`.`id` = 6[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '277a59f7af99eec8413db7a8cd988536', `tenant_id` = 6, `updated_at` = '2015-07-29 21:21:12' WHERE `lti2_tp_registrations`.`id` = 6
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=8fae0750f683d25e2a58fdd0ca4f3f1f&&id=6
Completed 302 Found in 722ms (ActiveRecord: 24.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8fae0750f683d25e2a58fdd0ca4f3f1f&&id=6" for 127.0.0.1 at 2015-07-29 14:21:12 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"8fae0750f683d25e2a58fdd0ca4f3f1f", "id"=>"6"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 6 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=8fae0750f683d25e2a58fdd0ca4f3f1f
Completed 302 Found in 22290ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:22:11 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/ca0429e0-1865-0133-7948-406c8f40a599", "reg_key"=>"ca042660-1865-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"d74cfc25379fdbed33d3f5c0e7b57caa", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:22:12', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'ca042660-1865-0133-7948-406c8f40a599', '542d1564c9179d279f523fc4d6a37c3f', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/ca0429e0-1865-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"ca0429e0-1865-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'd74cfc25379fdbed33d3f5c0e7b57caa', '2015-07-29 21:22:12', '2')[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=7&return_url=/lti2_tp/registrations
Completed 302 Found in 209ms (ActiveRecord: 3.0ms)


Started GET "/lti_registration_wips?registration_id=7&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:22:12 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"7", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 7 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:22:12', 'Elan/LuMoS', 7, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0222.12', '2015-07-29 21:22:12')[0m
  [1m[35m (1.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (226.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (232.7ms)
Completed 200 OK in 387ms (Views: 342.8ms | ActiveRecord: 3.6ms)


Started PATCH "/lti_registration_wips/7" for 127.0.0.1 at 2015-07-29 14:22:15 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0222.12"}, "commit"=>"Update Lti registration wip", "id"=>"7"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 7 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 7 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0222.12', `updated_at` = '2015-07-29 21:22:15' WHERE `lti2_tp_registrations`.`id` = 7
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 7 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 7 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0222.12' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:22:15', 'Elan University-0222.12', '2015-07-29 21:22:15')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (6.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'e88a3480-1865-0133-7949-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d74cfc25379fdbed33d3f5c0e7b57caa\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/ca0429e0-1865-0133-7948-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"6b4d9a936610622d9d2bc68257a31765\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-29 21:22:58' WHERE `lti2_tp_registrations`.`id` = 7[0m
  [1m[35m (5.9ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-29 21:22:58' WHERE `lti2_tp_registrations`.`id` = 7
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0222.12' AND `tenants`.`id` != 7) LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `tenants` SET `secret` = '6b4d9a936610622d9d2bc68257a31765', `tenant_key` = 'd74cfc25379fdbed33d3f5c0e7b57caa', `updated_at` = '2015-07-29 21:22:58' WHERE `tenants`.`id` = 7
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '6b4d9a936610622d9d2bc68257a31765', `tenant_id` = 7, `updated_at` = '2015-07-29 21:22:58' WHERE `lti2_tp_registrations`.`id` = 7[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=d74cfc25379fdbed33d3f5c0e7b57caa&&id=7
Completed 302 Found in 43864ms (ActiveRecord: 31.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=d74cfc25379fdbed33d3f5c0e7b57caa&&id=7" for 127.0.0.1 at 2015-07-29 14:22:58 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"d74cfc25379fdbed33d3f5c0e7b57caa", "id"=>"7"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 7 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=d74cfc25379fdbed33d3f5c0e7b57caa
Completed 302 Found in 16ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:23:35 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fb94fef0-1865-0133-7948-406c8f40a599", "reg_key"=>"fb94fa90-1865-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"53969963987d6b4490036d22db3ec31b", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:23:35', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'fb94fa90-1865-0133-7948-406c8f40a599', '7a007966e880eabec729f83b28d45084', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fb94fef0-1865-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"fb94fef0-1865-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '53969963987d6b4490036d22db3ec31b', '2015-07-29 21:23:35', '2')
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=8&return_url=/lti2_tp/registrations
Completed 302 Found in 203ms (ActiveRecord: 2.5ms)


Started GET "/lti_registration_wips?registration_id=8&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:23:35 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"8", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 8 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:23:35', 'Elan/LuMoS', 8, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0223.35', '2015-07-29 21:23:35')
  [1m[36m (6.0ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (205.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (213.9ms)
Completed 200 OK in 427ms (Views: 351.5ms | ActiveRecord: 8.6ms)


Started PATCH "/lti_registration_wips/8" for 127.0.0.1 at 2015-07-29 14:23:40 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0223.35"}, "commit"=>"Update Lti registration wip", "id"=>"8"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 8 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 8 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0223.35', `updated_at` = '2015-07-29 21:23:40' WHERE `lti2_tp_registrations`.`id` = 8[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 8 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 8 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0223.35' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:23:40', 'Elan University-0223.35', '2015-07-29 21:23:40')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '10cc07b0-1866-0133-7949-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"53969963987d6b4490036d22db3ec31b\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/fb94fef0-1865-0133-7948-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"859e9811af72d164b1269b1f719716df\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-29 21:24:06' WHERE `lti2_tp_registrations`.`id` = 8
  [1m[36m (11.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-29 21:24:06' WHERE `lti2_tp_registrations`.`id` = 8[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0223.35' AND `tenants`.`id` != 8) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '859e9811af72d164b1269b1f719716df', `tenant_key` = '53969963987d6b4490036d22db3ec31b', `updated_at` = '2015-07-29 21:24:06' WHERE `tenants`.`id` = 8[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '859e9811af72d164b1269b1f719716df', `tenant_id` = 8, `updated_at` = '2015-07-29 21:24:06' WHERE `lti2_tp_registrations`.`id` = 8
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=53969963987d6b4490036d22db3ec31b&&id=8
Completed 302 Found in 25925ms (ActiveRecord: 29.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=53969963987d6b4490036d22db3ec31b&&id=8" for 127.0.0.1 at 2015-07-29 14:24:06 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"53969963987d6b4490036d22db3ec31b", "id"=>"8"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 8 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=53969963987d6b4490036d22db3ec31b
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:26:39 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/69206310-1866-0133-7948-406c8f40a599", "reg_key"=>"69205f70-1866-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"e18bceb37997ba4ece3a61efe95f65c2", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:26:40', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '69205f70-1866-0133-7948-406c8f40a599', '76ef1ac0136ea540b74f7af9cf4cc6a9', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/69206310-1866-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"69206310-1866-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'e18bceb37997ba4ece3a61efe95f65c2', '2015-07-29 21:26:40', '2')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=9&return_url=/lti2_tp/registrations
Completed 302 Found in 456ms (ActiveRecord: 13.8ms)


Started GET "/lti_registration_wips?registration_id=9&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:26:40 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"9", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 9 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:26:41', 'Elan/LuMoS', 9, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0226.41', '2015-07-29 21:26:41')
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2533.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2556.2ms)
Completed 200 OK in 3664ms (Views: 3481.3ms | ActiveRecord: 10.7ms)


Started PATCH "/lti_registration_wips/9" for 127.0.0.1 at 2015-07-29 14:26:47 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0226.41"}, "commit"=>"Update Lti registration wip", "id"=>"9"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 9 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 9 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0226.41', `updated_at` = '2015-07-29 21:26:47' WHERE `lti2_tp_registrations`.`id` = 9[0m
  [1m[35m (4.1ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 9 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 9 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0226.41' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:26:47', 'Elan University-0226.41', '2015-07-29 21:26:47')[0m
  [1m[35m (0.7ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '8d7793c0-1866-0133-794a-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"e18bceb37997ba4ece3a61efe95f65c2\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/69206310-1866-0133-7948-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"240d3b06e03a8346a03250c174e999e3\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-29 21:27:35' WHERE `lti2_tp_registrations`.`id` = 9
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-29 21:27:35' WHERE `lti2_tp_registrations`.`id` = 9[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0226.41' AND `tenants`.`id` != 9) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '240d3b06e03a8346a03250c174e999e3', `tenant_key` = 'e18bceb37997ba4ece3a61efe95f65c2', `updated_at` = '2015-07-29 21:27:35' WHERE `tenants`.`id` = 9[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '240d3b06e03a8346a03250c174e999e3', `tenant_id` = 9, `updated_at` = '2015-07-29 21:27:35' WHERE `lti2_tp_registrations`.`id` = 9
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=e18bceb37997ba4ece3a61efe95f65c2&&id=9
Completed 302 Found in 47939ms (ActiveRecord: 27.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=e18bceb37997ba4ece3a61efe95f65c2&&id=9" for 127.0.0.1 at 2015-07-29 14:27:35 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"e18bceb37997ba4ece3a61efe95f65c2", "id"=>"9"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 9 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=e18bceb37997ba4ece3a61efe95f65c2
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:28:07 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e151d00-1866-0133-7948-406c8f40a599", "reg_key"=>"9e1518c0-1866-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"2a773c08d36e43f3a0674d96cf3b1312", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (1.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:28:08', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '9e1518c0-1866-0133-7948-406c8f40a599', 'dea6486ce169669e6d0022443d7e718e', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e151d00-1866-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"9e151d00-1866-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2a773c08d36e43f3a0674d96cf3b1312', '2015-07-29 21:28:08', '2')[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=10&return_url=/lti2_tp/registrations
Completed 302 Found in 266ms (ActiveRecord: 3.4ms)


Started GET "/lti_registration_wips?registration_id=10&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:28:08 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"10", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:28:08', 'Elan/LuMoS', 10, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0228.08', '2015-07-29 21:28:08')[0m
  [1m[35m (0.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (186.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (192.2ms)
Completed 200 OK in 376ms (Views: 319.1ms | ActiveRecord: 3.7ms)


Started PATCH "/lti_registration_wips/10" for 127.0.0.1 at 2015-07-29 14:28:11 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0228.08"}, "commit"=>"Update Lti registration wip", "id"=>"10"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 10 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0228.08', `updated_at` = '2015-07-29 21:28:11' WHERE `lti2_tp_registrations`.`id` = 10
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 10 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0228.08' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:28:11', 'Elan University-0228.08', '2015-07-29 21:28:11')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
  [1m[35m (3.6ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f8cc9ac0-1866-0133-794a-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"2a773c08d36e43f3a0674d96cf3b1312\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/9e151d00-1866-0133-7948-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"b9eacd3f71fd9452f78f905c104bc01e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-29 21:30:35' WHERE `lti2_tp_registrations`.`id` = 10[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36m (1.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-29 21:30:35' WHERE `lti2_tp_registrations`.`id` = 10
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (1.5ms)[0m  BEGIN
  [1m[36mTenant Exists (1.1ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0228.08' AND `tenants`.`id` != 10) LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `tenants` SET `secret` = 'b9eacd3f71fd9452f78f905c104bc01e', `tenant_key` = '2a773c08d36e43f3a0674d96cf3b1312', `updated_at` = '2015-07-29 21:30:35' WHERE `tenants`.`id` = 10
  [1m[36m (5.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'b9eacd3f71fd9452f78f905c104bc01e', `tenant_id` = 10, `updated_at` = '2015-07-29 21:30:35' WHERE `lti2_tp_registrations`.`id` = 10[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=2a773c08d36e43f3a0674d96cf3b1312&&id=10
Completed 302 Found in 144414ms (ActiveRecord: 31.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=2a773c08d36e43f3a0674d96cf3b1312&&id=10" for 127.0.0.1 at 2015-07-29 14:30:35 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"2a773c08d36e43f3a0674d96cf3b1312", "id"=>"10"}
  [1m[36mLti2Tp::Registration Load (1.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 10 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=2a773c08d36e43f3a0674d96cf3b1312
Completed 302 Found in 247ms (ActiveRecord: 24.1ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:33:44 -0700
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/67160190-1867-0133-7948-406c8f40a599", "reg_key"=>"6715fd40-1867-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"705af349689619ccfa5c5c4b3e6d973e", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:33:46', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '6715fd40-1867-0133-7948-406c8f40a599', '89f00065dcefe12e922d85711cef35d5', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/67160190-1867-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"67160190-1867-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '705af349689619ccfa5c5c4b3e6d973e', '2015-07-29 21:33:46', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=13&return_url=/lti2_tp/registrations
Completed 302 Found in 417ms (ActiveRecord: 14.5ms)


Started GET "/lti_registration_wips?registration_id=13&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:33:46 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"13", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 13 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:33:46', 'Elan/LuMoS', 13, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0233.46', '2015-07-29 21:33:46')
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2767.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2790.3ms)
Completed 200 OK in 3893ms (Views: 3707.1ms | ActiveRecord: 10.4ms)


Started PATCH "/lti_registration_wips/13" for 127.0.0.1 at 2015-07-29 14:33:52 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0233.46"}, "commit"=>"Update Lti registration wip", "id"=>"13"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 13 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 13 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0233.46', `updated_at` = '2015-07-29 21:33:52' WHERE `lti2_tp_registrations`.`id` = 13[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 13 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 13 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0233.46' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:33:53', 'Elan University-0233.46', '2015-07-29 21:33:53')[0m
  [1m[35m (0.9ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
Redirected to http://localhost:5000/lti2_tp/registrations?status=failure&lti_errormsg=ToolProxy+error%3A+&lti_errorlog=ToolProxy+error%3A+&&id=13
Completed 302 Found in 120633ms (ActiveRecord: 13.1ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=ToolProxy+error%3A+&lti_errorlog=ToolProxy+error%3A+&&id=13" for 127.0.0.1 at 2015-07-29 14:35:53 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:36:30 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c9e38f70-1867-0133-7948-406c8f40a599", "reg_key"=>"c9e38ca0-1867-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"d1c61dc32d6bdd9cc5f1e18ea479bdc7", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:36:32', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c9e38ca0-1867-0133-7948-406c8f40a599', '86343bacdcdffdb3cefad5c3bc851c5c', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c9e38f70-1867-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c9e38f70-1867-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'd1c61dc32d6bdd9cc5f1e18ea479bdc7', '2015-07-29 21:36:32', '2')
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=14&return_url=/lti2_tp/registrations
Completed 302 Found in 418ms (ActiveRecord: 13.9ms)


Started GET "/lti_registration_wips?registration_id=14&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:36:32 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"14", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 14 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:36:32', 'Elan/LuMoS', 14, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0236.32', '2015-07-29 21:36:32')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2827.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2849.9ms)
Completed 200 OK in 3878ms (Views: 3711.1ms | ActiveRecord: 9.3ms)


Started PATCH "/lti_registration_wips/14" for 127.0.0.1 at 2015-07-29 14:36:40 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0236.32"}, "commit"=>"Update Lti registration wip", "id"=>"14"}
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 14 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 14 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0236.32', `updated_at` = '2015-07-29 21:36:40' WHERE `lti2_tp_registrations`.`id` = 14[0m
  [1m[35m (2.1ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 14 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 14 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0236.32' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:36:41', 'Elan University-0236.32', '2015-07-29 21:36:41')[0m
  [1m[35m (0.9ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
Completed 500 Internal Server Error in 46977ms

NameError - undefined local variable or method `result' for #<Lti2Tp::Registration:0x007fb60bdaca50>:
  activemodel (4.1.9) lib/active_model/attribute_methods.rb:435:in `method_missing'
  activerecord (4.1.9) lib/active_record/attribute_methods.rb:213:in `method_missing'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:218:in `resolve_tool_profile'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:23:in `create_tool_proxy'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:45:in `prepare_tool_proxy'
  app/controllers/lti_registration_wips_controller.rb:45:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:91:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/98431de16f851067/variables" for 127.0.0.1 at 2015-07-29 14:37:28 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:38:06 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/001c51f0-1868-0133-7948-406c8f40a599", "reg_key"=>"001c45f0-1868-0133-7948-406c8f40a599", "reg_password"=>"[FILTERED]", "tool_proxy_guid"=>"5ce6029ba72b127562047236b5fe666a", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-29 21:38:07', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '001c45f0-1868-0133-7948-406c8f40a599', '576ccaeae674bbe531e5a8c981735da5', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/001c51f0-1868-0133-7948-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/37527c00-1865-0133-7945-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"001c51f0-1868-0133-7948-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '5ce6029ba72b127562047236b5fe666a', '2015-07-29 21:38:07', '2')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=15&return_url=/lti2_tp/registrations
Completed 302 Found in 419ms (ActiveRecord: 13.6ms)


Started GET "/lti_registration_wips?registration_id=15&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 14:38:07 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"15", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 15 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:38:07', 'Elan/LuMoS', 15, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0238.07', '2015-07-29 21:38:07')
  [1m[36m (1.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2764.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2786.1ms)
Completed 200 OK in 3836ms (Views: 3662.8ms | ActiveRecord: 10.8ms)


Started PATCH "/lti_registration_wips/15" for 127.0.0.1 at 2015-07-29 14:38:14 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Cpw+tj9jwbqGKzN/y0L0ivxeULaHoBzpNx+Kb15v7BU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0238.07"}, "commit"=>"Update Lti registration wip", "id"=>"15"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 15 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 15 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0238.07', `updated_at` = '2015-07-29 21:38:14' WHERE `lti2_tp_registrations`.`id` = 15[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 15 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 15 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0238.07' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-29 21:38:14', 'Elan University-0238.07', '2015-07-29 21:38:14')[0m
  [1m[35m (1.2ms)[0m  COMMIT
Could not install resource_handler.message due to missing capabilities: ["Result.uri"]
Redirected to http://localhost:5000/lti2_tp/registrations?status=failure&lti_errormsg=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&lti_errorlog=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&&id=15
Completed 302 Found in 8148ms (ActiveRecord: 12.8ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&lti_errorlog=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&&id=15" for 127.0.0.1 at 2015-07-29 14:38:22 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"ToolProxy error: Could not install resource_handler.message due to missing capabilities: [\"Result.uri\"]", "lti_errorlog"=>"ToolProxy error: Could not install resource_handler.message due to missing capabilities: [\"Result.uri\"]", "id"=>"15"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 15 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&lti_errormsg=ToolProxy+error%3A+Could+not+install+resource_handler.message+due+to+missing+capabilities%3A+%5B%22Result.uri%22%5D&status=failure
Completed 302 Found in 20ms (ActiveRecord: 0.8ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 17:50:50 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599", "reg_key"=>"f034ce50-1882-0133-b515-406c8f40a599", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"6c3e5bd28ed052206c19e3605eff0aa0"}
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-30 00:50:54', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'f034ce50-1882-0133-b515-406c8f40a599', '26ab0a716251baa38f1bf25d6bbaea32', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"f035b7e0-1882-0133-b515-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '6c3e5bd28ed052206c19e3605eff0aa0', '2015-07-30 00:50:54', '2')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=33&return_url=/lti2_tp/registrations
Completed 302 Found in 3348ms (ActiveRecord: 11.4ms)


Started GET "/lti_registration_wips?registration_id=33&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 17:50:54 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"33", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 33 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 00:50:55', 'Elan/LuMoS', 33, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0550.55', '2015-07-30 00:50:55')
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2766.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2788.7ms)
Completed 200 OK in 4050ms (Views: 3784.8ms | ActiveRecord: 29.7ms)


Started PATCH "/lti_registration_wips/41" for 127.0.0.1 at 2015-07-29 17:51:03 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6jp/dt3bM3m/wKnp/x8r+uqu7NTkeNm7kxbMEjWak7g=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0550.55"}, "commit"=>"Update Lti registration wip", "id"=>"41"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 41 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 33 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0550.55', `updated_at` = '2015-07-30 00:51:03' WHERE `lti2_tp_registrations`.`id` = 33[0m
  [1m[35m (3.7ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 33 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0550.55' LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 00:51:03', 'Elan University-0550.55', '2015-07-30 00:51:03')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '00620ab0-1883-0133-b516-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6c3e5bd28ed052206c19e3605eff0aa0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"98a7fdc2bd3154c052f8565f50b2e3acef52c8aeba40a06b7bc1249082afb83104812dfcc5e1199a47cd15f04a09af49e2bd5f3d39264cbc6d4fb4c80b2cd59e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 00:51:24' WHERE `lti2_tp_registrations`.`id` = 33
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-30 00:52:12' WHERE `lti2_tp_registrations`.`id` = 33[0m
  [1m[35m (2.7ms)[0m  COMMIT
Completed 500 Internal Server Error in 239596ms

NoMethodError - undefined method `+' for nil:NilClass:
  app/controllers/lti_registration_wips_controller.rb:102:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:55:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:91:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/bb9e979e9eeb9647/variables" for 127.0.0.1 at 2015-07-29 17:55:03 -0700


Started POST "/__better_errors/bb9e979e9eeb9647/eval" for 127.0.0.1 at 2015-07-29 17:55:25 -0700


Started POST "/__better_errors/bb9e979e9eeb9647/eval" for 127.0.0.1 at 2015-07-29 17:55:32 -0700


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 17:56:44 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c270b7e0-1883-0133-b515-406c8f40a599", "reg_key"=>"c270b480-1883-0133-b515-406c8f40a599", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"ba7161515a303e1b4257ade844d57fd1"}
  [1m[36mLti2Tp::Tool Load (4.0ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-30 00:56:58', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c270b480-1883-0133-b515-406c8f40a599', '721725ef5846e4d32ba09753d214eed7', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c270b7e0-1883-0133-b515-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c270b7e0-1883-0133-b515-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'ba7161515a303e1b4257ade844d57fd1', '2015-07-30 00:56:58', '2')[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:5000/lti_registration_wips?registration_id=34&return_url=/lti2_tp/registrations
Completed 302 Found in 13389ms (ActiveRecord: 7.2ms)


Started GET "/lti_registration_wips?registration_id=34&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 17:56:58 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"34", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 34 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 00:56:58', 'Elan/LuMoS', 34, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0556.58', '2015-07-30 00:56:58')[0m
  [1m[35m (1.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (228.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (236.2ms)
Completed 200 OK in 438ms (Views: 379.3ms | ActiveRecord: 3.3ms)


Started PATCH "/lti_registration_wips/42" for 127.0.0.1 at 2015-07-29 17:57:04 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6jp/dt3bM3m/wKnp/x8r+uqu7NTkeNm7kxbMEjWak7g=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0556.58"}, "commit"=>"Update Lti registration wip", "id"=>"42"}
  [1m[36mLtiRegistrationWip Load (0.9ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 42 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 34 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.4ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0556.58', `updated_at` = '2015-07-30 00:57:04' WHERE `lti2_tp_registrations`.`id` = 34
  [1m[36m (11.3ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 42 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 34 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0556.58' LIMIT 1[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 00:57:04', 'Elan University-0556.58', '2015-07-30 00:57:04')
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd7d3faf0-1883-0133-b516-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"ba7161515a303e1b4257ade844d57fd1\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c270b7e0-1883-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"2b3e8ca4d0d878d4fefdaef51dd9a9e568c14e1816095f877fb1153c3df47b76dfc6005993ca1656ec04e4aa1b775546e0b1946c94575cbf06d933e8fbe2c3c4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 00:57:15' WHERE `lti2_tp_registrations`.`id` = 34[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `updated_at` = '2015-07-30 00:57:39' WHERE `lti2_tp_registrations`.`id` = 34
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 237612ms

NoMethodError - undefined method `+' for nil:NilClass:
  app/controllers/lti_registration_wips_controller.rb:102:in `change_secret'
  app/controllers/lti_registration_wips_controller.rb:55:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:91:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/e10b74960e5b0db8/variables" for 127.0.0.1 at 2015-07-29 18:01:01 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:01:41 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "reg_key"=>"62ce4eb0-1884-0133-b515-406c8f40a599", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"6f05b36b5b3073cfb8110c0ad6e61816"}
  [1m[35mLti2Tp::Tool Load (1.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-30 01:01:43', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '62ce4eb0-1884-0133-b515-406c8f40a599', 'ac1d108b2c7e960ff6993a7a98e65b06', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/f035b7e0-1882-0133-b515-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"62ce50c0-1884-0133-b515-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '6f05b36b5b3073cfb8110c0ad6e61816', '2015-07-30 01:01:43', '2')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations
Completed 302 Found in 542ms (ActiveRecord: 20.7ms)


Started GET "/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:01:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"35", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:01:44', 'Elan/LuMoS', 35, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0601.44', '2015-07-30 01:01:44')
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (4036.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (4070.9ms)
Completed 200 OK in 5629ms (Views: 5184.2ms | ActiveRecord: 21.2ms)


Started PATCH "/lti_registration_wips/43" for 127.0.0.1 at 2015-07-29 18:01:52 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6jp/dt3bM3m/wKnp/x8r+uqu7NTkeNm7kxbMEjWak7g=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0601.44"}, "commit"=>"Update Lti registration wip", "id"=>"43"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 43 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0601.44', `updated_at` = '2015-07-30 01:01:52' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 43 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0601.44' LIMIT 1
  [1m[36mSQL (14.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:01:52', 'Elan University-0601.44', '2015-07-30 01:01:52')[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '7d270370-1884-0133-b517-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"ed4a71da60bce2e307d5db26fefb9c4ca67e45f87adda33d8dd7d64bdd09d4ac2c372bf128c85e1c9580dfbf1d3800b1dc108ea6a83e76ed7ce80450451094d7\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:01:52' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"tc_half_shared_secret\":\"27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf994\"}', `updated_at` = '2015-07-30 01:01:57' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (2.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0601.44' AND `tenants`.`id` != 34) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf994ed4a71da60bce2e307d5db26fefb9c4ca67e45f87adda33d8dd7d64bdd09d4ac2c372bf128c85e1c9580dfbf1d3800b1dc108ea6a83e76ed7ce80450451094d7', `tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816', `updated_at` = '2015-07-30 01:02:18' WHERE `tenants`.`id` = 34[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf994ed4a71da60bce2e307d5db26fefb9c4ca67e45f87adda33d8dd7d64bdd09d4ac2c372bf128c85e1c9580dfbf1d3800b1dc108ea6a83e76ed7ce80450451094d7', `tenant_id` = 34, `updated_at` = '2015-07-30 01:02:18' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=6f05b36b5b3073cfb8110c0ad6e61816&&id=35
Completed 302 Found in 25723ms (ActiveRecord: 42.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=6f05b36b5b3073cfb8110c0ad6e61816&&id=35" for 127.0.0.1 at 2015-07-29 18:02:18 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"6f05b36b5b3073cfb8110c0ad6e61816", "id"=>"35"}
  [1m[35mLti2Tp::Registration Load (1.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=6f05b36b5b3073cfb8110c0ad6e61816
Completed 302 Found in 25ms (ActiveRecord: 1.7ms)


Started POST "/echoes" for 127.0.0.1 at 2015-07-29 18:03:06 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"229", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"823478455637", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438218186", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"uOoN6BetpLStCzd/gA7T2fFoVjw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (2.9ms)
Completed 200 OK in 6478ms (Views: 7.5ms | ActiveRecord: 1.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 18:03:27 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"6264181226146", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438218206", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"CFL1IBI+XmonNaOoIvGvMEMUiCw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_key` = '6f05b36b5b3073cfb8110c0ad6e61816', `reg_password` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf994ed4a71da60bce2e307d5db26fefb9c4ca67e45f87adda33d8dd7d64bdd09d4ac2c372bf128c85e1c9580dfbf1d3800b1dc108ea6a83e76ed7ce80450451094d7', `status` = 'received', `updated_at` = '2015-07-30 01:03:27' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations
Completed 302 Found in 389ms (ActiveRecord: 6.8ms)


Started GET "/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:03:27 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"35", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:03:27', 'Elan/LuMoS', 35, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0601.44', '2015-07-30 01:03:27')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (142.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (147.0ms)
Completed 200 OK in 309ms (Views: 260.2ms | ActiveRecord: 2.4ms)


Started PATCH "/lti_registration_wips/44" for 127.0.0.1 at 2015-07-29 18:03:30 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0601.44"}, "commit"=>"Update Lti registration wip", "id"=>"44"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 44 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 44 LIMIT 1[0m  [["id", "44"]]
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1  [["id", 35]]
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b778ed00-1884-0133-b517-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"33ebb724de40b429b9a08c7d99a494721857d4b21c0bb37c40daaf8bbaaeb4ed31462943f29d0932087b9b2c4221da3413b565874f659e3aeef653331837f84e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:03:30' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 01:03:41' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=35
Completed 302 Found in 10962ms (ActiveRecord: 9.9ms)


Started GET "/lti2_tp/registrations?status=success&&id=35" for 127.0.0.1 at 2015-07-29 18:03:41 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"35"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 20ms (ActiveRecord: 0.6ms)


Started PUT "/lti2_tp/tool_proxies/6f05b36b5b3073cfb8110c0ad6e61816?correlation=b778ed00-1884-0133-b517-406c8f40a599" for 127.0.0.1 at 2015-07-29 18:03:50 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"b778ed00-1884-0133-b517-406c8f40a599", "id"=>"6f05b36b5b3073cfb8110c0ad6e61816"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"5492982741894", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438218230", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"VYm4mUMJyWkjP7tMaBUBaYOM3U4="}
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"5492982741894", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438218230", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"VYm4mUMJyWkjP7tMaBUBaYOM3U4="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0601.44' AND `tenants`.`id` != 34) LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 01:03:50' WHERE `tenants`.`id` = 34
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"33ebb724de40b429b9a08c7d99a494721857d4b21c0bb37c40daaf8bbaaeb4ed31462943f29d0932087b9b2c4221da3413b565874f659e3aeef653331837f84e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:03:50' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (0.9ms)[0m  COMMIT
"reregistration complete for 6f05b36b5b3073cfb8110c0ad6e61816"
  Rendered text template (0.2ms)
Completed 200 OK in 166ms (Views: 6.6ms | ActiveRecord: 9.7ms)


Started POST "/echoes" for 127.0.0.1 at 2015-07-29 18:03:58 -0700
Processing by EchoesController#create as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "lti_message_type"=>"basic-lti-launch-request", "resource_link_id"=>"229", "user_id"=>"2", "roles"=>"Instructor", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2", "launch_presentation_document_target"=>"window", "context_id"=>"2", "launch_presentation_locale"=>"en_US", "context_label"=>"SMPL101A", "context_title"=>"Nursing Compendium", "lis_course_section_sourcedid"=>"2", "tool_consumer_info_product_family_code"=>"LuMoS", "tool_consumer_info_version"=>"3.1", "custom_referrer"=>"Narcissus", "custom_pi"=>"3.14159", "custom_user_primary_email"=>"admin@lumos.org", "custom_discipline"=>"SMPL101A", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"4961504658671", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438218238", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"clSOU0yzPWj9syst5N5vXf4Ehz0="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: 
Verify_signature--send_signature: clSOU0yzPWj9syst5N5vXf4Ehz0=  test_signature: bZ70UUNkGaJQ43/+qv1Pu76g1DE=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Fechoes&context_id%3D2%26context_label%3DSMPL101A%26context_title%3DNursing%2520Compendium%26custom_discipline%3DSMPL101A%26custom_pi%3D3.14159%26custom_referrer%3DNarcissus%26custom_user_primary_email%3Dadmin%2540lumos.org%26launch_presentation_document_target%3Dwindow%26launch_presentation_locale%3Den_US%26launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Fcourse_page%253Fmethod%253Dshow%2526course_id%253D2%26lis_course_section_sourcedid%3D2%26lti_message_type%3Dbasic-lti-launch-request%26lti_version%3DLTI-2p0%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D6f05b36b5b3073cfb8110c0ad6e61816%26oauth_nonce%3D4961504658671%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438218238%26oauth_version%3D1.0%26resource_link_id%3D229%26roles%3DInstructor%26tool_consumer_info_product_family_code%3DLuMoS%26tool_consumer_info_version%3D3.1%26user_id%3D2
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/course_page?method=show&course_id=2?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Filter chain halted as :pre_process_tenant rendered or redirected
Completed 302 Found in 101ms (ActiveRecord: 1.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 18:32:06 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"3981383696127", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438219926", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"6ynFTypYGTY5zB1U2ZDdufZGPig="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = '85c1d7064d0f6ada596240e2ae0ccf0882652957b506564c6a12b144dcd6ec7efcb84d71088f1125354a8cc5bdba684d192fba3002ed12f33a7cbf0b1e7952ba33ebb724de40b429b9a08c7d99a494721857d4b21c0bb37c40daaf8bbaaeb4ed31462943f29d0932087b9b2c4221da3413b565874f659e3aeef653331837f84e', `status` = 'received', `updated_at` = '2015-07-30 01:32:09' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations
Completed 302 Found in 3291ms (ActiveRecord: 7.6ms)


Started GET "/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:32:09 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"35", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:32:09', 'Elan/LuMoS', 35, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0601.44', '2015-07-30 01:32:09')[0m
  [1m[35m (1.4ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (232.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (237.9ms)
Completed 200 OK in 388ms (Views: 342.3ms | ActiveRecord: 3.6ms)


Started PATCH "/lti_registration_wips/45" for 127.0.0.1 at 2015-07-29 18:32:15 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0601.44"}, "commit"=>"Update Lti registration wip", "id"=>"45"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 45 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 45 LIMIT 1[0m  [["id", "45"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1  [["id", 35]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'c2867560-1888-0133-b517-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"be28388ec13890cd764366094f69bea6affd06e0d3cb269f79b53f3d1fdd0917c2891d6726b9a11d1284a3e59c06707387d25ab7cf57e702638bbe3b405b9134\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:32:27' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (3.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf99433ebb724de40b429b9a08c7d99a494721857d4b21c0bb37c40daaf8bbaaeb4ed31462943f29d0932087b9b2c4221da3413b565874f659e3aeef653331837f84e', `status` = 'reregistered', `updated_at` = '2015-07-30 01:32:53' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=35
Completed 302 Found in 44547ms (ActiveRecord: 13.6ms)


Started GET "/lti2_tp/registrations?status=success&&id=35" for 127.0.0.1 at 2015-07-29 18:32:59 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"35"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/6f05b36b5b3073cfb8110c0ad6e61816?correlation=c2867560-1888-0133-b517-406c8f40a599" for 127.0.0.1 at 2015-07-29 18:33:52 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"c2867560-1888-0133-b517-406c8f40a599", "id"=>"6f05b36b5b3073cfb8110c0ad6e61816"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"2220940345611", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438220032", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"KGF6+YJmsJYSTvvjIosvLVZeDN8="}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"2220940345611", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438220032", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"KGF6+YJmsJYSTvvjIosvLVZeDN8="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0601.44' AND `tenants`.`id` != 34) LIMIT 1[0m
  [1m[35mSQL (2.9ms)[0m  UPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 01:36:12' WHERE `tenants`.`id` = 34
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"be28388ec13890cd764366094f69bea6affd06e0d3cb269f79b53f3d1fdd0917c2891d6726b9a11d1284a3e59c06707387d25ab7cf57e702638bbe3b405b9134\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:36:13' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.3ms)[0m  COMMIT
"reregistration complete for 6f05b36b5b3073cfb8110c0ad6e61816"
  Rendered text template (0.3ms)
Completed 200 OK in 148829ms (Views: 3.8ms | ActiveRecord: 13.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 18:37:04 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"2837637058936", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438220224", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"SkURsxERg3hSH2fHqMc83qhvvoY="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: 85c1d7064d0f6ada596240e2ae0ccf0882652957b506564c6a12b144dcd6ec7efcb84d71088f1125354a8cc5bdba684d192fba3002ed12f33a7cbf0b1e7952ba33ebb724de40b429b9a08c7d99a494721857d4b21c0bb37c40daaf8bbaaeb4ed31462943f29d0932087b9b2c4221da3413b565874f659e3aeef653331837f84e
Verify_signature--send_signature: SkURsxERg3hSH2fHqMc83qhvvoY=  test_signature: YtoN6DwYRWjsE8qiG9kMYeuL4HQ=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D6f05b36b5b3073cfb8110c0ad6e61816%26oauth_nonce%3D2837637058936%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438220224%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F62ce50c0-1884-0133-b515-406c8f40a599
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 95ms (ActiveRecord: 2.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 18:38:34 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"983021328729", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438220314", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"3gop2qZ5LFIdgdyr/7n8K3/CItQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = 'fb816d8e9f922a1e122c7e5b0b2f2ceaa1ce20a00235fc33c4ffba83afdb9396a858d78a0e5529504a70e3c3048f74586a3d1f667b028492942d82e39d2444e4be28388ec13890cd764366094f69bea6affd06e0d3cb269f79b53f3d1fdd0917c2891d6726b9a11d1284a3e59c06707387d25ab7cf57e702638bbe3b405b9134', `status` = 'received', `updated_at` = '2015-07-30 01:38:38' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.8ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations
Completed 302 Found in 3709ms (ActiveRecord: 8.7ms)


Started GET "/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:38:38 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"35", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:38:38', 'Elan/LuMoS', 35, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0601.44', '2015-07-30 01:38:38')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (222.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (229.2ms)
Completed 200 OK in 423ms (Views: 354.4ms | ActiveRecord: 3.4ms)


Started PATCH "/lti_registration_wips/46" for 127.0.0.1 at 2015-07-29 18:38:44 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0601.44"}, "commit"=>"Update Lti registration wip", "id"=>"46"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 46 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 46 LIMIT 1[0m  [["id", "46"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1  [["id", 35]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'a78e69f0-1889-0133-b517-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"74677775a15b54432da460432261212a7982d9b81e1ccca8a392434f958a56a7d0469ea7bed5d02cfc5c482c7fd201592b0d9607389dce11b8aff2cd9f0c026d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:38:51' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.1ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf994be28388ec13890cd764366094f69bea6affd06e0d3cb269f79b53f3d1fdd0917c2891d6726b9a11d1284a3e59c06707387d25ab7cf57e702638bbe3b405b9134', `status` = 'reregistered', `updated_at` = '2015-07-30 01:38:51' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=35
Completed 302 Found in 6956ms (ActiveRecord: 12.6ms)


Started GET "/lti2_tp/registrations?status=success&&id=35" for 127.0.0.1 at 2015-07-29 18:38:51 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"35"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 16ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/6f05b36b5b3073cfb8110c0ad6e61816?correlation=a78e69f0-1889-0133-b517-406c8f40a599" for 127.0.0.1 at 2015-07-29 18:39:29 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"a78e69f0-1889-0133-b517-406c8f40a599", "id"=>"6f05b36b5b3073cfb8110c0ad6e61816"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"341234835704", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438220369", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"PpUJjanDeGzJVERU6w6+Y3ZthYo="}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"6f05b36b5b3073cfb8110c0ad6e61816", :oauth_nonce=>"341234835704", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438220369", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"PpUJjanDeGzJVERU6w6+Y3ZthYo="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0601.44' AND `tenants`.`id` != 34) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 01:39:58' WHERE `tenants`.`id` = 34
  [1m[36m (3.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"74677775a15b54432da460432261212a7982d9b81e1ccca8a392434f958a56a7d0469ea7bed5d02cfc5c482c7fd201592b0d9607389dce11b8aff2cd9f0c026d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:39:58' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (1.0ms)[0m  COMMIT
"reregistration complete for 6f05b36b5b3073cfb8110c0ad6e61816"
  Rendered text template (0.3ms)
Completed 200 OK in 28582ms (Views: 4.0ms | ActiveRecord: 10.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 18:40:51 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"6f05b36b5b3073cfb8110c0ad6e61816", "oauth_nonce"=>"4844698403851", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438220451", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"aV0bndrYt2MjYKkdFpLkI3SAZBA="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '6f05b36b5b3073cfb8110c0ad6e61816'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 34  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 34 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = '52b0c402bf803222e3e10925d9e65c48699af3bf7c0fef34650c2e8c2f3cf5447d77a6d3c12a90f993f034125de1b0f92627aa73a344f941d35d2581e065509c74677775a15b54432da460432261212a7982d9b81e1ccca8a392434f958a56a7d0469ea7bed5d02cfc5c482c7fd201592b0d9607389dce11b8aff2cd9f0c026d', `status` = 'received', `updated_at` = '2015-07-30 01:40:54' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations
Completed 302 Found in 3371ms (ActiveRecord: 9.5ms)


Started GET "/lti_registration_wips?registration_id=35&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:40:54 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"35", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:40:54', 'Elan/LuMoS', 35, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0601.44', '2015-07-30 01:40:54')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (161.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (167.1ms)
Completed 200 OK in 402ms (Views: 350.1ms | ActiveRecord: 4.9ms)


Started PATCH "/lti_registration_wips/47" for 127.0.0.1 at 2015-07-29 18:40:58 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0601.44"}, "commit"=>"Update Lti registration wip", "id"=>"47"}
  [1m[35mLtiRegistrationWip Load (1.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 47 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 47 LIMIT 1  [["id", "47"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m  [["id", 35]]
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0601.44'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f61a4710-1889-0133-b517-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"6f05b36b5b3073cfb8110c0ad6e61816\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/62ce50c0-1884-0133-b515-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"bcf4ae347d3152220531e9f349e656112fafd38f30bd9b0558211a5ed966085b2be92bb0da27ff3ae2e4634d463115da709b5d3c577d12e36774820da23ed937\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:41:03' WHERE `lti2_tp_registrations`.`id` = 35
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '27b945c1a21d5bc2cb98c7efa5e3389dcd783152ea77eb6cb12a4b38e75f5dfa3a66fde07b302204a2d4a38f07d4543e901d25a3c57363e748d07c6a8fecf99474677775a15b54432da460432261212a7982d9b81e1ccca8a392434f958a56a7d0469ea7bed5d02cfc5c482c7fd201592b0d9607389dce11b8aff2cd9f0c026d', `status` = 'reregistered', `updated_at` = '2015-07-30 01:42:18' WHERE `lti2_tp_registrations`.`id` = 35[0m
  [1m[35m (2.9ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=35
Completed 302 Found in 101170ms (ActiveRecord: 13.8ms)


Started GET "/lti2_tp/registrations?status=success&&id=35" for 127.0.0.1 at 2015-07-29 18:42:39 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "id"=>"35"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 35 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success
Completed 302 Found in 20ms (ActiveRecord: 0.8ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:50:38 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4a06cb60-188b-0133-b518-406c8f40a599", "reg_key"=>"4a05e6a0-188b-0133-b518-406c8f40a599", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"4946d531ab0d0c828e7dbff495d9e644"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-07-30 01:50:39', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '4a05e6a0-188b-0133-b518-406c8f40a599', 'ca7605f2096f64ef80c6ac84b5eb96ec', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4a06cb60-188b-0133-b518-406c8f40a599', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4a06cb60-188b-0133-b518-406c8f40a599#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/4a06cb60-188b-0133-b518-406c8f40a599\",\"lti_version\":\"LTI-2p0\",\"guid\":\"4a06cb60-188b-0133-b518-406c8f40a599\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '4946d531ab0d0c828e7dbff495d9e644', '2015-07-30 01:50:39', '2')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti_registration_wips?registration_id=36&return_url=/lti2_tp/registrations
Completed 302 Found in 452ms (ActiveRecord: 12.8ms)


Started GET "/lti_registration_wips?registration_id=36&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 18:50:39 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"36", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 36 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:50:39', 'Elan/LuMoS', 36, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0650.39', '2015-07-30 01:50:39')
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2520.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2542.4ms)
Completed 200 OK in 3575ms (Views: 3394.6ms | ActiveRecord: 11.9ms)


Started PATCH "/lti_registration_wips/48" for 127.0.0.1 at 2015-07-29 18:50:46 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6jp/dt3bM3m/wKnp/x8r+uqu7NTkeNm7kxbMEjWak7g=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0650.39"}, "commit"=>"Update Lti registration wip", "id"=>"48"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 48 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 36 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0650.39', `updated_at` = '2015-07-30 01:50:46' WHERE `lti2_tp_registrations`.`id` = 36[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 48 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 36 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0650.39' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 01:50:46', 'Elan University-0650.39', '2015-07-30 01:50:46')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '51bff650-188b-0133-b519-406c8f40a599', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4946d531ab0d0c828e7dbff495d9e644\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4a06cb60-188b-0133-b518-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"2524425ff21656945002b5699828bbf07e1f606184ed918805266cbe679eef1bc0037b4342bbf0eb2b3dd387c9ca1e397d8654a024653645aec72ca6c0ebb315\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 01:50:46' WHERE `lti2_tp_registrations`.`id` = 36
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"4946d531ab0d0c828e7dbff495d9e644\",\"tc_half_shared_secret\":\"8b38e67b31542ddb69087d52b12f322e511f624c388f8502a32e250b277ab29ece5c2f7e286f03a820889dba4e094837747ca606fde9f52c3a8ee185c4ed0feb\"}', `updated_at` = '2015-07-30 01:50:46' WHERE `lti2_tp_registrations`.`id` = 36[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.1ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0650.39' AND `tenants`.`id` != 35) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = '8b38e67b31542ddb69087d52b12f322e511f624c388f8502a32e250b277ab29ece5c2f7e286f03a820889dba4e094837747ca606fde9f52c3a8ee185c4ed0feb2524425ff21656945002b5699828bbf07e1f606184ed918805266cbe679eef1bc0037b4342bbf0eb2b3dd387c9ca1e397d8654a024653645aec72ca6c0ebb315', `tenant_key` = '4946d531ab0d0c828e7dbff495d9e644', `updated_at` = '2015-07-30 01:50:51' WHERE `tenants`.`id` = 35[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '8b38e67b31542ddb69087d52b12f322e511f624c388f8502a32e250b277ab29ece5c2f7e286f03a820889dba4e094837747ca606fde9f52c3a8ee185c4ed0feb2524425ff21656945002b5699828bbf07e1f606184ed918805266cbe679eef1bc0037b4342bbf0eb2b3dd387c9ca1e397d8654a024653645aec72ca6c0ebb315', `tenant_id` = 35, `updated_at` = '2015-07-30 01:50:51' WHERE `lti2_tp_registrations`.`id` = 36
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:5000/lti2_tp/registrations?status=success&tool_guid=4946d531ab0d0c828e7dbff495d9e644&&id=36
Completed 302 Found in 5444ms (ActiveRecord: 23.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=4946d531ab0d0c828e7dbff495d9e644&&id=36" for 127.0.0.1 at 2015-07-29 18:50:51 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"4946d531ab0d0c828e7dbff495d9e644", "id"=>"36"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 36 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=4946d531ab0d0c828e7dbff495d9e644
Completed 302 Found in 30ms (ActiveRecord: 1.0ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started PUT "/lti2_tp/tool_proxies/8a6d2ea10aa74d788b84a9eb0d407c0f?correlation=7f5d5730-188c-0133-b51b-406c8f40a599" for 127.0.0.1 at 2015-07-29 19:00:10 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"7f5d5730-188c-0133-b51b-406c8f40a599", "id"=>"8a6d2ea10aa74d788b84a9eb0d407c0f"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"7820896386679", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438221610", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"X8tTOxo8d2+OEe4sVtGSgE73Y4s="}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"7820896386679", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438221610", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"X8tTOxo8d2+OEe4sVtGSgE73Y4s="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0653.33' AND `tenants`.`id` != 36) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 02:02:33' WHERE `tenants`.`id` = 36[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"32f5208efb046e637f6846668bbad9aa6747e14ea56dc2835c5ede734d82917f5250a8f7d1eb38fbe99d198c1704c76397a3e709fdaf8da44080d87218c7095d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:02:33' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
"reregistration complete for 8a6d2ea10aa74d788b84a9eb0d407c0f"
  Rendered text template (0.4ms)
Completed 200 OK in 142162ms (Views: 15.2ms | ActiveRecord: 23.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:03:00 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"91640678497", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438221780", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"StNEOaMCui9jCBlZ/RB0BHAlbw4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = '9184348c43dcb6133bf15300733e2586a9e7a1d614772f97dec52e2f1bd0794a6e0e225eae88945c97ddbf704385fbf1109ae478af855dd692b236970386748e32f5208efb046e637f6846668bbad9aa6747e14ea56dc2835c5ede734d82917f5250a8f7d1eb38fbe99d198c1704c76397a3e709fdaf8da44080d87218c7095d', `status` = 'received', `updated_at` = '2015-07-30 02:03:05' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.5ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 5225ms (ActiveRecord: 15.0ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:03:05 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:03:13', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:03:13')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2382.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2403.5ms)
Completed 200 OK in 11082ms (Views: 3603.5ms | ActiveRecord: 7.5ms)


Started PATCH "/lti_registration_wips/52" for 127.0.0.1 at 2015-07-29 19:03:24 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"52"}
  [1m[36mLtiRegistrationWip Load (1.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 52 LIMIT 1[0m
  [1m[35m (4.1ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35m (3.4ms)[0m  COMMIT
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 52 LIMIT 1[0m  [["id", "52"]]
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1  [["id", 37]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '212a4ce0-188d-0133-b51c-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8515ca9346fb290171275e35f5a6b08a9f2b06f5506c9be6e80146ed81f097e177955ddef20917d5f0671de3059c970daa62f5f0f3bf4b2f95ef560a2d1f0d2a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:03:43' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (8.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'dfe6b26015480ffe6fb5a70e5ef9c522ee3b1a781a65e72b0d3d7e25e4254765b5753d45308bef96c857ae61d81260fe3447a08db8030b92c5a766f3ed3c24f232f5208efb046e637f6846668bbad9aa6747e14ea56dc2835c5ede734d82917f5250a8f7d1eb38fbe99d198c1704c76397a3e709fdaf8da44080d87218c7095d', `status` = 'reregistered', `updated_at` = '2015-07-30 02:05:01' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 96703ms (ActiveRecord: 30.0ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-07-29 19:05:01 -0700
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started PUT "/lti2_tp/tool_proxies/8a6d2ea10aa74d788b84a9eb0d407c0f?correlation=212a4ce0-188d-0133-b51c-406c8f40a599" for 127.0.0.1 at 2015-07-29 19:07:59 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"212a4ce0-188d-0133-b51c-406c8f40a599", "id"=>"8a6d2ea10aa74d788b84a9eb0d407c0f"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"8592097334927", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438222079", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"RSCYkaAgeAj1w7QfGS4MltSwTxo="}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"8592097334927", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438222079", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"RSCYkaAgeAj1w7QfGS4MltSwTxo="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0653.33' AND `tenants`.`id` != 36) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 02:08:05' WHERE `tenants`.`id` = 36[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"8515ca9346fb290171275e35f5a6b08a9f2b06f5506c9be6e80146ed81f097e177955ddef20917d5f0671de3059c970daa62f5f0f3bf4b2f95ef560a2d1f0d2a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:08:05' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
"reregistration complete for 8a6d2ea10aa74d788b84a9eb0d407c0f"
  Rendered text template (0.4ms)
Completed 200 OK in 5737ms (Views: 18.9ms | ActiveRecord: 38.7ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:11:15 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"18943180121", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222275", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"IO+eFZsCm4DmKKFhA7cU2SEgU7A="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (4.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 
Verify_signature--send_signature: IO+eFZsCm4DmKKFhA7cU2SEgU7A=  test_signature: RvqEAkWOq0frNRUmJJYvSlIdNjM=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D8a6d2ea10aa74d788b84a9eb0d407c0f%26oauth_nonce%3D18943180121%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438222275%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fb2bc4310-188b-0133-b51a-406c8f40a599
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 948ms (ActiveRecord: 42.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:11:37 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"5486698022648", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222297", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"/vRm/a8ViEwKnrabrEU/0zp3KtU="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = '1ee900c66021afe9b15fedc9d1dc90f8341b250ce33c2a180337f8313fb42711a415d8d8c4f65d173b0a606765679fa15333bbc0da7801b9abde19f1cf584da05f66c7d6bdd4e66cd3bf6c22397a6bb745356c6e0cc1f9570e34fea7e3084c7aa83a9808bb1f921e97de7db8132e98fdf15ca84c9b3f8c3b240bcda54cc1a912', `status` = 'received', `updated_at` = '2015-07-30 02:11:45' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 7734ms (ActiveRecord: 11.5ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:11:45 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:11:58', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:11:58')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2406.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2428.2ms)
Completed 200 OK in 16743ms (Views: 3978.7ms | ActiveRecord: 9.0ms)


Started PATCH "/lti_registration_wips/54" for 127.0.0.1 at 2015-07-29 19:12:06 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"54"}
  [1m[35mLtiRegistrationWip Load (1.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 54 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 54 LIMIT 1  [["id", "54"]]
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '53f349e0-188e-0133-b51e-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"83885c7d48522333b5883c9cf7e2bf60d34cc6d04bd7bf2b31c1db83665aafd0691a39c6ee230d41007d54397cd578033b37635200d9f3d72d933fd01f87f262\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:12:18' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (1.8ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 02:12:58' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (3.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&&id=37
Completed 302 Found in 52576ms (ActiveRecord: 15.8ms)


Started GET "/lti2_tp/registrations?status=success&&id=37" for 127.0.0.1 at 2015-07-29 19:12:58 -0700
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:13:33 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"5486698022648", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222297", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"/vRm/a8ViEwKnrabrEU/0zp3KtU="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-07-30 02:13:35' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 666ms (ActiveRecord: 20.2ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:13:35 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:13:35', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:13:35')[0m
  [1m[35m (2.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2459.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2480.5ms)
Completed 200 OK in 3677ms (Views: 3426.3ms | ActiveRecord: 11.1ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:13:47 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"5011905806251", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222427", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"i8C8rR/5lN7EXn0aQpsXH/QIuZ0="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 295ms (ActiveRecord: 5.7ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:13:48 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:13:48', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:13:48')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (175.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (180.9ms)
Completed 200 OK in 381ms (Views: 326.0ms | ActiveRecord: 3.4ms)


Started PATCH "/lti_registration_wips/56" for 127.0.0.1 at 2015-07-29 19:13:50 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"56"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 56 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 56 LIMIT 1  [["id", "56"]]
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '8b2da000-188e-0133-b51f-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5f1777105ca7ee0e0552760ac9ea4fe3ba42d4e2be8b9e700158abd306de9e1647a429af46cf21ad5c5ed55aee22a548d62a761d8f4e5c3d829b5f1fdc6a96d4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:13:51' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"5f1777105ca7ee0e0552760ac9ea4fe3ba42d4e2be8b9e700158abd306de9e1647a429af46cf21ad5c5ed55aee22a548d62a761d8f4e5c3d829b5f1fdc6a96d4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"tc_half_shared_secret\":\"2cc12ea839fddef190a7db3537fcde8895d647755bad7ee9ef833c344ce05a3b06de5e480c10d9d3b183fc64b50d4062ca3a4a8a1a03c5dd1491aa44535a25df\"}', `updated_at` = '2015-07-30 02:14:02' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (3.2ms)[0m  COMMIT
  [1m[36m (1.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '2cc12ea839fddef190a7db3537fcde8895d647755bad7ee9ef833c344ce05a3b06de5e480c10d9d3b183fc64b50d4062ca3a4a8a1a03c5dd1491aa44535a25df5f1777105ca7ee0e0552760ac9ea4fe3ba42d4e2be8b9e700158abd306de9e1647a429af46cf21ad5c5ed55aee22a548d62a761d8f4e5c3d829b5f1fdc6a96d4', `status` = 'reregistered', `updated_at` = '2015-07-30 02:14:09' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (6.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37
Completed 302 Found in 18666ms (ActiveRecord: 23.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37" for 127.0.0.1 at 2015-07-29 19:14:09 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "id"=>"37"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f
Completed 302 Found in 38ms (ActiveRecord: 1.0ms)


Started PUT "/lti2_tp/tool_proxies/8a6d2ea10aa74d788b84a9eb0d407c0f?correlation=8b2da000-188e-0133-b51f-406c8f40a599" for 127.0.0.1 at 2015-07-29 19:14:15 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"8b2da000-188e-0133-b51f-406c8f40a599", "id"=>"8a6d2ea10aa74d788b84a9eb0d407c0f"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"488912166244", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438222455", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"s8ug8cIkr9zprPDVi/+k2nW55/M="}
  [1m[36mTenant Load (1.0ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"488912166244", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438222455", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"s8ug8cIkr9zprPDVi/+k2nW55/M="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (1.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0653.33' AND `tenants`.`id` != 36) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 02:16:25' WHERE `tenants`.`id` = 36
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `updated_at` = '2015-07-30 02:16:25' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.2ms)[0m  COMMIT
"reregistration complete for 8a6d2ea10aa74d788b84a9eb0d407c0f"
  Rendered text template (0.5ms)
Completed 200 OK in 130099ms (Views: 7.0ms | ActiveRecord: 11.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:18:02 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"9785657728727", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222681", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"+uHZ100U1+xajtBSZH+rrj0WZ7s="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Secret: 1ee900c66021afe9b15fedc9d1dc90f8341b250ce33c2a180337f8313fb42711a415d8d8c4f65d173b0a606765679fa15333bbc0da7801b9abde19f1cf584da05f66c7d6bdd4e66cd3bf6c22397a6bb745356c6e0cc1f9570e34fea7e3084c7aa83a9808bb1f921e97de7db8132e98fdf15ca84c9b3f8c3b240bcda54cc1a912
Verify_signature--send_signature: +uHZ100U1+xajtBSZH+rrj0WZ7s=  test_signature: L5Po9YxAfpe7yM/gOW3ROf43kII=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D8a6d2ea10aa74d788b84a9eb0d407c0f%26oauth_nonce%3D9785657728727%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438222681%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fb2bc4310-188b-0133-b51a-406c8f40a599
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 190ms (ActiveRecord: 3.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:18:42 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"6696148953428", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222722", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"rCnxYu6UCftUHWkxGIdRjcomzvM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = '2cc12ea839fddef190a7db3537fcde8895d647755bad7ee9ef833c344ce05a3b06de5e480c10d9d3b183fc64b50d4062ca3a4a8a1a03c5dd1491aa44535a25df5f1777105ca7ee0e0552760ac9ea4fe3ba42d4e2be8b9e700158abd306de9e1647a429af46cf21ad5c5ed55aee22a548d62a761d8f4e5c3d829b5f1fdc6a96d4', `status` = 'received', `updated_at` = '2015-07-30 02:18:42' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.8ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 286ms (ActiveRecord: 8.2ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:18:42 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:18:42', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:18:42')[0m
  [1m[35m (2.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (160.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (166.4ms)
Completed 200 OK in 392ms (Views: 312.5ms | ActiveRecord: 5.1ms)


Started PATCH "/lti_registration_wips/57" for 127.0.0.1 at 2015-07-29 19:18:45 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"57"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 57 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 57 LIMIT 1[0m  [["id", "57"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1  [["id", 37]]
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '9d102d80-188f-0133-b51f-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"66c18ebee3c266285b4864fc2e2897555d3cc856842c939408f60bb720595fa9fb98b15abaf2ca4b853e47e2f2f2bc2e8c1e9faa46e69fa0468e038a39cf4e79\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:21:30' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.7ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"66c18ebee3c266285b4864fc2e2897555d3cc856842c939408f60bb720595fa9fb98b15abaf2ca4b853e47e2f2f2bc2e8c1e9faa46e69fa0468e038a39cf4e79\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"tc_half_shared_secret\":\"cf736ccf4064d5e4de5ed6bcfee6544dd3feb712f19a75707217c753bdca4eb67983ae0da69122aecd7d0706de98ec82354d28c0cc9fbc8645cc8f1a9ec42aee\"}', `updated_at` = '2015-07-30 02:21:30' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'cf736ccf4064d5e4de5ed6bcfee6544dd3feb712f19a75707217c753bdca4eb67983ae0da69122aecd7d0706de98ec82354d28c0cc9fbc8645cc8f1a9ec42aee66c18ebee3c266285b4864fc2e2897555d3cc856842c939408f60bb720595fa9fb98b15abaf2ca4b853e47e2f2f2bc2e8c1e9faa46e69fa0468e038a39cf4e79', `status` = 'reregistered', `updated_at` = '2015-07-30 02:21:30' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37
Completed 302 Found in 165595ms (ActiveRecord: 12.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37" for 127.0.0.1 at 2015-07-29 19:21:30 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:22:10 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"1805556352851", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438222929", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"8VvNrujna9LNy43zaxtCuA9TtvM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-07-30 02:22:11' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (11.4ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 688ms (ActiveRecord: 44.5ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:22:11 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:22:11', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:22:11')[0m
  [1m[35m (2.2ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (2475.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2496.6ms)
Completed 200 OK in 3514ms (Views: 3364.4ms | ActiveRecord: 7.7ms)


Started PATCH "/lti_registration_wips/58" for 127.0.0.1 at 2015-07-29 19:22:18 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"58"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 58 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 58 LIMIT 1[0m  [["id", "58"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1  [["id", 37]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'bc19b150-188f-0133-b521-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"50aba24e25418ff0f8df39f7bc3ce47b38d06591e2c0e19806592fa60a23ec8cc6d563b6c43060fdc6ff080ee471806afbc5905199b04012f356d4218d1fabd1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:22:22' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.6ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"50aba24e25418ff0f8df39f7bc3ce47b38d06591e2c0e19806592fa60a23ec8cc6d563b6c43060fdc6ff080ee471806afbc5905199b04012f356d4218d1fabd1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"tc_half_shared_secret\":\"895570cfb9698c834a84554730e9021b7b82597603fea98932057e93292fe6dabe5f60b2325b55c04c706cf2f8d086c576b0013afc3d35db3cf3c05f950a88d3\"}', `updated_at` = '2015-07-30 02:23:06' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 02:23:18' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (15.3ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37
Completed 302 Found in 60329ms (ActiveRecord: 29.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37" for 127.0.0.1 at 2015-07-29 19:23:18 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "id"=>"37"}
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f
Completed 302 Found in 45ms (ActiveRecord: 1.2ms)


Started PUT "/lti2_tp/tool_proxies/8a6d2ea10aa74d788b84a9eb0d407c0f?correlation=bc19b150-188f-0133-b521-406c8f40a599" for 127.0.0.1 at 2015-07-29 19:23:25 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"bc19b150-188f-0133-b521-406c8f40a599", "id"=>"8a6d2ea10aa74d788b84a9eb0d407c0f"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"3568239383080", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438223005", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"0CsLDD9SMDPls/67zmty77mgio4="}
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"8a6d2ea10aa74d788b84a9eb0d407c0f", :oauth_nonce=>"3568239383080", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1438223005", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"0CsLDD9SMDPls/67zmty77mgio4="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0653.33' AND `tenants`.`id` != 36) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = NULL, `updated_at` = '2015-07-30 02:25:03' WHERE `tenants`.`id` = 36[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `proposed_tool_proxy_json` = NULL, `reg_password` = NULL, `updated_at` = '2015-07-30 02:25:03' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
"reregistration complete for 8a6d2ea10aa74d788b84a9eb0d407c0f"
  Rendered text template (0.2ms)
Completed 200 OK in 97807ms (Views: 7.1ms | ActiveRecord: 7.9ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (1.0ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:25:55 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"6886870631002", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438223155", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"Eh/ThhU2MXErSbg15lEePHLvMa4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 2cc12ea839fddef190a7db3537fcde8895d647755bad7ee9ef833c344ce05a3b06de5e480c10d9d3b183fc64b50d4062ca3a4a8a1a03c5dd1491aa44535a25df5f1777105ca7ee0e0552760ac9ea4fe3ba42d4e2be8b9e700158abd306de9e1647a429af46cf21ad5c5ed55aee22a548d62a761d8f4e5c3d829b5f1fdc6a96d4
Verify_signature--send_signature: Eh/ThhU2MXErSbg15lEePHLvMa4=  test_signature: f5ZaNV81L7IUxRpV6X+gcxwQdus=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D8a6d2ea10aa74d788b84a9eb0d407c0f%26oauth_nonce%3D6886870631002%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438223155%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fb2bc4310-188b-0133-b51a-406c8f40a599
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 362ms (ActiveRecord: 11.4ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-29 19:26:32 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"4676485554102", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438223192", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"dCMsa9WneOtaisq+Tnkn7mDvo0Y="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = '895570cfb9698c834a84554730e9021b7b82597603fea98932057e93292fe6dabe5f60b2325b55c04c706cf2f8d086c576b0013afc3d35db3cf3c05f950a88d350aba24e25418ff0f8df39f7bc3ce47b38d06591e2c0e19806592fa60a23ec8cc6d563b6c43060fdc6ff080ee471806afbc5905199b04012f356d4218d1fabd1', `status` = 'received', `updated_at` = '2015-07-30 02:26:32' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (10.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 384ms (ActiveRecord: 34.8ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-29 19:26:33 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 02:26:33', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 02:26:33')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2454.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2483.0ms)
Completed 200 OK in 3468ms (Views: 3306.4ms | ActiveRecord: 8.0ms)


Started PATCH "/lti_registration_wips/59" for 127.0.0.1 at 2015-07-29 19:26:39 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"59"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 59 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 59 LIMIT 1  [["id", "59"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '570f1740-1890-0133-b522-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"6e12038df578404fa16f399c60eecaece7a4552df084707f78a9f61ba519df8cccb5b36a5eafb92a193b45ab35b20dcd6d2e624acb7826af089a95ec253e19d7\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 02:26:42' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"6e12038df578404fa16f399c60eecaece7a4552df084707f78a9f61ba519df8cccb5b36a5eafb92a193b45ab35b20dcd6d2e624acb7826af089a95ec253e19d7\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"tc_half_shared_secret\":\"bb522f1f593563604281dce6278339c83a0d6da6de3c71c03fedd71f9d91894fffe1f2f3f1848e48ae6373a53121fcbfc9b23f3262e4d9ff359afbb66e23f6fb\"}', `updated_at` = '2015-07-30 02:27:11' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 02:27:11' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37
Completed 302 Found in 32597ms (ActiveRecord: 15.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=8a6d2ea10aa74d788b84a9eb0d407c0f&&id=37" for 127.0.0.1 at 2015-07-29 19:27:11 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-30 05:49:40 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"8640519925096", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438260497", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"us00ohI7zwRpzqEFGMnt+V8BCnk="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: bb522f1f593563604281dce6278339c83a0d6da6de3c71c03fedd71f9d91894fffe1f2f3f1848e48ae6373a53121fcbfc9b23f3262e4d9ff359afbb66e23f6fb6e12038df578404fa16f399c60eecaece7a4552df084707f78a9f61ba519df8cccb5b36a5eafb92a193b45ab35b20dcd6d2e624acb7826af089a95ec253e19d7
Verify_signature--send_signature: us00ohI7zwRpzqEFGMnt+V8BCnk=  test_signature: 4C1mC6TJxvmBUgKOYxYPLLLjHrc=
Verify signature_base_string: POST&http%3A%2F%2Frails.kinexis.com%3A5000%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D8a6d2ea10aa74d788b84a9eb0d407c0f%26oauth_nonce%3D8640519925096%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1438260497%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fb2bc4310-188b-0133-b51a-406c8f40a599
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 487ms (ActiveRecord: 14.4ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-30 05:50:27 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"3895533685681", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438260627", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"Teile0QgoV80h4IE1CZDwueHGWw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-07-30 12:50:27' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (11.0ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 402ms (ActiveRecord: 29.6ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-30 05:50:28 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 12:50:28', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 12:50:28')
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2536.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2557.8ms)
Completed 200 OK in 3661ms (Views: 3471.4ms | ActiveRecord: 9.7ms)


Started PATCH "/lti_registration_wips/64" for 127.0.0.1 at 2015-07-30 05:50:34 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"64"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 64 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.0ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0653.33' AND `tenants`.`id` != 36) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = 'bb522f1f593563604281dce6278339c83a0d6da6de3c71c03fedd71f9d91894fffe1f2f3f1848e48ae6373a53121fcbfc9b23f3262e4d9ff359afbb66e23f6fb6e12038df578404fa16f399c60eecaece7a4552df084707f78a9f61ba519df8cccb5b36a5eafb92a193b45ab35b20dcd6d2e624acb7826af089a95ec253e19d7', `updated_at` = '2015-07-30 12:52:04' WHERE `tenants`.`id` = 36[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 64 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'bba62b80-18e7-0133-b528-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"294c4d7d894e38b1b73e5747cfaf366ee13a5c34713bbf535fa733d1fa36c244b5eefcc0b5f19ae43b5a3af71a4a758943811ad163240cffce7b786394080702\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 12:52:17' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (3.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 12:52:47' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 141507ms

TypeError - no implicit conversion of nil into String:
  app/controllers/lti_registration_wips_controller.rb:72:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:32:in `show'
  app/controllers/lti_registration_wips_controller.rb:95:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/7cf6f9e624198d01/variables" for 127.0.0.1 at 2015-07-30 05:52:56 -0700


Started POST "/__better_errors/7cf6f9e624198d01/eval" for 127.0.0.1 at 2015-07-30 05:53:24 -0700
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-30 06:25:56 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"5027211422604", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438262756", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"DN0R7ZtyDczwSfbTaOSw8wb3irw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 36 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:5000/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations
Completed 302 Found in 637ms (ActiveRecord: 32.4ms)


Started GET "/lti_registration_wips?registration_id=37&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-07-30 06:25:58 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"37", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-07-30 13:25:58', 'Elan/LuMoS', 37, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0653.33', '2015-07-30 13:25:58')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2446.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2468.8ms)
Completed 200 OK in 3508ms (Views: 3356.4ms | ActiveRecord: 7.0ms)


Started PATCH "/lti_registration_wips/75" for 127.0.0.1 at 2015-07-30 06:26:04 -0700
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"NgDtlL2c71JCq/YWa70lE629rSi4UhhP9RLUgAPoRKU=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0653.33"}, "commit"=>"Update Lti registration wip", "id"=>"75"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 75 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 75 LIMIT 1  [["id", "75"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 37 LIMIT 1[0m  [["id", 37]]
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0653.33'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '88ef01e0-18ec-0133-b52b-406c8f40a599', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"8a6d2ea10aa74d788b84a9eb0d407c0f\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:5000\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:5000/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{http://rails.kinexis.com:5000}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"},{\"name\":\"discipline\",\"variable\":\"CourseOffering.label\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\",\"CourseOffering.label\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}},{\"description\":{\"default_value\":\"Interactive resource\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"vbid\"},{\"name\":\"result_uri\",\"variable\":\"Result.uri\"}],\"enabled_capability\":[\"User.id\",\"Context.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Result.autocreate\",\"Result.uri\"],\"path\":\"/iresources\"}],\"resource_name\":{\"default_value\":\"InteractiveResource\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"iresource\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:5000/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:5000/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"65cf2aa7fc4a130d192c50383153b0187c76546ceec73444f654868b00725633a38b9725ecece68c3a361bc8e2dc97b8a951a1455006ca096b71802a8ea760d9\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-07-30 13:26:47' WHERE `lti2_tp_registrations`.`id` = 37
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (1.6ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-07-30 13:28:17' WHERE `lti2_tp_registrations`.`id` = 37[0m
  [1m[35m (1.0ms)[0m  COMMIT
Completed 500 Internal Server Error in 132764ms

TypeError - no implicit conversion of nil into String:
  app/controllers/lti_registration_wips_controller.rb:72:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:32:in `show'
  app/controllers/lti_registration_wips_controller.rb:86:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/4caa63132b6a2287/variables" for 127.0.0.1 at 2015-07-30 06:28:17 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-07-30 06:28:27 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/b2bc4310-188b-0133-b51a-406c8f40a599", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"8a6d2ea10aa74d788b84a9eb0d407c0f", "oauth_nonce"=>"5027211422604", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1438262756", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"DN0R7ZtyDczwSfbTaOSw8wb3irw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (2.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '8a6d2ea10aa74d788b84a9eb0d407c0f'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 36  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Duplicate nonce to one already received
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 409ms (ActiveRecord: 15.5ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:19:51 -0500
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"reg_key"=>"reg_key", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://lti-consumer.paulgray.net/api/profile?toolId=5", "launch_presentation_return_url"=>"http://lti-consumer.paulgray.net/", "lti_message_type"=>"lti-tool-proxy-registration-request"}
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`) VALUES ('2015-08-19 19:19:52', 'http://lti-consumer.paulgray.net/', 'version', 'registration', 'reg_key', 'reg_password', 'received', 'http://lti-consumer.paulgray.net/api/profile?toolId=5', '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",\"@type\":\"ToolConsumerProfile\",\"@id\":null,\"lti_version\":\"version\",\"guid\":\"guid\",\"product_instance\":{\"guid\":\"guid_from_config\",\"product_info\":{\"product_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"product_version\":null,\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"technical_description\":null,\"product_family\":{\"code\":null,\"vendor\":{\"code\":null,\"vendor_name\":{\"default_value\":null,\"key\":\"product.vendor.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"website\":null,\"timestamp\":null,\"contact\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"additionalProperties\":{}}},\"service_owner\":{\"_id\":\"service_owner_id\",\"service_owner_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"timestamp\":null,\"support\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"service_provider\":{\"_id\":null,\"service_provider_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"timestamp\":null,\"support\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"support\":{\"email\":\"support_email\",\"additionalProperties\":{}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"User.image\",\"CourseSection.sourcedId\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"service_offered\":[{\"_type\":\"RestService\",\"_id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://lti-consumer.paulgray.net:80/api/tool_proxy_registration?toolId=5\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"],\"additionalProperties\":{}}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-08-19 19:19:52')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=90&return_url=/lti2_tp/registrations
Completed 302 Found in 490ms (ActiveRecord: 14.6ms)


Started GET "/lti_registration_wips?registration_id=90&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:19:52 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"90", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 90 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:19:53', 90, '/lti2_tp/registrations', 'support_email', '-0219.52', '2015-08-19 19:19:53')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2327.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2347.8ms)
Completed 200 OK in 3312ms (Views: 3166.4ms | ActiveRecord: 8.2ms)


Started PATCH "/lti_registration_wips/140" for 127.0.0.1 at 2015-08-19 14:20:10 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"GxfafjC5JyJXok0tHAYV1b7M8SEoNOosrIUugbPocnI=", "lti_registration_wip"=>{"support_email"=>"support_email", "product_name"=>"", "tenant_name"=>"Mock Consumer"}, "commit"=>"Update Lti registration wip", "id"=>"140"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 140 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Mock Consumer', `updated_at` = '2015-08-19 19:20:10' WHERE `lti_registration_wips`.`id` = 140
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 90 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Mock Consumer', `updated_at` = '2015-08-19 19:20:10' WHERE `lti2_tp_registrations`.`id` = 90
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 140 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 90 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (1.0ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Mock Consumer' LIMIT 1[0m
  [1m[35m (1.6ms)[0m  ROLLBACK
  Rendered lti_registration_wips/_form.html.haml (203.6ms)
  Rendered lti_registration_wips/update.html.haml within layouts/application (213.9ms)
Completed 200 OK in 687ms (Views: 336.9ms | ActiveRecord: 34.1ms)


Started PATCH "/lti_registration_wips/140" for 127.0.0.1 at 2015-08-19 14:20:18 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"GxfafjC5JyJXok0tHAYV1b7M8SEoNOosrIUugbPocnI=", "lti_registration_wip"=>{"support_email"=>"support_email", "product_name"=>"", "tenant_name"=>"Mock Consumer 2"}, "commit"=>"Update Lti registration wip", "id"=>"140"}
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 140 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti_registration_wips` SET `tenant_name` = 'Mock Consumer 2', `updated_at` = '2015-08-19 19:20:18' WHERE `lti_registration_wips`.`id` = 140
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 90 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'Mock Consumer 2', `updated_at` = '2015-08-19 19:20:18' WHERE `lti2_tp_registrations`.`id` = 90
  [1m[36m (2.7ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 140 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 90 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Mock Consumer 2' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:20:18', 'Mock Consumer 2', '2015-08-19 19:20:18')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '40996ad0-28d5-0133-7ce0-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":null,\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://lti-consumer.paulgray.net/api/profile?toolId=5\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"f08b30147ff52b78caff2e160fb251b4\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":null,\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 19:20:18' WHERE `lti2_tp_registrations`.`id` = 90[0m
  [1m[35m (1.2ms)[0m  COMMIT
Completed 500 Internal Server Error in 214ms

NoMethodError - undefined method `get_adjusted_baseurl' for #<Lti2Tp::Registration:0x007fff33c34620>:
  activemodel (4.1.9) lib/active_model/attribute_methods.rb:435:in `method_missing'
  activerecord (4.1.9) lib/active_record/attribute_methods.rb:213:in `method_missing'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:66:in `prepare_tool_proxy'
  app/controllers/lti_registration_wips_controller.rb:45:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:87:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/6394eefda58917fd/variables" for 127.0.0.1 at 2015-08-19 14:20:19 -0500
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.4ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:21:49 -0500
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"reg_key"=>"reg_key", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://lti-consumer.paulgray.net/api/profile?toolId=5", "launch_presentation_return_url"=>"http://lti-consumer.paulgray.net/", "lti_message_type"=>"lti-tool-proxy-registration-request"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`) VALUES ('2015-08-19 19:21:51', 'http://lti-consumer.paulgray.net/', 'version', 'registration', 'reg_key', 'reg_password', 'received', 'http://lti-consumer.paulgray.net/api/profile?toolId=5', '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",\"@type\":\"ToolConsumerProfile\",\"@id\":null,\"lti_version\":\"version\",\"guid\":\"guid\",\"product_instance\":{\"guid\":\"guid_from_config\",\"product_info\":{\"product_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"product_version\":null,\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"technical_description\":null,\"product_family\":{\"code\":null,\"vendor\":{\"code\":null,\"vendor_name\":{\"default_value\":null,\"key\":\"product.vendor.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"website\":null,\"timestamp\":null,\"contact\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"additionalProperties\":{}}},\"service_owner\":{\"_id\":\"service_owner_id\",\"service_owner_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"timestamp\":null,\"support\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"service_provider\":{\"_id\":null,\"service_provider_name\":{\"default_value\":null,\"key\":\"product.name\",\"additionalProperties\":{}},\"description\":{\"default_value\":null,\"key\":\"product.vendor.description\",\"additionalProperties\":{}},\"timestamp\":null,\"support\":{\"email\":null,\"additionalProperties\":{}},\"additionalProperties\":{}},\"support\":{\"email\":\"support_email\",\"additionalProperties\":{}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"User.image\",\"CourseSection.sourcedId\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"service_offered\":[{\"_type\":\"RestService\",\"_id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://lti-consumer.paulgray.net:80/api/tool_proxy_registration?toolId=5\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"],\"additionalProperties\":{}}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-08-19 19:21:51')
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=91&return_url=/lti2_tp/registrations
Completed 302 Found in 486ms (ActiveRecord: 14.3ms)


Started GET "/lti_registration_wips?registration_id=91&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:21:51 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"91", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 91 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:21:51', 91, '/lti2_tp/registrations', 'support_email', '-0221.51', '2015-08-19 19:21:51')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (2276.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (2299.0ms)
Completed 200 OK in 3263ms (Views: 3110.8ms | ActiveRecord: 10.7ms)


Started PATCH "/lti_registration_wips/141" for 127.0.0.1 at 2015-08-19 14:21:58 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"GxfafjC5JyJXok0tHAYV1b7M8SEoNOosrIUugbPocnI=", "lti_registration_wip"=>{"support_email"=>"support_email", "product_name"=>"", "tenant_name"=>"-0221.51"}, "commit"=>"Update Lti registration wip", "id"=>"141"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 141 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 91 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = '-0221.51', `updated_at` = '2015-08-19 19:21:58' WHERE `lti2_tp_registrations`.`id` = 91[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 141 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 91 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '-0221.51' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:21:58', '-0221.51', '2015-08-19 19:21:58')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '7bfc72f0-28d5-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":null,\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://lti-consumer.paulgray.net/api/profile?toolId=5\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"71fffa83d41ec012c133a388fe6c135b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":null,\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 19:21:58' WHERE `lti2_tp_registrations`.`id` = 91
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Completed 500 Internal Server Error in 762703ms

NoMethodError - undefined method `redirect_to' for #<Lti2Tp::Registration:0x007fece12434b8>:
  activemodel (4.1.9) lib/active_model/attribute_methods.rb:435:in `method_missing'
  activerecord (4.1.9) lib/active_record/attribute_methods.rb:213:in `method_missing'
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/models/lti2_tp/registration.rb:67:in `prepare_tool_proxy'
  app/controllers/lti_registration_wips_controller.rb:45:in `show_registration'
  app/controllers/lti_registration_wips_controller.rb:30:in `show'
  app/controllers/lti_registration_wips_controller.rb:87:in `update'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:48:05 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=31", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "reg_key"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 19:48:06', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=31', 'LTI-2p0', 'registration', '131cd4a8-e4b1-4a13-8931-74d31ff96ed2', 'a2d9e099-5e9d-4b32-a6c0-63b7e85ba661', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '131cd4a8-e4b1-4a13-8931-74d31ff96ed2', '2015-08-19 19:48:06')
  [1m[36m (14.3ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=92&return_url=/lti2_tp/registrations
Completed 302 Found in 960ms (ActiveRecord: 16.6ms)


Started GET "/lti_registration_wips?registration_id=92&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:48:07 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"92", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:48:07', 'Sakai', 92, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0248.07', '2015-08-19 19:48:07')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (172.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (178.8ms)
Completed 200 OK in 346ms (Views: 298.8ms | ActiveRecord: 5.2ms)


Started PATCH "/lti_registration_wips/142" for 127.0.0.1 at 2015-08-19 14:48:13 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0248.07"}, "commit"=>"Update Lti registration wip", "id"=>"142"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 142 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0248.07', `updated_at` = '2015-08-19 19:48:13' WHERE `lti2_tp_registrations`.`id` = 92
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 142 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0248.07' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:48:13', 'ETS-0248.07', '2015-08-19 19:48:13')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '26e48730-28d9-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"39db75791d44195f4999e4fd1a5f0612ed3acf6ae11f33aadf8f9d3cf9e794dda8caaafdff4c87db1d5e1b5a4a5ddc4aac36d7c6f75201327d00929fe15ed3c7\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 19:48:13' WHERE `lti2_tp_registrations`.`id` = 92[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"tc_half_shared_secret\":\"8322b08559f476a89c91cc935400e401eb719530c3dd67a6341b600c624a3df30c0ef675534843423ba634df9b9acfa17713f394e0da4397067224d02f281d56\",\"tool_proxy_guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\"}', `updated_at` = '2015-08-19 19:48:14' WHERE `lti2_tp_registrations`.`id` = 92
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0248.07' AND `tenants`.`id` != 85) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = '8322b08559f476a89c91cc935400e401eb719530c3dd67a6341b600c624a3df30c0ef675534843423ba634df9b9acfa17713f394e0da4397067224d02f281d5639db75791d44195f4999e4fd1a5f0612ed3acf6ae11f33aadf8f9d3cf9e794dda8caaafdff4c87db1d5e1b5a4a5ddc4aac36d7c6f75201327d00929fe15ed3c7', `tenant_key` = '131cd4a8-e4b1-4a13-8931-74d31ff96ed2', `updated_at` = '2015-08-19 19:48:14' WHERE `tenants`.`id` = 85
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '8322b08559f476a89c91cc935400e401eb719530c3dd67a6341b600c624a3df30c0ef675534843423ba634df9b9acfa17713f394e0da4397067224d02f281d5639db75791d44195f4999e4fd1a5f0612ed3acf6ae11f33aadf8f9d3cf9e794dda8caaafdff4c87db1d5e1b5a4a5ddc4aac36d7c6f75201327d00929fe15ed3c7', `tenant_id` = 85, `updated_at` = '2015-08-19 19:48:14' WHERE `lti2_tp_registrations`.`id` = 92[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2&&id=92
Completed 302 Found in 859ms (ActiveRecord: 20.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2&&id=92" for 127.0.0.1 at 2015-08-19 14:48:14 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "id"=>"92"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=31&status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2
Completed 302 Found in 19ms (ActiveRecord: 1.1ms)


Started POST "/echoes" for 127.0.0.1 at 2015-08-19 14:48:52 -0500
Processing by EchoesController#create as HTML
  Parameters: {"tool_consumer_info_product_family_code"=>"sakai", "resource_link_title"=>"Echo", "ext_ims_lis_memberships_id"=>"0fc95ecc89bc7b82f08aaf14ccfa2bd683c75fae52258a0e07a63e1066522262:::admin:::content:4", "lis_person_name_family"=>"Administrator", "roles"=>"Instructor,Administrator,urn:lti:instrole:ims/lis/Administrator,urn:lti:sysrole:ims/lis/Administrator", "custom_pi"=>"3.14159", "resource_link_id"=>"content:4", "oauth_signature_method"=>"HMAC-SHA1", "oauth_version"=>"1.0", "custom_user_primary_email"=>"Person.email.primary", "ext_sakai_launch_presentation_css_url_list"=>"http://sakai.ngrok.com/library/skin/tool_base.css,http://sakai.ngrok.com/library/skin/morpheus-default/tool.css", "launch_presentation_return_url"=>"http://sakai.ngrok.com/imsblis/service/return-url/site/mercury", "ext_ims_lis_basic_outcome_url"=>"http://sakai.ngrok.com/imsblis/service/", "ext_lms"=>"sakai-11-SNAPSHOT", "ext_ims_lti_tool_setting_url"=>"http://sakai.ngrok.com/imsblis/service/", "lti_version"=>"LTI-2p0", "ext_sakai_role"=>"maintain", "oauth_signature"=>"w1CsQy4ozchH71qUulrJ22Pbac4=", "ext_ims_lis_memberships_url"=>"http://sakai.ngrok.com/imsblis/service/", "ext_lori_api_url"=>"http://sakai.ngrok.com/imsblis/service/", "ext_ims_lti_tool_setting_id"=>"0fc95ecc89bc7b82f08aaf14ccfa2bd683c75fae52258a0e07a63e1066522262:::admin:::content:4", "oauth_consumer_key"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "launch_presentation_locale"=>"en_US", "ext_sakai_serverid"=>"dyn-72-33-49-181.uwnet.wisc.edu", "oauth_timestamp"=>"1440013731", "lis_person_sourcedid"=>"admin", "lis_person_name_full"=>"Sakai Administrator", "launch_presentation_css_url"=>"http://sakai.ngrok.com/library/skin/tool_base.css", "lis_result_sourcedid"=>"0fc95ecc89bc7b82f08aaf14ccfa2bd683c75fae52258a0e07a63e1066522262:::admin:::content:4", "lis_person_name_given"=>"Sakai", "lis_outcome_service_url"=>"http://sakai.ngrok.com/imsblis/service/", "ext_sakai_server"=>"http://sakai.ngrok.com", "oauth_nonce"=>"208258325479235", "user_id"=>"admin", "oauth_callback"=>"about:blank", "lti_message_type"=>"basic-lti-launch-request", "tool_consumer_info_version"=>"11-SNAPSHOT", "custom_referrer"=>"Narcissus", "context_id"=>"mercury", "ext_lori_api_url_xml"=>"http://sakai.ngrok.com/imsblis/service/", "ext_lori_api_token"=>"0fc95ecc89bc7b82f08aaf14ccfa2bd683c75fae52258a0e07a63e1066522262:::admin:::content:4", "context_label"=>"mercury site", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '131cd4a8-e4b1-4a13-8931-74d31ff96ed2'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 85  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  Rendered inline template (2.1ms)
Completed 200 OK in 97ms (Views: 6.8ms | ActiveRecord: 2.4ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 14:49:05 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"foq5YEnoQB7NRfi+mzrPcRHl+8k=", "oauth_consumer_key"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440013744", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=31", "oauth_nonce"=>"208271163878794", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '131cd4a8-e4b1-4a13-8931-74d31ff96ed2'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 85  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0248.07'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 85 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '8322b08559f476a89c91cc935400e401eb719530c3dd67a6341b600c624a3df30c0ef675534843423ba634df9b9acfa17713f394e0da4397067224d02f281d5639db75791d44195f4999e4fd1a5f0612ed3acf6ae11f33aadf8f9d3cf9e794dda8caaafdff4c87db1d5e1b5a4a5ddc4aac36d7c6f75201327d00929fe15ed3c7', `status` = 'received', `updated_at` = '2015-08-19 19:49:05' WHERE `lti2_tp_registrations`.`id` = 92
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=92&return_url=/lti2_tp/registrations
Completed 302 Found in 649ms (ActiveRecord: 6.8ms)


Started GET "/lti_registration_wips?registration_id=92&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:49:06 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"92", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:49:06', 'Sakai', 92, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0248.07', '2015-08-19 19:49:06')
  [1m[36m (1.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (154.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (160.9ms)
Completed 200 OK in 351ms (Views: 305.1ms | ActiveRecord: 4.3ms)


Started PATCH "/lti_registration_wips/143" for 127.0.0.1 at 2015-08-19 14:49:16 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0248.07"}, "commit"=>"Update Lti registration wip", "id"=>"143"}
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 143 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 143 LIMIT 1  [["id", "143"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1[0m  [["id", 92]]
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0248.07'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '564f8950-28d9-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"1246f138cd14853862696694a7c1d15739b12d53465408e34a400a1d5469117ad11ada2c34b58391d4fa9d6886f7097749ce88a121cca8646db09d1d5156e32a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 19:49:33' WHERE `lti2_tp_registrations`.`id` = 92
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"1246f138cd14853862696694a7c1d15739b12d53465408e34a400a1d5469117ad11ada2c34b58391d4fa9d6886f7097749ce88a121cca8646db09d1d5156e32a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/131cd4a8-e4b1-4a13-8931-74d31ff96ed2\",\"tc_half_shared_secret\":\"851c5a168fc4aa9db93af63989134e699165f1bb38f4f144ef15b24b42a34e770bfcf23115aae9a3fea2e661f2d8e331a7e5469fb36e6d7134bd1dbb90329490\",\"tool_proxy_guid\":\"131cd4a8-e4b1-4a13-8931-74d31ff96ed2\"}', `updated_at` = '2015-08-19 19:49:33' WHERE `lti2_tp_registrations`.`id` = 92[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 19:49:33' WHERE `lti2_tp_registrations`.`id` = 92
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2&&id=92
Completed 302 Found in 17711ms (ActiveRecord: 11.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2&&id=92" for 127.0.0.1 at 2015-08-19 14:49:34 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"131cd4a8-e4b1-4a13-8931-74d31ff96ed2", "id"=>"92"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 92 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=31&status=success&tool_guid=131cd4a8-e4b1-4a13-8931-74d31ff96ed2
Completed 302 Found in 19ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:55:28 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451", "reg_key"=>"2489c4b0-28da-0133-7cde-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"4170ba1524250e3f04fe98634f629e79"}
  [1m[36mLti2Tp::Tool Load (1.3ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2015-08-19 19:55:28', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '2489c4b0-28da-0133-7cde-20c9d07c6451', '2c1e0a2e36cab1c50bc4328b13878db0', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2499e970-28b2-0133-7cde-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/2499e970-28b2-0133-7cde-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"2489c720-28da-0133-7cde-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '4170ba1524250e3f04fe98634f629e79', '2015-08-19 19:55:28', '2')[0m
  [1m[35m (2.5ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=93&return_url=/lti2_tp/registrations
Completed 302 Found in 325ms (ActiveRecord: 5.8ms)


Started GET "/lti_registration_wips?registration_id=93&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:55:28 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"93", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:55:28', 'Elan/LuMoS', 93, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0255.28', '2015-08-19 19:55:28')[0m
  [1m[35m (1.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (189.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (196.0ms)
Completed 200 OK in 422ms (Views: 351.1ms | ActiveRecord: 4.6ms)


Started PATCH "/lti_registration_wips/144" for 127.0.0.1 at 2015-08-19 14:55:33 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"9RuC/Jdk3vAuLV88nUDrRAiGdZUwtK6d6JBsAw2aXn8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0255.28"}, "commit"=>"Update Lti registration wip", "id"=>"144"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 144 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'Elan University-0255.28', `updated_at` = '2015-08-19 19:55:33' WHERE `lti2_tp_registrations`.`id` = 93[0m
  [1m[35m (2.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 144 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'Elan University-0255.28' LIMIT 1
  [1m[36mSQL (2.1ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:55:33', 'Elan University-0255.28', '2015-08-19 19:55:33')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '2d1c3800-28da-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4170ba1524250e3f04fe98634f629e79\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"e11780335a8694d87ddeecf1be24fd79\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-08-19 19:55:33' WHERE `lti2_tp_registrations`.`id` = 93
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"4170ba1524250e3f04fe98634f629e79\"}', `updated_at` = '2015-08-19 19:55:34' WHERE `lti2_tp_registrations`.`id` = 93[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0255.28' AND `tenants`.`id` != 86) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = 'e11780335a8694d87ddeecf1be24fd79', `tenant_key` = '4170ba1524250e3f04fe98634f629e79', `updated_at` = '2015-08-19 19:55:34' WHERE `tenants`.`id` = 86[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'e11780335a8694d87ddeecf1be24fd79', `tenant_id` = 86, `updated_at` = '2015-08-19 19:55:34' WHERE `lti2_tp_registrations`.`id` = 93
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79&&id=93
Completed 302 Found in 559ms (ActiveRecord: 23.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79&&id=93" for 127.0.0.1 at 2015-08-19 14:55:34 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"4170ba1524250e3f04fe98634f629e79", "id"=>"93"}
  [1m[35mLti2Tp::Registration Load (1.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79
Completed 302 Found in 18ms (ActiveRecord: 1.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 14:55:40 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"4170ba1524250e3f04fe98634f629e79", "oauth_nonce"=>"9650700169346", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1440014140", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"u6ReOXhbrGcSJ5lNDWCpT4AELXA="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.1ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '4170ba1524250e3f04fe98634f629e79'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 86  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0255.28'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 86 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_key` = '4170ba1524250e3f04fe98634f629e79', `reg_password` = 'e11780335a8694d87ddeecf1be24fd79', `status` = 'received', `updated_at` = '2015-08-19 19:55:40' WHERE `lti2_tp_registrations`.`id` = 93
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=93&return_url=/lti2_tp/registrations
Completed 302 Found in 355ms (ActiveRecord: 8.7ms)


Started GET "/lti_registration_wips?registration_id=93&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 14:55:40 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"93", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 19:55:40', 'Elan/LuMoS', 93, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'Elan University-0255.28', '2015-08-19 19:55:40')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (212.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (218.5ms)
Completed 200 OK in 436ms (Views: 373.9ms | ActiveRecord: 3.8ms)


Started PATCH "/lti_registration_wips/145" for 127.0.0.1 at 2015-08-19 14:55:45 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"9RuC/Jdk3vAuLV88nUDrRAiGdZUwtK6d6JBsAw2aXn8=", "lti_registration_wip"=>{"support_email"=>"john.tibbetts@kinexis.com", "product_name"=>"Elan/LuMoS", "tenant_name"=>"Elan University-0255.28"}, "commit"=>"Update Lti registration wip", "id"=>"145"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 145 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 145 LIMIT 1  [["id", "145"]]
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1[0m  [["id", 93]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University-0255.28'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '33f30c80-28da-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4170ba1524250e3f04fe98634f629e79\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"f958a375a0b0303825fe124d0825f73d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-08-19 19:55:45' WHERE `lti2_tp_registrations`.`id` = 93
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4170ba1524250e3f04fe98634f629e79\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/2489c720-28da-0133-7cde-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"f958a375a0b0303825fe124d0825f73d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-08-19 19:55:45' WHERE `lti2_tp_registrations`.`id` = 93[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 19:55:45' WHERE `lti2_tp_registrations`.`id` = 93
  [1m[36m (2.9ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79&&id=93
Completed 302 Found in 442ms (ActiveRecord: 16.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79&&id=93" for 127.0.0.1 at 2015-08-19 14:55:45 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"4170ba1524250e3f04fe98634f629e79", "id"=>"93"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 93 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=4170ba1524250e3f04fe98634f629e79
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/4170ba1524250e3f04fe98634f629e79?correlation=33f30c80-28da-0133-7ce1-20c9d07c6451" for 127.0.0.1 at 2015-08-19 14:55:48 -0500
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"33f30c80-28da-0133-7ce1-20c9d07c6451", "id"=>"4170ba1524250e3f04fe98634f629e79"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"4170ba1524250e3f04fe98634f629e79", :oauth_nonce=>"7621520279685", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1440014147", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"oXVKg/d/Ib80SNkN5BZGB0MZveI="}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '4170ba1524250e3f04fe98634f629e79'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 86  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {:oauth_consumer_key=>"4170ba1524250e3f04fe98634f629e79", :oauth_nonce=>"7621520279685", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1440014147", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"oXVKg/d/Ib80SNkN5BZGB0MZveI="}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'Elan University-0255.28'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 86  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 86 LIMIT 1[0m
  [1m[35m (86.8ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'Elan University-0255.28' AND `tenants`.`id` != 86) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = 'f958a375a0b0303825fe124d0825f73d', `updated_at` = '2015-08-19 19:55:53' WHERE `tenants`.`id` = 86
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `final_secret` = 'f958a375a0b0303825fe124d0825f73d', `proposed_tool_proxy_json` = NULL, `updated_at` = '2015-08-19 19:55:53' WHERE `lti2_tp_registrations`.`id` = 93[0m
  [1m[35m (1.4ms)[0m  COMMIT
"reregistration complete for 4170ba1524250e3f04fe98634f629e79"
  Rendered text template (0.3ms)
Completed 200 OK in 4911ms (Views: 8.0ms | ActiveRecord: 97.1ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:02:47 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=32", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"e80217b2-e1a2-4b4f-927a-13c03619c99a", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a", "reg_key"=>"e80217b2-e1a2-4b4f-927a-13c03619c99a", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[36mLti2Tp::Tool Load (1.1ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (2.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:02:50', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=32', 'LTI-2p0', 'registration', 'e80217b2-e1a2-4b4f-927a-13c03619c99a', 'aedd036c-a68d-4ed8-b52a-85a0aefa3ec1', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'e80217b2-e1a2-4b4f-927a-13c03619c99a', '2015-08-19 20:02:50')[0m
  [1m[35m (12.9ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=94&return_url=/lti2_tp/registrations
Completed 302 Found in 2828ms (ActiveRecord: 16.4ms)


Started GET "/lti_registration_wips?registration_id=94&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:02:50 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"94", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:02:50', 'Sakai', 94, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0302.50', '2015-08-19 20:02:50')[0m
  [1m[35m (2.2ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (168.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (173.9ms)
Completed 200 OK in 344ms (Views: 296.6ms | ActiveRecord: 5.2ms)


Started PATCH "/lti_registration_wips/146" for 127.0.0.1 at 2015-08-19 15:02:54 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0302.50"}, "commit"=>"Update Lti registration wip", "id"=>"146"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 146 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0302.50', `updated_at` = '2015-08-19 20:02:54' WHERE `lti2_tp_registrations`.`id` = 94
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 146 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0302.50' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:02:54', 'ETS-0302.50', '2015-08-19 20:02:54')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '33f2a990-28db-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f434618b8a7805c0fb2196d160a0c925a706e9851d727c32ff20b4af3c3c61cf4b5039a249b7fda04d6725d1d427fc94253687475d4ded40b37ce3a4831ea344\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:02:54' WHERE `lti2_tp_registrations`.`id` = 94[0m
  [1m[35m (1.5ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"tc_half_shared_secret\":\"08a35741d0eb7ce00a642e98c8a6b7be81d990740f7352b67a97ec824d9fecd04540e9fcbf188b0cbb9926bc6bf4de922d610f4ef65317b735ea56aa8627357d\",\"tool_proxy_guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\"}', `updated_at` = '2015-08-19 20:02:55' WHERE `lti2_tp_registrations`.`id` = 94
  [1m[36m (12.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0302.50' AND `tenants`.`id` != 87) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = '08a35741d0eb7ce00a642e98c8a6b7be81d990740f7352b67a97ec824d9fecd04540e9fcbf188b0cbb9926bc6bf4de922d610f4ef65317b735ea56aa8627357df434618b8a7805c0fb2196d160a0c925a706e9851d727c32ff20b4af3c3c61cf4b5039a249b7fda04d6725d1d427fc94253687475d4ded40b37ce3a4831ea344', `tenant_key` = 'e80217b2-e1a2-4b4f-927a-13c03619c99a', `updated_at` = '2015-08-19 20:02:55' WHERE `tenants`.`id` = 87
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '08a35741d0eb7ce00a642e98c8a6b7be81d990740f7352b67a97ec824d9fecd04540e9fcbf188b0cbb9926bc6bf4de922d610f4ef65317b735ea56aa8627357df434618b8a7805c0fb2196d160a0c925a706e9851d727c32ff20b4af3c3c61cf4b5039a249b7fda04d6725d1d427fc94253687475d4ded40b37ce3a4831ea344', `tenant_id` = 87, `updated_at` = '2015-08-19 20:02:55' WHERE `lti2_tp_registrations`.`id` = 94[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a&&id=94
Completed 302 Found in 717ms (ActiveRecord: 31.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a&&id=94" for 127.0.0.1 at 2015-08-19 15:02:55 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"e80217b2-e1a2-4b4f-927a-13c03619c99a", "id"=>"94"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=32&status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a
Completed 302 Found in 16ms (ActiveRecord: 1.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:03:06 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"YNcR+yLLwaXKWf+GLH6aeEXSVGs=", "oauth_consumer_key"=>"e80217b2-e1a2-4b4f-927a-13c03619c99a", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440014586", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=32", "oauth_nonce"=>"209112954693723", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'e80217b2-e1a2-4b4f-927a-13c03619c99a'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 87  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0302.50'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 87 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '08a35741d0eb7ce00a642e98c8a6b7be81d990740f7352b67a97ec824d9fecd04540e9fcbf188b0cbb9926bc6bf4de922d610f4ef65317b735ea56aa8627357df434618b8a7805c0fb2196d160a0c925a706e9851d727c32ff20b4af3c3c61cf4b5039a249b7fda04d6725d1d427fc94253687475d4ded40b37ce3a4831ea344', `status` = 'received', `updated_at` = '2015-08-19 20:03:07' WHERE `lti2_tp_registrations`.`id` = 94[0m
  [1m[35m (1.2ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=94&return_url=/lti2_tp/registrations
Completed 302 Found in 658ms (ActiveRecord: 6.8ms)


Started GET "/lti_registration_wips?registration_id=94&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:03:07 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"94", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:03:07', 'Sakai', 94, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0302.50', '2015-08-19 20:03:07')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (174.5ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (180.4ms)
Completed 200 OK in 410ms (Views: 341.4ms | ActiveRecord: 3.4ms)


Started PATCH "/lti_registration_wips/147" for 127.0.0.1 at 2015-08-19 15:03:11 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0302.50"}, "commit"=>"Update Lti registration wip", "id"=>"147"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 147 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 147 LIMIT 1[0m  [["id", "147"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1  [["id", 94]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0302.50'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '3dda8ce0-28db-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"a3894f3beee45d3f3dd70e92ed67fdbc02f3e6307d628844d338e86a3e8fe1dd6b672b8443f67204a5af07abadeb6b7703eb3643d4ed59334b2be02d514e0238\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:03:11' WHERE `lti2_tp_registrations`.`id` = 94[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"a3894f3beee45d3f3dd70e92ed67fdbc02f3e6307d628844d338e86a3e8fe1dd6b672b8443f67204a5af07abadeb6b7703eb3643d4ed59334b2be02d514e0238\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/e80217b2-e1a2-4b4f-927a-13c03619c99a\",\"tc_half_shared_secret\":\"761297c7a6ada7abd789de53b6f800029b036bef35d36960e6af8959deb8ba06e035656496c6e2833c964616beb841d11a83ef298a39d4d3d76d5abcb2da5af7\",\"tool_proxy_guid\":\"e80217b2-e1a2-4b4f-927a-13c03619c99a\"}', `updated_at` = '2015-08-19 20:03:11' WHERE `lti2_tp_registrations`.`id` = 94
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:03:11' WHERE `lti2_tp_registrations`.`id` = 94[0m
  [1m[35m (1.5ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a&&id=94
Completed 302 Found in 826ms (ActiveRecord: 14.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a&&id=94" for 127.0.0.1 at 2015-08-19 15:03:12 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"e80217b2-e1a2-4b4f-927a-13c03619c99a", "id"=>"94"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 94 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=32&status=success&tool_guid=e80217b2-e1a2-4b4f-927a-13c03619c99a
Completed 302 Found in 17ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:08:00 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=33", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"ffa954c0-e958-4507-a958-8fbc8392465e", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e", "reg_key"=>"ffa954c0-e958-4507-a958-8fbc8392465e", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[35mLti2Tp::Tool Load (1.0ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:08:00', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=33', 'LTI-2p0', 'registration', 'ffa954c0-e958-4507-a958-8fbc8392465e', '0008ded8-2cfa-4a57-9f4b-8481ad4f620e', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/ffa954c0-e958-4507-a958-8fbc8392465e\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'ffa954c0-e958-4507-a958-8fbc8392465e', '2015-08-19 20:08:00')
  [1m[36m (1.5ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=95&return_url=/lti2_tp/registrations
Completed 302 Found in 615ms (ActiveRecord: 3.8ms)


Started GET "/lti_registration_wips?registration_id=95&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:08:01 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"95", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:08:01', 'Sakai', 95, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0308.01', '2015-08-19 20:08:01')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (159.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (164.5ms)
Completed 200 OK in 352ms (Views: 295.1ms | ActiveRecord: 4.7ms)


Started PATCH "/lti_registration_wips/148" for 127.0.0.1 at 2015-08-19 15:08:05 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0308.01"}, "commit"=>"Update Lti registration wip", "id"=>"148"}
  [1m[35mLtiRegistrationWip Load (1.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 148 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0308.01', `updated_at` = '2015-08-19 20:08:05' WHERE `lti2_tp_registrations`.`id` = 95[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 148 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0308.01' LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:08:05', 'ETS-0308.01', '2015-08-19 20:08:05')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'ed093f40-28db-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"6f04770570754dabf2d015bbeb0913337438de2d60d4f7dd3cb4360a287775043386bf90645df345b2e17a1ae8e6c153633ed583d5f0131f12d0ef88e706dda2\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-08-19 20:08:05' WHERE `lti2_tp_registrations`.`id` = 95
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/ffa954c0-e958-4507-a958-8fbc8392465e\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/ffa954c0-e958-4507-a958-8fbc8392465e\",\"tc_half_shared_secret\":\"9fdfeab9c9fdc9aaec61e8b39244b19dbb5de84094b281da36797d8747b920562ac530dd99f8d4a634718b3bb20b315421ae5a8ffbfe3966970f34829f520ceb\",\"tool_proxy_guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\"}', `updated_at` = '2015-08-19 20:08:07' WHERE `lti2_tp_registrations`.`id` = 95[0m
  [1m[35m (2.2ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0308.01' AND `tenants`.`id` != 88) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = '9fdfeab9c9fdc9aaec61e8b39244b19dbb5de84094b281da36797d8747b920562ac530dd99f8d4a634718b3bb20b315421ae5a8ffbfe3966970f34829f520ceb6f04770570754dabf2d015bbeb0913337438de2d60d4f7dd3cb4360a287775043386bf90645df345b2e17a1ae8e6c153633ed583d5f0131f12d0ef88e706dda2', `tenant_key` = 'ffa954c0-e958-4507-a958-8fbc8392465e', `updated_at` = '2015-08-19 20:08:07' WHERE `tenants`.`id` = 88[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '9fdfeab9c9fdc9aaec61e8b39244b19dbb5de84094b281da36797d8747b920562ac530dd99f8d4a634718b3bb20b315421ae5a8ffbfe3966970f34829f520ceb6f04770570754dabf2d015bbeb0913337438de2d60d4f7dd3cb4360a287775043386bf90645df345b2e17a1ae8e6c153633ed583d5f0131f12d0ef88e706dda2', `tenant_id` = 88, `updated_at` = '2015-08-19 20:08:07' WHERE `lti2_tp_registrations`.`id` = 95
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e&&id=95
Completed 302 Found in 2830ms (ActiveRecord: 20.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e&&id=95" for 127.0.0.1 at 2015-08-19 15:08:07 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"ffa954c0-e958-4507-a958-8fbc8392465e", "id"=>"95"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=33&status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e
Completed 302 Found in 18ms (ActiveRecord: 1.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:08:27 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"h1zUCWitmPGkIatmil7h0v9bWs0=", "oauth_consumer_key"=>"ffa954c0-e958-4507-a958-8fbc8392465e", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440014906", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=33", "oauth_nonce"=>"209433207539963", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'ffa954c0-e958-4507-a958-8fbc8392465e'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 88  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0308.01'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 88 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '9fdfeab9c9fdc9aaec61e8b39244b19dbb5de84094b281da36797d8747b920562ac530dd99f8d4a634718b3bb20b315421ae5a8ffbfe3966970f34829f520ceb6f04770570754dabf2d015bbeb0913337438de2d60d4f7dd3cb4360a287775043386bf90645df345b2e17a1ae8e6c153633ed583d5f0131f12d0ef88e706dda2', `status` = 'received', `updated_at` = '2015-08-19 20:08:27' WHERE `lti2_tp_registrations`.`id` = 95
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=95&return_url=/lti2_tp/registrations
Completed 302 Found in 851ms (ActiveRecord: 8.4ms)


Started GET "/lti_registration_wips?registration_id=95&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:08:28 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"95", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:08:28', 'Sakai', 95, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0308.01', '2015-08-19 20:08:28')
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (232.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (238.6ms)
Completed 200 OK in 420ms (Views: 374.0ms | ActiveRecord: 4.3ms)


Started PATCH "/lti_registration_wips/149" for 127.0.0.1 at 2015-08-19 15:08:30 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0308.01"}, "commit"=>"Update Lti registration wip", "id"=>"149"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 149 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 149 LIMIT 1  [["id", "149"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1[0m  [["id", 95]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0308.01'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'fc7a6600-28db-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"549e8468ad2ddc927dcd1b36791c89c453d8bbd59c4c6eb6d958829a9ef9124685c5936430265bebfcbff0ada91569fcc814143cffbd757d4be292328b38b7e9\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-08-19 20:08:31' WHERE `lti2_tp_registrations`.`id` = 95
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/ffa954c0-e958-4507-a958-8fbc8392465e\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"549e8468ad2ddc927dcd1b36791c89c453d8bbd59c4c6eb6d958829a9ef9124685c5936430265bebfcbff0ada91569fcc814143cffbd757d4be292328b38b7e9\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/ffa954c0-e958-4507-a958-8fbc8392465e\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/ffa954c0-e958-4507-a958-8fbc8392465e\",\"tc_half_shared_secret\":\"822e18f9d08638167f64bd820e1e6b15120002974f378b8ff27f1256be203dcd0ceddd27d2cd29fe36e8fd07e90649e1dab9146116024567923543f25b47f146\",\"tool_proxy_guid\":\"ffa954c0-e958-4507-a958-8fbc8392465e\"}', `updated_at` = '2015-08-19 20:08:31' WHERE `lti2_tp_registrations`.`id` = 95[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:08:31' WHERE `lti2_tp_registrations`.`id` = 95
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e&&id=95
Completed 302 Found in 796ms (ActiveRecord: 13.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e&&id=95" for 127.0.0.1 at 2015-08-19 15:08:32 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"ffa954c0-e958-4507-a958-8fbc8392465e", "id"=>"95"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 95 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=33&status=success&tool_guid=ffa954c0-e958-4507-a958-8fbc8392465e
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:16:30 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=34", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "reg_key"=>"94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[36mLti2Tp::Tool Load (1.2ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.7ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:16:33', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=34', 'LTI-2p0', 'registration', '94f9a61c-ee1f-48aa-97ae-9a8865b8406b', 'b709047f-cca6-4e81-b931-755a64f1903f', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '94f9a61c-ee1f-48aa-97ae-9a8865b8406b', '2015-08-19 20:16:33')[0m
  [1m[35m (11.6ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=96&return_url=/lti2_tp/registrations
Completed 302 Found in 2366ms (ActiveRecord: 15.0ms)


Started GET "/lti_registration_wips?registration_id=96&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:16:33 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"96", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (4.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:16:33', 'Sakai', 96, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0316.33', '2015-08-19 20:16:33')[0m
  [1m[35m (2.4ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (157.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (171.6ms)
Completed 200 OK in 396ms (Views: 300.6ms | ActiveRecord: 9.4ms)


Started PATCH "/lti_registration_wips/150" for 127.0.0.1 at 2015-08-19 15:16:47 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0316.33"}, "commit"=>"Update Lti registration wip", "id"=>"150"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 150 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0316.33', `updated_at` = '2015-08-19 20:16:47' WHERE `lti2_tp_registrations`.`id` = 96
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 150 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0316.33' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:16:47', 'ETS-0316.33', '2015-08-19 20:16:47')
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (2.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '2493c180-28dd-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"a656f68583ac31c82229c42852e00a000787b503409f66fae3e86c9304e13763679e602a833d98ce2cc1bb4704e3b475baba444b540bb8667f2fe9feb17c8536\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:16:47' WHERE `lti2_tp_registrations`.`id` = 96[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"tc_half_shared_secret\":\"0623ee4eb0fad1e2b252e3b954d5621d1dda513fc841cc1c121ed00a9becb3b1081535119578d6544cd219412f917db6b204fc79605188e73a27600b787d127b\",\"tool_proxy_guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\"}', `updated_at` = '2015-08-19 20:16:48' WHERE `lti2_tp_registrations`.`id` = 96
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0316.33' AND `tenants`.`id` != 89) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = '0623ee4eb0fad1e2b252e3b954d5621d1dda513fc841cc1c121ed00a9becb3b1081535119578d6544cd219412f917db6b204fc79605188e73a27600b787d127ba656f68583ac31c82229c42852e00a000787b503409f66fae3e86c9304e13763679e602a833d98ce2cc1bb4704e3b475baba444b540bb8667f2fe9feb17c8536', `tenant_key` = '94f9a61c-ee1f-48aa-97ae-9a8865b8406b', `updated_at` = '2015-08-19 20:16:48' WHERE `tenants`.`id` = 89
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '0623ee4eb0fad1e2b252e3b954d5621d1dda513fc841cc1c121ed00a9becb3b1081535119578d6544cd219412f917db6b204fc79605188e73a27600b787d127ba656f68583ac31c82229c42852e00a000787b503409f66fae3e86c9304e13763679e602a833d98ce2cc1bb4704e3b475baba444b540bb8667f2fe9feb17c8536', `tenant_id` = 89, `updated_at` = '2015-08-19 20:16:48' WHERE `lti2_tp_registrations`.`id` = 96[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b&&id=96
Completed 302 Found in 655ms (ActiveRecord: 19.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b&&id=96" for 127.0.0.1 at 2015-08-19 15:16:48 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "id"=>"96"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=34&status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b
Completed 302 Found in 21ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:17:04 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"lcjvfi80UkZU1TiAZ3AlLPnkY6k=", "oauth_consumer_key"=>"94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440015424", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=34", "oauth_nonce"=>"209950661774254", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '94f9a61c-ee1f-48aa-97ae-9a8865b8406b'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 89  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0316.33'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 89 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '0623ee4eb0fad1e2b252e3b954d5621d1dda513fc841cc1c121ed00a9becb3b1081535119578d6544cd219412f917db6b204fc79605188e73a27600b787d127ba656f68583ac31c82229c42852e00a000787b503409f66fae3e86c9304e13763679e602a833d98ce2cc1bb4704e3b475baba444b540bb8667f2fe9feb17c8536', `status` = 'received', `updated_at` = '2015-08-19 20:17:05' WHERE `lti2_tp_registrations`.`id` = 96[0m
  [1m[35m (1.6ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=96&return_url=/lti2_tp/registrations
Completed 302 Found in 680ms (ActiveRecord: 8.0ms)


Started GET "/lti_registration_wips?registration_id=96&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:17:05 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"96", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:17:05', 'Sakai', 96, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0316.33', '2015-08-19 20:17:05')[0m
  [1m[35m (0.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (164.7ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (170.3ms)
Completed 200 OK in 373ms (Views: 330.6ms | ActiveRecord: 3.2ms)


Started PATCH "/lti_registration_wips/151" for 127.0.0.1 at 2015-08-19 15:17:18 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0316.33"}, "commit"=>"Update Lti registration wip", "id"=>"151"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1[0m  [["id", "151"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1  [["id", 96]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0316.33'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '36f5d010-28dd-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"57c645ca53a075af9cbaf4d03957a7337c938111bf3e03f97c6c5db581ba69e24a8c9ff74543881d9c40629e745d14b5c569ab9869ad8b4fdca572d4531d9fba\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:17:18' WHERE `lti2_tp_registrations`.`id` = 96[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"57c645ca53a075af9cbaf4d03957a7337c938111bf3e03f97c6c5db581ba69e24a8c9ff74543881d9c40629e745d14b5c569ab9869ad8b4fdca572d4531d9fba\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/94f9a61c-ee1f-48aa-97ae-9a8865b8406b\",\"tc_half_shared_secret\":\"e7d9510b2bd3634455ef67c43e9d81520e236d6414b5aa5a34941d403a06be327f8a97624ec67656bdba237d76c73a658e2f9e67e1cdf3d9c3357239777da390\",\"tool_proxy_guid\":\"94f9a61c-ee1f-48aa-97ae-9a8865b8406b\"}', `updated_at` = '2015-08-19 20:17:19' WHERE `lti2_tp_registrations`.`id` = 96
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:17:19' WHERE `lti2_tp_registrations`.`id` = 96[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b&&id=96
Completed 302 Found in 636ms (ActiveRecord: 13.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b&&id=96" for 127.0.0.1 at 2015-08-19 15:17:19 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"94f9a61c-ee1f-48aa-97ae-9a8865b8406b", "id"=>"96"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 96 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=34&status=success&tool_guid=94f9a61c-ee1f-48aa-97ae-9a8865b8406b
Completed 302 Found in 16ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:20:23 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=35", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"90884945-490b-45f5-b416-05721abd2cde", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde", "reg_key"=>"90884945-490b-45f5-b416-05721abd2cde", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:20:25', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=35', 'LTI-2p0', 'registration', '90884945-490b-45f5-b416-05721abd2cde', '33393a10-f1ee-4765-ad3a-68ad1bb372d7', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"90884945-490b-45f5-b416-05721abd2cde\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/90884945-490b-45f5-b416-05721abd2cde\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '90884945-490b-45f5-b416-05721abd2cde', '2015-08-19 20:20:25')
  [1m[36m (13.8ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=97&return_url=/lti2_tp/registrations
Completed 302 Found in 2081ms (ActiveRecord: 16.1ms)


Started GET "/lti_registration_wips?registration_id=97&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:20:25 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"97", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:20:25', 'Sakai', 97, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0320.25', '2015-08-19 20:20:25')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (163.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (170.8ms)
Completed 200 OK in 328ms (Views: 286.5ms | ActiveRecord: 2.9ms)


Started PATCH "/lti_registration_wips/152" for 127.0.0.1 at 2015-08-19 15:20:31 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0320.25"}, "commit"=>"Update Lti registration wip", "id"=>"152"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 152 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0320.25', `updated_at` = '2015-08-19 20:20:31' WHERE `lti2_tp_registrations`.`id` = 97[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 152 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0320.25' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:20:31', 'ETS-0320.25', '2015-08-19 20:20:31')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.5ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'a9ba1cf0-28dd-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"90884945-490b-45f5-b416-05721abd2cde\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"3a7981165858499bcfec5a0ebb97b79bcb1c2cb4420da3ac2ce748eeaecc67adb5e1790e795a4342f6e8282dc86c30329ad779e2a0eb349ee6b504660a78ee3b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:20:31' WHERE `lti2_tp_registrations`.`id` = 97
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/90884945-490b-45f5-b416-05721abd2cde\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/90884945-490b-45f5-b416-05721abd2cde\",\"tc_half_shared_secret\":\"d6bfb578b01e4b4b1ef0e7c6c27a8a3f8c784d3bc67e8dcac0f0f7e67896810a79d30566cf306f67dbed5c5d0fa3f5bb5b57f5f7f5a130ab4d2348549a4f9414\",\"tool_proxy_guid\":\"90884945-490b-45f5-b416-05721abd2cde\"}', `updated_at` = '2015-08-19 20:20:31' WHERE `lti2_tp_registrations`.`id` = 97[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0320.25' AND `tenants`.`id` != 90) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `tenants` SET `secret` = 'd6bfb578b01e4b4b1ef0e7c6c27a8a3f8c784d3bc67e8dcac0f0f7e67896810a79d30566cf306f67dbed5c5d0fa3f5bb5b57f5f7f5a130ab4d2348549a4f94143a7981165858499bcfec5a0ebb97b79bcb1c2cb4420da3ac2ce748eeaecc67adb5e1790e795a4342f6e8282dc86c30329ad779e2a0eb349ee6b504660a78ee3b', `tenant_key` = '90884945-490b-45f5-b416-05721abd2cde', `updated_at` = '2015-08-19 20:20:31' WHERE `tenants`.`id` = 90[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'd6bfb578b01e4b4b1ef0e7c6c27a8a3f8c784d3bc67e8dcac0f0f7e67896810a79d30566cf306f67dbed5c5d0fa3f5bb5b57f5f7f5a130ab4d2348549a4f94143a7981165858499bcfec5a0ebb97b79bcb1c2cb4420da3ac2ce748eeaecc67adb5e1790e795a4342f6e8282dc86c30329ad779e2a0eb349ee6b504660a78ee3b', `tenant_id` = 90, `updated_at` = '2015-08-19 20:20:31' WHERE `lti2_tp_registrations`.`id` = 97
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde&&id=97
Completed 302 Found in 817ms (ActiveRecord: 20.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde&&id=97" for 127.0.0.1 at 2015-08-19 15:20:32 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"90884945-490b-45f5-b416-05721abd2cde", "id"=>"97"}
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=35&status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde
Completed 302 Found in 17ms (ActiveRecord: 1.2ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:20:42 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"PNh0VQF/rOX1C7DbxuB46YxRG4k=", "oauth_consumer_key"=>"90884945-490b-45f5-b416-05721abd2cde", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440015641", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=35", "oauth_nonce"=>"210168334271795", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '90884945-490b-45f5-b416-05721abd2cde'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 90  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0320.25'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 90 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = 'd6bfb578b01e4b4b1ef0e7c6c27a8a3f8c784d3bc67e8dcac0f0f7e67896810a79d30566cf306f67dbed5c5d0fa3f5bb5b57f5f7f5a130ab4d2348549a4f94143a7981165858499bcfec5a0ebb97b79bcb1c2cb4420da3ac2ce748eeaecc67adb5e1790e795a4342f6e8282dc86c30329ad779e2a0eb349ee6b504660a78ee3b', `status` = 'received', `updated_at` = '2015-08-19 20:20:42' WHERE `lti2_tp_registrations`.`id` = 97
  [1m[36m (2.9ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=97&return_url=/lti2_tp/registrations
Completed 302 Found in 553ms (ActiveRecord: 8.0ms)


Started GET "/lti_registration_wips?registration_id=97&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:20:43 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"97", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:20:43', 'Sakai', 97, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0320.25', '2015-08-19 20:20:43')
  [1m[36m (1.9ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (159.1ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (165.7ms)
Completed 200 OK in 332ms (Views: 281.0ms | ActiveRecord: 4.3ms)


Started PATCH "/lti_registration_wips/153" for 127.0.0.1 at 2015-08-19 15:20:45 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0320.25"}, "commit"=>"Update Lti registration wip", "id"=>"153"}
  [1m[35mLtiRegistrationWip Load (1.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 153 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 153 LIMIT 1  [["id", "153"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1[0m  [["id", 97]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0320.25'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b2501d50-28dd-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"90884945-490b-45f5-b416-05721abd2cde\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f24278357be6d816143d48f3716e3284e1b48849a92f3255f02563a69b5194b5f26c14c7d64877ac5fba12235c892312a90e6d27ad8d3bb80bd6c060a7fba8f1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:20:45' WHERE `lti2_tp_registrations`.`id` = 97
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"90884945-490b-45f5-b416-05721abd2cde\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/90884945-490b-45f5-b416-05721abd2cde\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f24278357be6d816143d48f3716e3284e1b48849a92f3255f02563a69b5194b5f26c14c7d64877ac5fba12235c892312a90e6d27ad8d3bb80bd6c060a7fba8f1\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/90884945-490b-45f5-b416-05721abd2cde\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/90884945-490b-45f5-b416-05721abd2cde\",\"tc_half_shared_secret\":\"8faf9d7c88ad99772cc28f020bb20a150aa48064567ff9bebeb1d04f693709ae574d0c6352a8ac01c7152e1abd2bcced1cec7642dea62d843e8541c487700f6a\",\"tool_proxy_guid\":\"90884945-490b-45f5-b416-05721abd2cde\"}', `updated_at` = '2015-08-19 20:20:46' WHERE `lti2_tp_registrations`.`id` = 97[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:20:46' WHERE `lti2_tp_registrations`.`id` = 97
  [1m[36m (12.2ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde&&id=97
Completed 302 Found in 748ms (ActiveRecord: 24.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde&&id=97" for 127.0.0.1 at 2015-08-19 15:20:46 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"90884945-490b-45f5-b416-05721abd2cde", "id"=>"97"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 97 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=35&status=success&tool_guid=90884945-490b-45f5-b416-05721abd2cde
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:28:32 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=36", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"96862ae7-3dea-4e10-9c78-718dcdd7f2be", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be", "reg_key"=>"96862ae7-3dea-4e10-9c78-718dcdd7f2be", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:28:35', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=36', 'LTI-2p0', 'registration', '96862ae7-3dea-4e10-9c78-718dcdd7f2be', 'b1305b29-bf62-4965-86c6-9ddfc03e1918', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '96862ae7-3dea-4e10-9c78-718dcdd7f2be', '2015-08-19 20:28:35')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=98&return_url=/lti2_tp/registrations
Completed 302 Found in 1107ms (ActiveRecord: 18.4ms)


Started GET "/lti_registration_wips?registration_id=98&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:28:36 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"98", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:28:36', 'Sakai', 98, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0328.36', '2015-08-19 20:28:36')[0m
  [1m[35m (0.5ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (173.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (179.7ms)
Completed 200 OK in 441ms (Views: 307.4ms | ActiveRecord: 3.0ms)


Started PATCH "/lti_registration_wips/154" for 127.0.0.1 at 2015-08-19 15:28:44 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0328.36"}, "commit"=>"Update Lti registration wip", "id"=>"154"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 154 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0328.36', `updated_at` = '2015-08-19 20:28:44' WHERE `lti2_tp_registrations`.`id` = 98
  [1m[36m (1.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 154 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0328.36' LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:28:45', 'ETS-0328.36', '2015-08-19 20:28:45')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd00dc310-28de-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"c211b9ae5f6d0d10cc19bcd567d8ee8e4a2db7433113698af44cb4c87b4564817cf30116b3d97c4e384c3245074b65e30c1332b9667df9e2c1018339092bac89\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:28:45' WHERE `lti2_tp_registrations`.`id` = 98[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"tc_half_shared_secret\":\"50f08e2aa791bd32bb93d5d64fb93bf1342cccc540bf95e7c0bc729cea029574aad5e4e0d49b0681f18cae22cc40acc993cf4e4ffedeb8de266e546ad282cc98\",\"tool_proxy_guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\"}', `updated_at` = '2015-08-19 20:28:45' WHERE `lti2_tp_registrations`.`id` = 98
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0328.36' AND `tenants`.`id` != 91) LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `tenants` SET `secret` = '50f08e2aa791bd32bb93d5d64fb93bf1342cccc540bf95e7c0bc729cea029574aad5e4e0d49b0681f18cae22cc40acc993cf4e4ffedeb8de266e546ad282cc98c211b9ae5f6d0d10cc19bcd567d8ee8e4a2db7433113698af44cb4c87b4564817cf30116b3d97c4e384c3245074b65e30c1332b9667df9e2c1018339092bac89', `tenant_key` = '96862ae7-3dea-4e10-9c78-718dcdd7f2be', `updated_at` = '2015-08-19 20:28:45' WHERE `tenants`.`id` = 91
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '50f08e2aa791bd32bb93d5d64fb93bf1342cccc540bf95e7c0bc729cea029574aad5e4e0d49b0681f18cae22cc40acc993cf4e4ffedeb8de266e546ad282cc98c211b9ae5f6d0d10cc19bcd567d8ee8e4a2db7433113698af44cb4c87b4564817cf30116b3d97c4e384c3245074b65e30c1332b9667df9e2c1018339092bac89', `tenant_id` = 91, `updated_at` = '2015-08-19 20:28:45' WHERE `lti2_tp_registrations`.`id` = 98[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be&&id=98
Completed 302 Found in 1003ms (ActiveRecord: 27.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be&&id=98" for 127.0.0.1 at 2015-08-19 15:28:45 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"96862ae7-3dea-4e10-9c78-718dcdd7f2be", "id"=>"98"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=36&status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:29:31 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"X3xsq+b2xaqzLWQMLbzeTF/vp1I=", "oauth_consumer_key"=>"96862ae7-3dea-4e10-9c78-718dcdd7f2be", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016170", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=36", "oauth_nonce"=>"210697425957488", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '96862ae7-3dea-4e10-9c78-718dcdd7f2be'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 91  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0328.36'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 91 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '50f08e2aa791bd32bb93d5d64fb93bf1342cccc540bf95e7c0bc729cea029574aad5e4e0d49b0681f18cae22cc40acc993cf4e4ffedeb8de266e546ad282cc98c211b9ae5f6d0d10cc19bcd567d8ee8e4a2db7433113698af44cb4c87b4564817cf30116b3d97c4e384c3245074b65e30c1332b9667df9e2c1018339092bac89', `status` = 'received', `updated_at` = '2015-08-19 20:29:31' WHERE `lti2_tp_registrations`.`id` = 98[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=98&return_url=/lti2_tp/registrations
Completed 302 Found in 649ms (ActiveRecord: 6.4ms)


Started GET "/lti_registration_wips?registration_id=98&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:29:32 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"98", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:29:32', 'Sakai', 98, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0328.36', '2015-08-19 20:29:32')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (190.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (196.5ms)
Completed 200 OK in 382ms (Views: 321.9ms | ActiveRecord: 3.7ms)


Started PATCH "/lti_registration_wips/155" for 127.0.0.1 at 2015-08-19 15:29:35 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0328.36"}, "commit"=>"Update Lti registration wip", "id"=>"155"}
  [1m[36mLtiRegistrationWip Load (2.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 155 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 155 LIMIT 1[0m  [["id", "155"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1  [["id", 98]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0328.36'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f0884160-28de-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"e944697b622e314f55f61cefc2a8c0fba2632bd5602cb077930a7da30029b5b71b279380a28f8762cb8cd925337a87a807fb742025d8393187a568f64851c65b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:29:39' WHERE `lti2_tp_registrations`.`id` = 98[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"e944697b622e314f55f61cefc2a8c0fba2632bd5602cb077930a7da30029b5b71b279380a28f8762cb8cd925337a87a807fb742025d8393187a568f64851c65b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/96862ae7-3dea-4e10-9c78-718dcdd7f2be\",\"tc_half_shared_secret\":\"01f88e1bc1c0d88a5b7a248836fd399e13f7952a2e1c6bab59979c65a486cc0f91560845a2a68f8e0c5df86071ee24f4d6bdf52bd53d6a6888a934c9385e15da\",\"tool_proxy_guid\":\"96862ae7-3dea-4e10-9c78-718dcdd7f2be\"}', `updated_at` = '2015-08-19 20:29:40' WHERE `lti2_tp_registrations`.`id` = 98
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:29:40' WHERE `lti2_tp_registrations`.`id` = 98[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be&&id=98
Completed 302 Found in 1351ms (ActiveRecord: 47.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be&&id=98" for 127.0.0.1 at 2015-08-19 15:29:40 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"96862ae7-3dea-4e10-9c78-718dcdd7f2be", "id"=>"98"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 98 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=36&status=success&tool_guid=96862ae7-3dea-4e10-9c78-718dcdd7f2be
Completed 302 Found in 18ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:31:47 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=37", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"27021b85-2791-48cf-8cef-e9e7f79c3831", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831", "reg_key"=>"27021b85-2791-48cf-8cef-e9e7f79c3831", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:31:48', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=37', 'LTI-2p0', 'registration', '27021b85-2791-48cf-8cef-e9e7f79c3831', 'e7d4fa5a-43bb-42e2-b2fd-156bbb9057d9', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '27021b85-2791-48cf-8cef-e9e7f79c3831', '2015-08-19 20:31:48')
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=99&return_url=/lti2_tp/registrations
Completed 302 Found in 931ms (ActiveRecord: 8.0ms)


Started GET "/lti_registration_wips?registration_id=99&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:31:49 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"99", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:31:49', 'Sakai', 99, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0331.49', '2015-08-19 20:31:49')
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (160.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (173.5ms)
Completed 200 OK in 341ms (Views: 295.6ms | ActiveRecord: 4.6ms)


Started PATCH "/lti_registration_wips/156" for 127.0.0.1 at 2015-08-19 15:31:52 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0331.49"}, "commit"=>"Update Lti registration wip", "id"=>"156"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 156 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0331.49', `updated_at` = '2015-08-19 20:31:52' WHERE `lti2_tp_registrations`.`id` = 99[0m
  [1m[35m (2.2ms)[0m  COMMIT
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 156 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0331.49' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:31:52', 'ETS-0331.49', '2015-08-19 20:31:52')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '3fcc9750-28df-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"fa5c2c251d5f313d5a2b70047c4ed0cacadff76478561b12adfa43426c68d75457055be5fdb63a7532205eda0a1ef79758922c6e8a31f1e0664e62053ebf49f0\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:31:52' WHERE `lti2_tp_registrations`.`id` = 99
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"tc_half_shared_secret\":\"260102049ea7acc9234833256d63326468b2966b2e27bd0b3c19bdf87183c9c58ed84d222659f8685be5fd899e60a47916506dc0c98e7af5cd34606ec8bbe1eb\",\"tool_proxy_guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\"}', `updated_at` = '2015-08-19 20:31:53' WHERE `lti2_tp_registrations`.`id` = 99[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0331.49' AND `tenants`.`id` != 92) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '260102049ea7acc9234833256d63326468b2966b2e27bd0b3c19bdf87183c9c58ed84d222659f8685be5fd899e60a47916506dc0c98e7af5cd34606ec8bbe1ebfa5c2c251d5f313d5a2b70047c4ed0cacadff76478561b12adfa43426c68d75457055be5fdb63a7532205eda0a1ef79758922c6e8a31f1e0664e62053ebf49f0', `tenant_key` = '27021b85-2791-48cf-8cef-e9e7f79c3831', `updated_at` = '2015-08-19 20:31:53' WHERE `tenants`.`id` = 92[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '260102049ea7acc9234833256d63326468b2966b2e27bd0b3c19bdf87183c9c58ed84d222659f8685be5fd899e60a47916506dc0c98e7af5cd34606ec8bbe1ebfa5c2c251d5f313d5a2b70047c4ed0cacadff76478561b12adfa43426c68d75457055be5fdb63a7532205eda0a1ef79758922c6e8a31f1e0664e62053ebf49f0', `tenant_id` = 92, `updated_at` = '2015-08-19 20:31:53' WHERE `lti2_tp_registrations`.`id` = 99
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831&&id=99
Completed 302 Found in 803ms (ActiveRecord: 19.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831&&id=99" for 127.0.0.1 at 2015-08-19 15:31:53 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"27021b85-2791-48cf-8cef-e9e7f79c3831", "id"=>"99"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=37&status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831
Completed 302 Found in 17ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:32:04 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"ygruwWNKMFQElTnqfMt0xJANwt8=", "oauth_consumer_key"=>"27021b85-2791-48cf-8cef-e9e7f79c3831", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016324", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=37", "oauth_nonce"=>"210851188796900", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '27021b85-2791-48cf-8cef-e9e7f79c3831'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 92  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0331.49'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 92 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '260102049ea7acc9234833256d63326468b2966b2e27bd0b3c19bdf87183c9c58ed84d222659f8685be5fd899e60a47916506dc0c98e7af5cd34606ec8bbe1ebfa5c2c251d5f313d5a2b70047c4ed0cacadff76478561b12adfa43426c68d75457055be5fdb63a7532205eda0a1ef79758922c6e8a31f1e0664e62053ebf49f0', `status` = 'received', `updated_at` = '2015-08-19 20:32:05' WHERE `lti2_tp_registrations`.`id` = 99
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=99&return_url=/lti2_tp/registrations
Completed 302 Found in 603ms (ActiveRecord: 5.9ms)


Started GET "/lti_registration_wips?registration_id=99&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:32:05 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"99", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:32:05', 'Sakai', 99, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0331.49', '2015-08-19 20:32:05')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  Rendered lti_registration_wips/_form.html.haml (168.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (173.9ms)
Completed 200 OK in 327ms (Views: 287.9ms | ActiveRecord: 2.9ms)


Started PATCH "/lti_registration_wips/157" for 127.0.0.1 at 2015-08-19 15:32:08 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0331.49"}, "commit"=>"Update Lti registration wip", "id"=>"157"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 157 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 157 LIMIT 1  [["id", "157"]]
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1[0m  [["id", 99]]
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0331.49'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '4973c3d0-28df-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b76721b3600c246173e5e867c0e709516b9405030cfb95359dd24de27d25aca14fdd3a7990a46c4ecfcdd6871210b4d50fd7a094716ffb6cd32b896a62f6d777\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:32:08' WHERE `lti2_tp_registrations`.`id` = 99
  [1m[36m (2.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b76721b3600c246173e5e867c0e709516b9405030cfb95359dd24de27d25aca14fdd3a7990a46c4ecfcdd6871210b4d50fd7a094716ffb6cd32b896a62f6d777\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/27021b85-2791-48cf-8cef-e9e7f79c3831\",\"tc_half_shared_secret\":\"c302dd7594a11214358e385c7178e6258ca3e0976ed7a9259e9df0a5ea46380f07a7d7b37f22bccb7e946f6354b6a697c0355a2035b286c9c6740d55122330b0\",\"tool_proxy_guid\":\"27021b85-2791-48cf-8cef-e9e7f79c3831\"}', `updated_at` = '2015-08-19 20:32:09' WHERE `lti2_tp_registrations`.`id` = 99[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:32:09' WHERE `lti2_tp_registrations`.`id` = 99
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831&&id=99
Completed 302 Found in 783ms (ActiveRecord: 12.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831&&id=99" for 127.0.0.1 at 2015-08-19 15:32:09 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"27021b85-2791-48cf-8cef-e9e7f79c3831", "id"=>"99"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 99 LIMIT 1
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=37&status=success&tool_guid=27021b85-2791-48cf-8cef-e9e7f79c3831
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:33:44 -0500
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "lti_version"=>"LTI-2p0", "tool_proxy_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "lti_message_type"=>"ToolProxyRegistrationRequest", "reg_password"=>"[FILTERED]", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "reg_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`) VALUES ('2015-08-19 20:33:45', 'http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38', 'LTI-2p0', 'registration', '165d1c63-2d91-4981-a483-56500487a0d0', 'bff528ed-3b18-4c4f-a175-02a04aeb7bbc', 'received', 'http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0', 'ETS', 'ETS', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"tcp\":\"http://sakai.ngrok.com/imsblis/lti2/#\"}],\"@type\":\"ToolConsumerProfile\",\"lti_version\":\"LTI-2p0\",\"guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"product_instance\":{\"guid\":\"sakai.school.edu\",\"product_info\":{\"product_name\":{\"default_value\":\"Sakai\",\"key\":\"product.name\"},\"product_version\":\"10.0\",\"description\":{\"default_value\":\"Sakai 10.0\",\"key\":\"product.vendor.description\"},\"product_family\":{\"code\":\"sakai\",\"vendor\":{\"code\":\"sakai\",\"vendor_name\":{\"default_value\":\"Sakai Project\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"Sakai is an Apereo Project.\",\"key\":\"product.vendor.description\"},\"website\":\"http://www.sakaiproject.org\",\"contact\":{\"email\":\"info@sakaiproject.org\"}}}},\"support\":{\"email\":\"sakai-support@school.edu\"},\"service_owner\":{\"@id\":\"https://sakai.school.edu\",\"service_owner_name\":{\"default_value\":\"ETS\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"The Ed. Tech Services Division.\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"ets-support@sakai.school.edu\"}},\"service_provider\":{\"@id\":\"https://www.asca.edu/\",\"service_provider_name\":{\"default_value\":\"ASCA, Inc.\",\"key\":\"product.name\"},\"description\":{\"default_value\":\"A Sakai Commercial Affiliate\",\"key\":\"product.vendor.description\"},\"support\":{\"email\":\"sales@asca.com\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"User.id\",\"Person.sourcedId\",\"ResourceLink.id\",\"ResourceLink.title\",\"Context.id\",\"Context.type\",\"Context.label\",\"Context.title\",\"CourseSection.sourcedId\",\"CourseSection.label\",\"CourseSection.longDescription\",\"Membership.role\",\"OAuth.splitSecret\",\"OAuth.hmac-sha256\",\"ContentItem.LtiLink\",\"ContentItem.FileItem\",\"Person.email.primary\",\"Person.sourcedId\",\"Person.name.full\",\"Person.name.given\",\"Person.name.family\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxy.collection\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:Result.item\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Result/{lis_result_sourcedid}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LTI_1_1_ResultService\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.ims.lti.v1.outcome+xml\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiOutcomeForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.outcome+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiRosterForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.roster+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiSettingsForm\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.settings+form\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:LtiLinkSettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/LtiLink/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:ToolProxySettings\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxyBinding/{resource_link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"tcp:SakaiLORIXml\",\"endpoint\":\"http://sakai.ngrok.com/imsblis/service/\",\"format\":[\"application/vnd.sakai.lti.v1.lori+xml\"],\"action\":[\"POST\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '165d1c63-2d91-4981-a483-56500487a0d0', '2015-08-19 20:33:45')[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 622ms (ActiveRecord: 2.9ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:33:45 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (3.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:33:45', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:33:45')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (158.2ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (163.9ms)
Completed 200 OK in 329ms (Views: 280.3ms | ActiveRecord: 5.8ms)


Started PATCH "/lti_registration_wips/158" for 127.0.0.1 at 2015-08-19 15:33:49 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"158"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 158 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tenant_name` = 'ETS-0333.45', `updated_at` = '2015-08-19 20:33:49' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 158 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ETS-0333.45' LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:33:49', 'ETS-0333.45', '2015-08-19 20:33:49')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '857a49b0-28df-0133-7ce1-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"723885189aa3340e3e325e5532b1cb809b874f8d4d4777ea45d95a1df4170fb87e2131e8c63a39a1d1a37ac8cb2e8e5f20246aec6000b842e978147dc3b10f49\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:33:49' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"8b736b0d45391c23c49903f72816d52d762073a55b8c3417097589a81afd8cfc4ec4072119d96b0a6059acdf1d0fbccaedbf17017efee1073ccae93e75c71048\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:33:50' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0333.45' AND `tenants`.`id` != 93) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = '8b736b0d45391c23c49903f72816d52d762073a55b8c3417097589a81afd8cfc4ec4072119d96b0a6059acdf1d0fbccaedbf17017efee1073ccae93e75c71048723885189aa3340e3e325e5532b1cb809b874f8d4d4777ea45d95a1df4170fb87e2131e8c63a39a1d1a37ac8cb2e8e5f20246aec6000b842e978147dc3b10f49', `tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0', `updated_at` = '2015-08-19 20:33:50' WHERE `tenants`.`id` = 93
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '8b736b0d45391c23c49903f72816d52d762073a55b8c3417097589a81afd8cfc4ec4072119d96b0a6059acdf1d0fbccaedbf17017efee1073ccae93e75c71048723885189aa3340e3e325e5532b1cb809b874f8d4d4777ea45d95a1df4170fb87e2131e8c63a39a1d1a37ac8cb2e8e5f20246aec6000b842e978147dc3b10f49', `tenant_id` = 93, `updated_at` = '2015-08-19 20:33:50' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 848ms (ActiveRecord: 19.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:33:50 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 18ms (ActiveRecord: 1.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:34:59 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"8UEg6zBCToic1AIp0fAIHVto0xI=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016498", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211025115896608", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '8b736b0d45391c23c49903f72816d52d762073a55b8c3417097589a81afd8cfc4ec4072119d96b0a6059acdf1d0fbccaedbf17017efee1073ccae93e75c71048723885189aa3340e3e325e5532b1cb809b874f8d4d4777ea45d95a1df4170fb87e2131e8c63a39a1d1a37ac8cb2e8e5f20246aec6000b842e978147dc3b10f49', `status` = 'received', `updated_at` = '2015-08-19 20:35:00' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.9ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 910ms (ActiveRecord: 7.5ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:35:00 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:35:00', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:35:00')[0m
  [1m[35m (2.1ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (149.9ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (155.3ms)
Completed 200 OK in 386ms (Views: 340.5ms | ActiveRecord: 4.4ms)


Started PATCH "/lti_registration_wips/159" for 127.0.0.1 at 2015-08-19 15:35:03 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"159"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 159 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 159 LIMIT 1[0m  [["id", "159"]]
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b193c860-28df-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"0371f060b29e3846be5ebf811c4b05442abcae3024d19ed57687cf6be4b1616e26e193a4265bd51074a6d6ae90fdcfccbb63ebcbcb5e2f505cb05cb59c956915\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:35:03' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.4ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"0371f060b29e3846be5ebf811c4b05442abcae3024d19ed57687cf6be4b1616e26e193a4265bd51074a6d6ae90fdcfccbb63ebcbcb5e2f505cb05cb59c956915\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"f8329fbe5d60b30ef0926922925366c02cd6148a0ebf2e693c6a36cb8c4010149f5f1321393bab0798c9c83fa74b0f5b08b6a17a0bed1a72ecd66073c87b6ef5\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:35:03' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:35:04' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.5ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 720ms (ActiveRecord: 15.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:35:04 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 17ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:38:45 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"gA3z1xBLRh2KlvNvUVFLMDTc4uY=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016724", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211251244244431", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-08-19 20:38:46' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (2.2ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 777ms (ActiveRecord: 7.3ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:38:46 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:38:46', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:38:46')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (218.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (224.1ms)
Completed 200 OK in 397ms (Views: 347.1ms | ActiveRecord: 3.3ms)


Started PATCH "/lti_registration_wips/160" for 127.0.0.1 at 2015-08-19 15:38:52 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"160"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 160 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 160 LIMIT 1[0m  [["id", "160"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '3a1423d0-28e0-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f42f665a68b470e17f8a49d19ab4cc6ae075bc3b951bbeba99f6edbbad18f45b4fe6b0ecb87363a73a346270d38a7cc85659f2daceed6f5396ff3e6e7fefa42b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:38:52' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (3.2ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"f42f665a68b470e17f8a49d19ab4cc6ae075bc3b951bbeba99f6edbbad18f45b4fe6b0ecb87363a73a346270d38a7cc85659f2daceed6f5396ff3e6e7fefa42b\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"0bfed83875100c4cb3a1aa2b0e515b36eea1c678ac236cb6a1092f3801354d0092c937cc5cb7556e15171f58e66fed9adc48a55f90e3d9683848aa30a97e4379\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:38:54' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:38:54' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 1908ms (ActiveRecord: 13.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:38:54 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:41:00 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"XIqdf8etj+AN7VqU6xXAe2F5oxQ=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016859", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211386364660730", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-08-19 20:41:01' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.2ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 1065ms (ActiveRecord: 6.9ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:41:01 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (3.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:41:01', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:41:01')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (152.8ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (158.2ms)
Completed 200 OK in 324ms (Views: 277.3ms | ActiveRecord: 6.1ms)


Started PATCH "/lti_registration_wips/161" for 127.0.0.1 at 2015-08-19 15:41:05 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"161"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 161 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 161 LIMIT 1[0m  [["id", "161"]]
  [1m[35mCACHE (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '89443260-28e0-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"6bc84d98de918982e2d5659b047f320ee4ded7ed86cb6fb8e530c2fe45afe8aa59d037fa35bfbff2f0dd588a5d2ecf139044e974113052a881781155d42ad64d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:41:05' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"6bc84d98de918982e2d5659b047f320ee4ded7ed86cb6fb8e530c2fe45afe8aa59d037fa35bfbff2f0dd588a5d2ecf139044e974113052a881781155d42ad64d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"fc345acd8c6cef02ed4681c2084333fe91d0768c9c9e99b7104002b4ecc897c681b8556e04020dd31f78771a35498460469740ad32e6645c12fe4cd82a94efc7\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:41:05' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:41:05' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 574ms (ActiveRecord: 12.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:41:06 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/165d1c63-2d91-4981-a483-56500487a0d0?correlation=89443260-28e0-0133-7ce1-20c9d07c6451&oauth_consumer_key=165d1c63-2d91-4981-a483-56500487a0d0&oauth_signature_method=HMAC-SHA1&oauth_version=1.0&oauth_timestamp=1440016872&oauth_nonce=388698bd-e354-48fe-b434-2ea3fa88ade0&oauth_signature=hDMCrZaFCfbgSmYXz6rXeltdsGw%3D" for 127.0.0.1 at 2015-08-19 15:41:12 -0500
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"89443260-28e0-0133-7ce1-20c9d07c6451", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_signature_method"=>"HMAC-SHA1", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440016872", "oauth_nonce"=>"388698bd-e354-48fe-b434-2ea3fa88ade0", "oauth_signature"=>"hDMCrZaFCfbgSmYXz6rXeltdsGw=", "id"=>"165d1c63-2d91-4981-a483-56500487a0d0"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0333.45' AND `tenants`.`id` != 93) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = 'fc345acd8c6cef02ed4681c2084333fe91d0768c9c9e99b7104002b4ecc897c681b8556e04020dd31f78771a35498460469740ad32e6645c12fe4cd82a94efc76bc84d98de918982e2d5659b047f320ee4ded7ed86cb6fb8e530c2fe45afe8aa59d037fa35bfbff2f0dd588a5d2ecf139044e974113052a881781155d42ad64d', `updated_at` = '2015-08-19 20:41:19' WHERE `tenants`.`id` = 93[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `final_secret` = 'fc345acd8c6cef02ed4681c2084333fe91d0768c9c9e99b7104002b4ecc897c681b8556e04020dd31f78771a35498460469740ad32e6645c12fe4cd82a94efc76bc84d98de918982e2d5659b047f320ee4ded7ed86cb6fb8e530c2fe45afe8aa59d037fa35bfbff2f0dd588a5d2ecf139044e974113052a881781155d42ad64d', `proposed_tool_proxy_json` = NULL, `updated_at` = '2015-08-19 20:41:19' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
"reregistration complete for 165d1c63-2d91-4981-a483-56500487a0d0"
  Rendered text template (0.3ms)
Completed 200 OK in 7336ms (Views: 4.6ms | ActiveRecord: 9.5ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:43:53 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"EPW+LqFmhg57s89Rv/zNcZRstNY=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440017032", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211559211346940", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `reg_password` = 'fc345acd8c6cef02ed4681c2084333fe91d0768c9c9e99b7104002b4ecc897c681b8556e04020dd31f78771a35498460469740ad32e6645c12fe4cd82a94efc76bc84d98de918982e2d5659b047f320ee4ded7ed86cb6fb8e530c2fe45afe8aa59d037fa35bfbff2f0dd588a5d2ecf139044e974113052a881781155d42ad64d', `status` = 'received', `updated_at` = '2015-08-19 20:43:54' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 992ms (ActiveRecord: 6.4ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:43:54 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:43:54', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:43:54')[0m
  [1m[35m (1.9ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (162.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (168.4ms)
Completed 200 OK in 390ms (Views: 280.8ms | ActiveRecord: 4.0ms)


Started PATCH "/lti_registration_wips/162" for 127.0.0.1 at 2015-08-19 15:43:57 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"162"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 162 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mCACHE (0.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 162 LIMIT 1[0m  [["id", "162"]]
  [1m[35mCACHE (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f0428dd0-28e0-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b6215f41d90dc3725fe2014d65488f3a6d79bc95923dd38a0979237453128f02566bb889922a58d22ac8efa92261e2b92f9d9ee46f21ad7b0cf06b97b319c331\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:43:58' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (2.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"b6215f41d90dc3725fe2014d65488f3a6d79bc95923dd38a0979237453128f02566bb889922a58d22ac8efa92261e2b92f9d9ee46f21ad7b0cf06b97b319c331\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"193ea84da2de0b167bc484af0fed9b3c46054bb90b3c42be82d8ce642dafe98207480fb28f6760cc85e64ba2c62747918c70e38ed05e06204dd41718822ee4cf\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:43:58' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:43:58' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 793ms (ActiveRecord: 12.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:43:59 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:44:51 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"dZDn6mdvfPXwPxBsIOQ/7nYsuXM=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440017091", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211617891567212", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-08-19 20:44:53' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.3ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 1502ms (ActiveRecord: 6.6ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:44:53 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (3.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:44:53', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:44:53')[0m
  [1m[35m (0.7ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (144.4ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (149.1ms)
Completed 200 OK in 307ms (Views: 257.6ms | ActiveRecord: 6.1ms)


Started PATCH "/lti_registration_wips/163" for 127.0.0.1 at 2015-08-19 15:44:56 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"163"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 163 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 163 LIMIT 1[0m  [["id", "163"]]
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '130cf730-28e1-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"2dc1909752d2fa466406e76144eb6746fdae1bf3491c32da710aa6de599a5d1fb6dc143913946f605ba4e24d456e8aa43c89bf31cac5dda37ce79c7cb6fe3952\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:44:56' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"2dc1909752d2fa466406e76144eb6746fdae1bf3491c32da710aa6de599a5d1fb6dc143913946f605ba4e24d456e8aa43c89bf31cac5dda37ce79c7cb6fe3952\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"19c1dfc7044c86a58c7b95c0307f678f489cc5e263b3b78918bb58bc2c0300a41b57ded5249d67108455e667aae28d06478195a7eda9429d5d6000fdfe4582fe\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:44:57' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:44:57' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.2ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 679ms (ActiveRecord: 11.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:44:57 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 15ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:46:52 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"lFbFGdUB0ssGXRwM+rlJl7nbRdQ=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440017211", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"211738587275621", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-08-19 20:46:53' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.6ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 954ms (ActiveRecord: 7.0ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:46:53 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:46:53', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:46:53')[0m
  [1m[35m (0.6ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (147.6ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (153.2ms)
Completed 200 OK in 363ms (Views: 322.0ms | ActiveRecord: 2.9ms)


Started PATCH "/lti_registration_wips/164" for 127.0.0.1 at 2015-08-19 15:46:59 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"164"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 164 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mCACHE (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 164 LIMIT 1[0m  [["id", "164"]]
  [1m[35mCACHE (0.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '5c3019c0-28e1-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"12d4b96ce226fbf99d21a3b9a4e4ab1f50bf2f44aead9990473edb33b76db34e22659b0123bbc7826db39eafe94107bce42c2f7a82cbb32a8741bed5024a9f1c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:46:59' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (2.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"12d4b96ce226fbf99d21a3b9a4e4ab1f50bf2f44aead9990473edb33b76db34e22659b0123bbc7826db39eafe94107bce42c2f7a82cbb32a8741bed5024a9f1c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"8d38dfe41ee64c7b96f6e6f43dd8625e57caa968cc867244191e5a0727d6eca3efc249cf6d7ca9a2b2ba34e960bd5993a70f8fbb13355ea4e389bff6df307651\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:46:59' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:46:59' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 658ms (ActiveRecord: 13.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:46:59 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 16ms (ActiveRecord: 0.6ms)


Started GET "/lti2_tp/tool_proxies/165d1c63-2d91-4981-a483-56500487a0d0?correlation=5c3019c0-28e1-0133-7ce1-20c9d07c6451&oauth_consumer_key=165d1c63-2d91-4981-a483-56500487a0d0&oauth_signature_method=HMAC-SHA1&oauth_version=1.0&oauth_timestamp=1440017241&oauth_nonce=19b3b8ab-2c7f-4551-87dd-652974049096&oauth_signature=mRNXawCwBUWgDnKQ6jK13cNsh9Y%3D" for 127.0.0.1 at 2015-08-19 15:47:22 -0500

ActionController::RoutingError (No route matches [GET] "/lti2_tp/tool_proxies/165d1c63-2d91-4981-a483-56500487a0d0"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (8.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (91.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (25.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (17.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (535.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-08-19 15:53:22 -0500
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"lti_version"=>"LTI-2p0", "oauth_signature"=>"u3jvmyTifIvs8vq5q1LPR68+ckc=", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440017601", "oauth_signature_method"=>"HMAC-SHA1", "launch_presentation_return_url"=>"http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38", "oauth_nonce"=>"212127839421048", "oauth_callback"=>"about:blank", "lti_message_type"=>"ToolProxyReregistrationRequest", "tc_profile_url"=>"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0", "ext_basiclti_submit"=>"Press to continue to external tool."}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.1ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (3.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `updated_at` = '2015-08-19 20:53:23' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.6ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations
Completed 302 Found in 1247ms (ActiveRecord: 12.0ms)


Started GET "/lti_registration_wips?registration_id=100&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-08-19 15:53:23 -0500
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"100", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-08-19 20:53:23', 'Sakai', 100, '/lti2_tp/registrations', 'sakai-support@school.edu', 'ETS-0333.45', '2015-08-19 20:53:23')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  Rendered lti_registration_wips/_form.html.haml (467.0ms)
  Rendered lti_registration_wips/index.html.haml within layouts/application (476.6ms)
Completed 200 OK in 868ms (Views: 785.7ms | ActiveRecord: 4.9ms)


Started PATCH "/lti_registration_wips/165" for 127.0.0.1 at 2015-08-19 15:53:27 -0500
Processing by LtiRegistrationWipsController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"b5pEds8ao9Yvh5eYzVV41BcFvtDoJoSCOA8GgtiQODY=", "lti_registration_wip"=>{"support_email"=>"sakai-support@school.edu", "product_name"=>"Sakai", "tenant_name"=>"ETS-0333.45"}, "commit"=>"Update Lti registration wip", "id"=>"165"}
  [1m[36mLtiRegistrationWip Load (1.2ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 165 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mCACHE (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 165 LIMIT 1[0m  [["id", "165"]]
  [1m[35mCACHE (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1  [["id", 100]]
  [1m[36mTenant Load (1.4ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'ETS-0333.45'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '43ad7cf0-28e2-0133-7ce1-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"c0b7be2b15d5165784493671c7a7af75b2601e2592e302dec112ab3cd647ec54f490f9f25cb18e359b3e128edfcfcdaf3055a38532dea94c102d6e57fcd06803\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `updated_at` = '2015-08-19 20:53:27' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://sakai.ngrok.com/imsblis/lti2/tc_profile/165d1c63-2d91-4981-a483-56500487a0d0\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"https://5540a269.ngrok.com\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"https://5540a269.ngrok.com/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"Fabericious reflowable ePub3 Textbook\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"info@fabericious.com\"},\"description\":{\"default_value\":\"Fabericious is a leading provider of interactive tools for education\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Fab\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{https://5540a269.ngrok.com}\"}},\"product_name\":{\"default_value\":\"LTI2 BookTools\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Settings service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"name\":\"tool_proxy_custom_url\",\"variable\":\"ToolProxy.custom.url\"},{\"name\":\"tool_proxy_binding_custom_url\",\"variable\":\"ToolProxyBinding.custom.url\"},{\"name\":\"lti_link_custom_url\",\"variable\":\"LtiLink.custom.url\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\"],\"path\":\"/settings\"}],\"resource_name\":{\"default_value\":\"Settings\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echoes\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"https://5540a269.ngrok.com/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"https://5540a269.ngrok.com/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"tp_half_shared_secret\":\"c0b7be2b15d5165784493671c7a7af75b2601e2592e302dec112ab3cd647ec54f490f9f25cb18e359b3e128edfcfcdaf3055a38532dea94c102d6e57fcd06803\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LTI_1_1_ResultService\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiOutcomeForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiRosterForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiSettingsForm\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"tcp:SakaiLORIXml\",\"action\":[\"POST\"]}]}}', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@id\":\"http://sakai.ngrok.com/imsblis/lti2/tc_registration/165d1c63-2d91-4981-a483-56500487a0d0\",\"@type\":\"ToolProxy\",\"custom_url\":\"http://sakai.ngrok.com/imsblis/lti2/Settings/ToolProxy/165d1c63-2d91-4981-a483-56500487a0d0\",\"tc_half_shared_secret\":\"3269e31ea1209e4496dbe32d6f6386852eff1abda518e83c11f331e48e550aec3137b7024dbee96c86b1c87b43604b4fb13ccdda13a4bc6dd429e66d4877a504\",\"tool_proxy_guid\":\"165d1c63-2d91-4981-a483-56500487a0d0\"}', `updated_at` = '2015-08-19 20:53:28' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-08-19 20:53:28' WHERE `lti2_tp_registrations`.`id` = 100[0m
  [1m[35m (1.8ms)[0m  COMMIT
Redirected to https://5540a269.ngrok.com/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100
Completed 302 Found in 798ms (ActiveRecord: 16.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0&&id=100" for 127.0.0.1 at 2015-08-19 15:53:28 -0500
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"165d1c63-2d91-4981-a483-56500487a0d0", "id"=>"100"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 100 LIMIT 1[0m
Redirected to http://sakai.ngrok.com/portal/tool/!admin-1235?panel=PostRegister&id=38&status=success&tool_guid=165d1c63-2d91-4981-a483-56500487a0d0
Completed 302 Found in 20ms (ActiveRecord: 1.0ms)


Started PUT "/lti2_tp/tool_proxies/165d1c63-2d91-4981-a483-56500487a0d0?correlation=43ad7cf0-28e2-0133-7ce1-20c9d07c6451&oauth_consumer_key=165d1c63-2d91-4981-a483-56500487a0d0&oauth_signature_method=HMAC-SHA1&oauth_version=1.0&oauth_timestamp=1440017639&oauth_nonce=b8d64b30-8613-41ed-9ee8-91df3c8ebf38&oauth_signature=clZeGu3vJg5QFBi7gQWAvfFQgzw%3D" for 127.0.0.1 at 2015-08-19 15:54:00 -0500
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"43ad7cf0-28e2-0133-7ce1-20c9d07c6451", "oauth_consumer_key"=>"165d1c63-2d91-4981-a483-56500487a0d0", "oauth_signature_method"=>"HMAC-SHA1", "oauth_version"=>"1.0", "oauth_timestamp"=>"1440017639", "oauth_nonce"=>"b8d64b30-8613-41ed-9ee8-91df3c8ebf38", "oauth_signature"=>"clZeGu3vJg5QFBi7gQWAvfFQgzw=", "id"=>"165d1c63-2d91-4981-a483-56500487a0d0"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '165d1c63-2d91-4981-a483-56500487a0d0'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (3.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'ETS-0333.45'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 93  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 93 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (2.5ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ETS-0333.45' AND `tenants`.`id` != 93) LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `tenants` SET `secret` = '3269e31ea1209e4496dbe32d6f6386852eff1abda518e83c11f331e48e550aec3137b7024dbee96c86b1c87b43604b4fb13ccdda13a4bc6dd429e66d4877a504c0b7be2b15d5165784493671c7a7af75b2601e2592e302dec112ab3cd647ec54f490f9f25cb18e359b3e128edfcfcdaf3055a38532dea94c102d6e57fcd06803', `updated_at` = '2015-08-19 20:54:00' WHERE `tenants`.`id` = 93[0m
  [1m[35m (11.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = NULL, `final_secret` = '3269e31ea1209e4496dbe32d6f6386852eff1abda518e83c11f331e48e550aec3137b7024dbee96c86b1c87b43604b4fb13ccdda13a4bc6dd429e66d4877a504c0b7be2b15d5165784493671c7a7af75b2601e2592e302dec112ab3cd647ec54f490f9f25cb18e359b3e128edfcfcdaf3055a38532dea94c102d6e57fcd06803', `proposed_tool_proxy_json` = NULL, `updated_at` = '2015-08-19 20:54:00' WHERE `lti2_tp_registrations`.`id` = 100
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
"reregistration complete for 165d1c63-2d91-4981-a483-56500487a0d0"
  Rendered text template (0.3ms)
Completed 200 OK in 236ms (Views: 4.8ms | ActiveRecord: 24.4ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Tool Load (0.4ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.4ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[36mLti2Tp::Registry Load (0.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Tool Load (0.2ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[36mLti2Tp::Registry Load (0.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.9ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.3ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-19 18:40:04 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"8429404791439", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442713204", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"9VyJxS0vzzvLHrd78xbj+NDbyEA="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 41269135ms

NoMethodError - undefined method `tc_profile_url=' for nil:NilClass:
  /Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/controllers/lti2_tp/registrations_controller.rb:114:in `reregister'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:35:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'

  [1m[36mLti2Tp::Registry Load (2.0ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.9ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:09:39 -0700
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bf330760-41c6-0133-036a-20c9d07c6451", "reg_key"=>"bf32f920-41c6-0133-036a-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (1.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-20 13:09:40', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'bf32f920-41c6-0133-036a-20c9d07c6451', '0b6a23247a14693064e9b5306224fc05', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bf330760-41c6-0133-036a-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"bf330760-41c6-0133-036a-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-20 13:09:40', '2')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations
Completed 302 Found in 523ms (ActiveRecord: 17.2ms)


Started GET "/lti_registration_wips?registration_id=121&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:09:40 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"121", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 121 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.5ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'bf32f920-41c6-0133-036a-20c9d07c6451', `updated_at` = '2015-09-20 13:09:41' WHERE `lti2_tp_registrations`.`id` = 121
  [1m[36m (2.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:09:41', 'Elan/LuMoS', 121, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'bf32f920-41c6-0133-036a-20c9d07c6451', '2015-09-20 13:09:41')[0m
  [1m[35m (1.7ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=121&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bf330760-41c6-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/122&consumer_key=bf32f920-41c6-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=121&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bf330760-41c6-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/122&consumer_key=bf32f920-41c6-0133-036a-20c9d07c6451
Completed 302 Found in 264ms (ActiveRecord: 14.7ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:11:45 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"5094276123560", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442754705", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"9kvKkI8MqlABkpw6JqCa1fW0tj4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 38 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '08d9b73ac89bfaa029759c4094646d04', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-20 13:12:19' WHERE `lti2_tp_registrations`.`id` = 120[0m
  [1m[35m (2.1ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations
Completed 302 Found in 33727ms (ActiveRecord: 30.2ms)


Started GET "/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:12:19 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"120", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 120 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:12:19', 'Elan/LuMoS', 120, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1fb37ba0-4105-0133-036a-20c9d07c6451', '2015-09-20 13:12:19')[0m
  [1m[35m (0.6ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/123&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/123&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Completed 302 Found in 87ms (ActiveRecord: 4.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:14:48 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"8742144028942", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442754888", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"tZ6quYY8o54O3ehBShyiRDUQwtE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (1.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 38 LIMIT 1
  [1m[36mLti2Tp::Tool Load (1.1ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations
Completed 302 Found in 313ms (ActiveRecord: 6.3ms)


Started GET "/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:14:49 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"120", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 120 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:14:49', 'Elan/LuMoS', 120, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1fb37ba0-4105-0133-036a-20c9d07c6451', '2015-09-20 13:14:49')
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/124&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/124&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Completed 302 Found in 69ms (ActiveRecord: 4.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:44:16 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"8742144028942", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442754888", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"tZ6quYY8o54O3ehBShyiRDUQwtE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (2.4ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Timestamp expired
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 116ms (ActiveRecord: 3.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:44:20 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"9007735979054", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442756660", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"x4/xmDzVKp6adOyqfDAgAU8Eo1Y="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (2.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 38 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations
Completed 302 Found in 652ms (ActiveRecord: 8.4ms)


Started GET "/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:44:21 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"120", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 120 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:44:21', 'Elan/LuMoS', 120, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1fb37ba0-4105-0133-036a-20c9d07c6451', '2015-09-20 13:44:21')[0m
  [1m[35m (1.9ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/125&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/125&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Completed 302 Found in 61ms (ActiveRecord: 5.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:47:07 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"2104051247240", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442756826", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"xKWgI4De7OaDePzcWyqsWjClg/8="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 38 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.9ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations
Completed 302 Found in 362ms (ActiveRecord: 5.3ms)


Started GET "/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:47:07 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"120", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 120 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:47:07', 'Elan/LuMoS', 120, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1fb37ba0-4105-0133-036a-20c9d07c6451', '2015-09-20 13:47:07')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/126&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/126&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Completed 302 Found in 68ms (ActiveRecord: 3.2ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:47:40 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"8742144028942", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442754888", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"tZ6quYY8o54O3ehBShyiRDUQwtE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (2.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
Timestamp expired
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 116ms (ActiveRecord: 3.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 06:47:43 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1fb37ba0-4105-0133-036a-20c9d07c6451", "oauth_nonce"=>"5074979933517", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442756862", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"B2Zv9D+/hY4lzBXqkBhF0UfIDlg="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 38  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1fb37ba0-4105-0133-036a-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (1.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 38 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations
Completed 302 Found in 332ms (ActiveRecord: 5.2ms)


Started GET "/lti_registration_wips?registration_id=120&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 06:47:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"120", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 120 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 13:47:43', 'Elan/LuMoS', 120, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1fb37ba0-4105-0133-036a-20c9d07c6451', '2015-09-20 13:47:43')[0m
  [1m[35m (1.0ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/127&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=120&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1fb382c0-4105-0133-036a-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/127&consumer_key=1fb37ba0-4105-0133-036a-20c9d07c6451
Completed 302 Found in 58ms (ActiveRecord: 3.6ms)
  [1m[36mLti2Tp::Registry Load (0.9ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 15:37:24 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"022d3380-41d0-0133-036c-20c9d07c6451", "oauth_nonce"=>"8241696586382", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442788644", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"2urFe3aKnVqrRBfnnWyTjHtNO8c="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '022d3380-41d0-0133-036c-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '022d3380-41d0-0133-036c-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 40 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (2.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-20 22:37:26' WHERE `lti2_tp_registrations`.`id` = 128
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=128&return_url=/lti2_tp/registrations
Completed 302 Found in 802ms (ActiveRecord: 62.9ms)


Started GET "/lti_registration_wips?registration_id=128&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 15:37:26 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"128", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 128 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (6.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.8ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 22:37:26', 'Elan/LuMoS', 128, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '022d3380-41d0-0133-036c-20c9d07c6451', '2015-09-20 22:37:26')
  [1m[36m (10.6ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=128&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/148&consumer_key=022d3380-41d0-0133-036c-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=128&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/148&consumer_key=022d3380-41d0-0133-036c-20c9d07c6451
Completed 302 Found in 330ms (ActiveRecord: 26.0ms)


Started GET "/lti_registration_wips/135" for 127.0.0.1 at 2015-09-20 15:37:28 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"135"}
  [1m[35mLtiRegistrationWip Load (0.5ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 135 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 128 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-20 22:37:40' WHERE `lti2_tp_registrations`.`id` = 128[0m
  [1m[35m (2.8ms)[0m  COMMIT
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '27fb55e0-4216-0133-036e-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"022d3380-41d0-0133-036c-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"58a060d9107d195a368ebdb86410f7df\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-20 22:37:53' WHERE `lti2_tp_registrations`.`id` = 128[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-20 22:37:56' WHERE `lti2_tp_registrations`.`id` = 128
  [1m[36m (1.9ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=128
Completed 302 Found in 1101087ms (ActiveRecord: 11.9ms)


Started GET "/lti_registration_wips/135" for 127.0.0.1 at 2015-09-20 15:56:01 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"135"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 135 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 128 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '18a811b0-4219-0133-036e-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"022d3380-41d0-0133-036c-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"f8f418b41c0aced036a9b3a8bba49964\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-20 22:58:56' WHERE `lti2_tp_registrations`.`id` = 128
  [1m[36m (14.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=128
Completed 302 Found in 175229ms (ActiveRecord: 19.0ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=128" for 127.0.0.1 at 2015-09-20 15:58:57 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"128"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 128 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 76ms (ActiveRecord: 3.7ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-20 16:00:10 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"022d3380-41d0-0133-036c-20c9d07c6451", "oauth_nonce"=>"1536121351106", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442790010", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"AWqnTpXHO0w9M49mlygmBft9XTM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '022d3380-41d0-0133-036c-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 40  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '022d3380-41d0-0133-036c-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (1.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 40 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_consumer_profile_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"022d3740-41d0-0133-036c-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-20 23:00:12' WHERE `lti2_tp_registrations`.`id` = 128
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=128&return_url=/lti2_tp/registrations
Completed 302 Found in 918ms (ActiveRecord: 56.1ms)


Started GET "/lti_registration_wips?registration_id=128&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-20 16:00:12 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"128", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 128 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-20 23:00:12', 'Elan/LuMoS', 128, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '022d3380-41d0-0133-036c-20c9d07c6451', '2015-09-20 23:00:12')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=128&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/149&consumer_key=022d3380-41d0-0133-036c-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=128&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/022d3740-41d0-0133-036c-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/149&consumer_key=022d3380-41d0-0133-036c-20c9d07c6451
Completed 302 Found in 223ms (ActiveRecord: 9.7ms)
  [1m[36mLti2Tp::Registry Load (0.8ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.8ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 13:46:12 -0700
  [1m[36mActiveRecord::SchemaMigration Load (12.0ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"3525676088755", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442868372", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"vgN8rdR0DmdiDXdINiwdccEy1yY="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.6ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 20:46:13' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 824ms (ActiveRecord: 46.2ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 13:46:14 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (1.2ms)[0m  [1mBEGIN[0m
  [1m[35m (3.0ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 20:46:14', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 20:46:14')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/153&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/153&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 224ms (ActiveRecord: 19.5ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 13:46:15 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 20:46:29' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'Elan University'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_name` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'fa6a2400-42cf-0133-aefe-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"40c1aed0b2189e7ef07e5fac7150a7ff\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 20:48:03' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 20:48:04' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (11.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130
Completed 302 Found in 108163ms (ActiveRecord: 21.5ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130" for 127.0.0.1 at 2015-09-21 13:48:04 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"130"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 152ms (ActiveRecord: 5.4ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 13:48:10 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"1337632368226", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442868489", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"M12OCjaqN+m5yA1AYdcdFGz1e8E="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (1.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 20:48:10' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (3.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 482ms (ActiveRecord: 9.5ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 13:48:10 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 20:48:11', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 20:48:11')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/154&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/154&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 192ms (ActiveRecord: 9.6ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 13:48:13 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[35mLtiRegistrationWip Load (1.0ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 20:48:17' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36mTenant Load (7.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
Mysql2::Error: Unknown column 'tenants.reg_key' in 'where clause': SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 49390ms
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
Mysql2::Error: Unknown column 'tenants.reg_key' in 'where clause': SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1

Mysql2::Error - Unknown column 'tenants.reg_key' in 'where clause':
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract_mysql_adapter.rb:303:in `block in execute'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract_mysql_adapter.rb:303:in `execute'
  activerecord (4.1.9) lib/active_record/connection_adapters/mysql2_adapter.rb:228:in `execute'
  activerecord (4.1.9) lib/active_record/connection_adapters/mysql2_adapter.rb:232:in `exec_query'
  activerecord (4.1.9) lib/active_record/connection_adapters/mysql2_adapter.rb:240:in `select'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/database_statements.rb:24:in `select_all'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/query_cache.rb:68:in `block in select_all'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/query_cache.rb:83:in `cache_sql'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/query_cache.rb:68:in `select_all'
  activerecord (4.1.9) lib/active_record/querying.rb:39:in `find_by_sql'
  activerecord (4.1.9) lib/active_record/relation.rb:611:in `exec_queries'
  activerecord (4.1.9) lib/active_record/relation.rb:493:in `load'
  activerecord (4.1.9) lib/active_record/relation.rb:238:in `to_a'
  activerecord (4.1.9) lib/active_record/relation/finder_methods.rb:474:in `find_nth_with_limit'
  activerecord (4.1.9) lib/active_record/relation/finder_methods.rb:468:in `find_nth'
  activerecord (4.1.9) lib/active_record/relation/finder_methods.rb:132:in `first'
  app/controllers/lti_registration_wips_controller.rb:107:in `show_reregistration'
  app/controllers/lti_registration_wips_controller.rb:58:in `show'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:166:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:25:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/__better_errors/93e090022e4ce23c/variables" for 127.0.0.1 at 2015-09-21 13:51:26 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 13:51:49 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"3282063489881", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442868709", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"SGWI/PRQqcs4vxAV59l+429+/SQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (1.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 20:51:52' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 536ms (ActiveRecord: 34.9ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 13:51:52 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 20:51:52', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 20:51:52')[0m
  [1m[35m (2.3ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/155&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/155&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 208ms (ActiveRecord: 5.8ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 13:51:54 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 20:51:54' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.8ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '903b4570-42d0-0133-aefe-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"f27a8222676a228873f6ec0b6a778513\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 20:52:15' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (6.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 20:52:15' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (3.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130
Completed 302 Found in 20563ms (ActiveRecord: 17.0ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130" for 127.0.0.1 at 2015-09-21 13:52:15 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"130"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 25ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 13:52:47 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"6003956544319", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442868766", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"rhPFy7paBvWj6gTxMp0j7ZqoeaI="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 20:52:47' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 243ms (ActiveRecord: 6.1ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 13:52:47 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 20:52:47', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 20:52:47')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/156&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/156&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 58ms (ActiveRecord: 3.2ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 13:52:49 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 20:52:49' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'cabd1e60-42d0-0133-aefe-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"a9f646e3dcc3225de0d2794ebe7e3f3c\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 20:53:59' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (7.1ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 20:58:05' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (6.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130
Completed 302 Found in 316692ms (ActiveRecord: 22.1ms)


Started GET "/lti2_tp/tool_proxies/d00220d0-42ce-0133-aefc-20c9d07c6451?correlation=cabd1e60-42d0-0133-aefe-20c9d07c6451" for 127.0.0.1 at 2015-09-21 13:58:06 -0700

ActionController::RoutingError (No route matches [GET] "/lti2_tp/tool_proxies/d00220d0-42ce-0133-aefc-20c9d07c6451"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (13.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (95.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (24.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (12.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (539.7ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130" for 127.0.0.1 at 2015-09-21 13:58:06 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"130"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 18ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 13:59:03 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"9374176087918", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442869142", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"LT6mlN2Y4b1sFP/dS/zRwA53QEs="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 20:59:03' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (1.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 267ms (ActiveRecord: 6.8ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 13:59:03 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 20:59:03', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 20:59:03')[0m
  [1m[35m (1.1ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/157&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/157&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 58ms (ActiveRecord: 4.1ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 13:59:05 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 20:59:05' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '86ea1160-42d1-0133-aefe-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"21606404e0b0e8adf0ad51d45e370903\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 20:59:09' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (2.8ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 21:02:49' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (12.8ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130
Completed 302 Found in 223700ms (ActiveRecord: 24.1ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130" for 127.0.0.1 at 2015-09-21 14:02:49 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"130"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 240ms (ActiveRecord: 30.3ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:03:04 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"4016872520000", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442869384", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"jXukX4mVMhcjGQJNheLMWEs6ZQ4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.7ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_consumer_profile_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"d0022440-42ce-0133-aefc-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 21:03:05' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (12.6ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 386ms (ActiveRecord: 17.3ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:03:05 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:03:05', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 21:03:05')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/158&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/158&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 161ms (ActiveRecord: 7.4ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 14:03:07 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 21:03:07' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '14d77c60-42d2-0133-aefe-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"3e97d1ce2de615746d3ff433443ed97a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:03:07' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 21:03:14' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (11.9ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130
Completed 302 Found in 7552ms (ActiveRecord: 20.2ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=403-Forbidden+&lti_errorlog=403-Forbidden+&&id=130" for 127.0.0.1 at 2015-09-21 14:03:14 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"403-Forbidden ", "lti_errorlog"=>"403-Forbidden ", "id"=>"130"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=403-Forbidden+&lti_errormsg=403-Forbidden+&status=failure
Completed 302 Found in 27ms (ActiveRecord: 0.7ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:12:11 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "oauth_nonce"=>"2540645783768", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442869930", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"5LqBm8uc4x63bwppFQAIjFqUY2Q="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 41  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 41 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.0ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 21:12:12' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations
Completed 302 Found in 829ms (ActiveRecord: 48.9ms)


Started GET "/lti_registration_wips?registration_id=130&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:12:12 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"130", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:12:13', 'Elan/LuMoS', 130, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'd00220d0-42ce-0133-aefc-20c9d07c6451', '2015-09-21 21:12:13')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/159&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=130&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/159&consumer_key=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 164ms (ActiveRecord: 8.4ms)


Started GET "/lti_registration_wips/151" for 127.0.0.1 at 2015-09-21 14:12:15 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"151"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 151 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 21:12:15' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'd00220d0-42ce-0133-aefc-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (1.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '5b8ccb90-42d3-0133-aeff-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"10e3b9f20ca3657b993b35c01b125976\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:12:15' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"d00220d0-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"10e3b9f20ca3657b993b35c01b125976\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:12:27' WHERE `lti2_tp_registrations`.`id` = 130
  [1m[36m (11.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 21:12:27' WHERE `lti2_tp_registrations`.`id` = 130[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=d00220d0-42ce-0133-aefc-20c9d07c6451&&id=130
Completed 302 Found in 11992ms (ActiveRecord: 22.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=d00220d0-42ce-0133-aefc-20c9d07c6451&&id=130" for 127.0.0.1 at 2015-09-21 14:12:27 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"d00220d0-42ce-0133-aefc-20c9d07c6451", "id"=>"130"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 130 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=d00220d0-42ce-0133-aefc-20c9d07c6451
Completed 302 Found in 18ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:12:33 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (13.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (97.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (39.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (14.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (568.0ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:14:28 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451", "reg_key"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (2.4ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-21 21:14:28', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'a79b53f0-42d3-0133-af00-20c9d07c6451', '51fc56056273cda432c6db24d5b13c20', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/d0022440-42ce-0133-aefc-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"a79b5920-42d3-0133-af00-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-21 21:14:28', '2')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations
Completed 302 Found in 307ms (ActiveRecord: 4.5ms)


Started GET "/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:14:28 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"131", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'a79b53f0-42d3-0133-af00-20c9d07c6451', `updated_at` = '2015-09-21 21:14:28' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:14:28', 'Elan/LuMoS', 131, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'a79b53f0-42d3-0133-af00-20c9d07c6451', '2015-09-21 21:14:28')[0m
  [1m[35m (0.8ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/160&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/160&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 93ms (ActiveRecord: 5.9ms)


Started GET "/lti_registration_wips/160" for 127.0.0.1 at 2015-09-21 14:14:30 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"160"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 160 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 21:14:30' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'a79b53f0-42d3-0133-af00-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:14:30', 'a79b53f0-42d3-0133-af00-20c9d07c6451', 'a79b53f0-42d3-0133-af00-20c9d07c6451', '2015-09-21 21:14:30')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'ac6639c0-42d3-0133-aeff-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"a16f7cfbae47177b3e5a976b88b23f32\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:14:31' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\"}', `updated_at` = '2015-09-21 21:14:31' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mTenant Exists (11.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'a79b53f0-42d3-0133-af00-20c9d07c6451' AND `tenants`.`id` != 42) LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `tenants` SET `secret` = 'a16f7cfbae47177b3e5a976b88b23f32', `updated_at` = '2015-09-21 21:14:31' WHERE `tenants`.`id` = 42
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'a16f7cfbae47177b3e5a976b88b23f32', `tenant_id` = 42, `updated_at` = '2015-09-21 21:14:31' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131
Completed 302 Found in 561ms (ActiveRecord: 29.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131" for 127.0.0.1 at 2015-09-21 14:14:31 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "id"=>"131"}
  [1m[36mLti2Tp::Registration Load (2.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 34ms (ActiveRecord: 2.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:15:34 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "oauth_nonce"=>"6825398411177", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442870134", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"BgppGfI+fNEwz21ZUO8bL9uDziw="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 42  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 42 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = 'a16f7cfbae47177b3e5a976b88b23f32', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 21:15:35' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations
Completed 302 Found in 240ms (ActiveRecord: 6.3ms)


Started GET "/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:15:35 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"131", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:15:35', 'Elan/LuMoS', 131, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'a79b53f0-42d3-0133-af00-20c9d07c6451', '2015-09-21 21:15:35')
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/161&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/161&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 49ms (ActiveRecord: 3.1ms)


Started GET "/lti_registration_wips/160" for 127.0.0.1 at 2015-09-21 14:15:37 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"160"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 160 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 21:15:37' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd3e3b940-42d3-0133-aeff-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"e88293475dffd44a38771c5c1cd50ac3\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:15:37' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"e88293475dffd44a38771c5c1cd50ac3\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:15:37' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 21:15:37' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (1.0ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131
Completed 302 Found in 330ms (ActiveRecord: 13.8ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131" for 127.0.0.1 at 2015-09-21 14:15:37 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "id"=>"131"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 15ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:16:04 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (8.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (85.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (23.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (8.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (532.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:18:53 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "oauth_nonce"=>"7624475525281", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442870333", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"KP2hXp01it1Pe0ORv5xiFAFzDlM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.2ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 42  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 42 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = 'pre', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-21 21:18:53' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations
Completed 302 Found in 262ms (ActiveRecord: 6.6ms)


Started GET "/lti_registration_wips?registration_id=131&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 14:18:54 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"131", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-21 21:18:54', 'Elan/LuMoS', 131, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'a79b53f0-42d3-0133-af00-20c9d07c6451', '2015-09-21 21:18:54')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/162&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=131&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/162&consumer_key=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 48ms (ActiveRecord: 3.5ms)


Started GET "/lti_registration_wips/160" for 127.0.0.1 at 2015-09-21 14:18:55 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"160"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 160 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-21 21:18:55' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'a79b53f0-42d3-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '4a5c8020-42d4-0133-aeff-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"88447f9c102fe5cce8cdbfa4899cb7e6\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:18:56' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"a79b53f0-42d3-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/a79b5920-42d3-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"88447f9c102fe5cce8cdbfa4899cb7e6\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-21 21:18:56' WHERE `lti2_tp_registrations`.`id` = 131
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-21 21:18:56' WHERE `lti2_tp_registrations`.`id` = 131[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131
Completed 302 Found in 378ms (ActiveRecord: 10.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451&&id=131" for 127.0.0.1 at 2015-09-21 14:18:56 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"a79b53f0-42d3-0133-af00-20c9d07c6451", "id"=>"131"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 131 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=a79b53f0-42d3-0133-af00-20c9d07c6451
Completed 302 Found in 13ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 14:19:22 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (13.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (103.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (23.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (10.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (497.6ms)
  [1m[36mLti2Tp::Registry Load (0.7ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.7ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:44:38 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"3590471681258", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886278", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"S96qDma0w2ry3OPUqDfJXyzlogM="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (7.4ms)[0m  UPDATE `lti2_tp_registrations` SET `reg_password` = 'pre', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:44:39' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 691ms (ActiveRecord: 58.5ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:44:40 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:44:40', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:44:40')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/169&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/169&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 171ms (ActiveRecord: 12.3ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:44:42 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:44:42' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '6b229ac0-42f9-0133-af04-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"1e994ada1a64a855d67fc247a71c04ce\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:44:42' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"1e994ada1a64a855d67fc247a71c04ce\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:44:42' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:44:42' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.4ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 378ms (ActiveRecord: 14.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:44:42 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
Completed 500 Internal Server Error in 74ms

ActionView::MissingTemplate - Missing template lti2_tp/registrations/index, inherited_resources/base/index, application/index with {:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:erb, :builder, :raw, :ruby, :coffee, :arb, :haml]}. Searched in:
  * "/Users/johntibbetts/git/LTI2-Reference/app/views"
  * "/Users/johntibbetts/git/registration-engine/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/active_admin-e3a7354c0196/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/kaminari-0.16.3/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tc/app/views"
:
  actionview (4.1.9) lib/action_view/path_set.rb:46:in `find'
  actionview (4.1.9) lib/action_view/lookup_context.rb:124:in `find'
  actionview (4.1.9) lib/action_view/renderer/abstract_renderer.rb:18:in `find_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:41:in `determine_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:8:in `render'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:42:in `render_template'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:23:in `render'
  actionview (4.1.9) lib/action_view/rendering.rb:99:in `_render_template'
  actionpack (4.1.9) lib/action_controller/metal/streaming.rb:217:in `_render_template'
  actionview (4.1.9) lib/action_view/rendering.rb:82:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/renderers.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/abstract_controller/rendering.rb:25:in `render'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:16:in `render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block (2 levels) in render'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `block in ms'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/benchmark.rb:294:in `realtime'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `ms'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block in render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:40:in `render'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:238:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:165:in `to_html'
  responders (1.1.2) lib/responders/flash_responder.rb:107:in `to_html'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:158:in `respond'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:151:in `call'
  actionpack (4.1.9) lib/action_controller/metal/mime_responds.rb:400:in `respond_with'
  inherited_resources (1.6.0) lib/inherited_resources/actions.rb:7:in `index'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:25:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/bba37cb50f08c0fd/variables" for 127.0.0.1 at 2015-09-21 18:44:43 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:46:42 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"9683230389586", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886402", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"xMAtHLbHlbdXIFDlPEE5rAtUIes="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.3ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:46:43' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (2.5ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 494ms (ActiveRecord: 8.7ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:46:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (3.9ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:46:43', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:46:43')[0m
  [1m[35m (1.1ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/170&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/170&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 116ms (ActiveRecord: 8.0ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:46:45 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:46:45' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (2.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.5ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'b4653c90-42f9-0133-af04-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"986028de41c586a904509663f41bb809\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:46:45' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"986028de41c586a904509663f41bb809\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:46:45' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:46:45' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 648ms (ActiveRecord: 16.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:46:45 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
Completed 500 Internal Server Error in 60ms

ActionView::MissingTemplate - Missing template lti2_tp/registrations/index, inherited_resources/base/index, application/index with {:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:erb, :builder, :raw, :ruby, :coffee, :arb, :haml]}. Searched in:
  * "/Users/johntibbetts/git/LTI2-Reference/app/views"
  * "/Users/johntibbetts/git/registration-engine/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/active_admin-e3a7354c0196/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/kaminari-0.16.3/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tc/app/views"
:
  actionview (4.1.9) lib/action_view/path_set.rb:46:in `find'
  actionview (4.1.9) lib/action_view/lookup_context.rb:124:in `find'
  actionview (4.1.9) lib/action_view/renderer/abstract_renderer.rb:18:in `find_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:41:in `determine_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:8:in `render'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:42:in `render_template'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:23:in `render'
  actionview (4.1.9) lib/action_view/rendering.rb:99:in `_render_template'
  actionpack (4.1.9) lib/action_controller/metal/streaming.rb:217:in `_render_template'
  actionview (4.1.9) lib/action_view/rendering.rb:82:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/renderers.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/abstract_controller/rendering.rb:25:in `render'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:16:in `render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block (2 levels) in render'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `block in ms'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/benchmark.rb:294:in `realtime'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `ms'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block in render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:40:in `render'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:238:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:165:in `to_html'
  responders (1.1.2) lib/responders/flash_responder.rb:107:in `to_html'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:158:in `respond'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:151:in `call'
  actionpack (4.1.9) lib/action_controller/metal/mime_responds.rb:400:in `respond_with'
  inherited_resources (1.6.0) lib/inherited_resources/actions.rb:7:in `index'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:25:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/81a7aa42d1277d45/variables" for 127.0.0.1 at 2015-09-21 18:46:46 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:47:20 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"276200454828", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886439", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"ebnoAUjYGKENx4J6OH75nJnFbHs="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:47:20' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 230ms (ActiveRecord: 6.1ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:47:20 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:47:20', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:47:20')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/171&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/171&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 62ms (ActiveRecord: 3.4ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:47:22 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[35mLtiRegistrationWip Load (1.1ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:47:22' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36mTenant Load (0.5ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'caaf3660-42f9-0133-af04-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"c02ed29f93da1ea01d06aed9cef2d0ae\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:47:22' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"c02ed29f93da1ea01d06aed9cef2d0ae\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:47:22' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:47:22' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 336ms (ActiveRecord: 10.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:47:22 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
Completed 500 Internal Server Error in 37ms

ActionView::MissingTemplate - Missing template lti2_tp/registrations/index, inherited_resources/base/index, application/index with {:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:erb, :builder, :raw, :ruby, :coffee, :arb, :haml]}. Searched in:
  * "/Users/johntibbetts/git/LTI2-Reference/app/views"
  * "/Users/johntibbetts/git/registration-engine/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/active_admin-e3a7354c0196/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/kaminari-0.16.3/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tc/app/views"
:
  actionview (4.1.9) lib/action_view/path_set.rb:46:in `find'
  actionview (4.1.9) lib/action_view/lookup_context.rb:124:in `find'
  actionview (4.1.9) lib/action_view/renderer/abstract_renderer.rb:18:in `find_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:41:in `determine_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:8:in `render'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:42:in `render_template'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:23:in `render'
  actionview (4.1.9) lib/action_view/rendering.rb:99:in `_render_template'
  actionpack (4.1.9) lib/action_controller/metal/streaming.rb:217:in `_render_template'
  actionview (4.1.9) lib/action_view/rendering.rb:82:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/renderers.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/abstract_controller/rendering.rb:25:in `render'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:16:in `render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block (2 levels) in render'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `block in ms'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/benchmark.rb:294:in `realtime'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `ms'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block in render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:40:in `render'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:238:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:165:in `to_html'
  responders (1.1.2) lib/responders/flash_responder.rb:107:in `to_html'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:158:in `respond'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:151:in `call'
  actionpack (4.1.9) lib/action_controller/metal/mime_responds.rb:400:in `respond_with'
  inherited_resources (1.6.0) lib/inherited_resources/actions.rb:7:in `index'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:25:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/eaaaf5f982fc503e/variables" for 127.0.0.1 at 2015-09-21 18:47:23 -0700


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:47:57 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"9347433128106", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886476", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"ED6t5qKanbcAZFL1G90HQZkBpWU="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:47:57' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 254ms (ActiveRecord: 6.4ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:47:57 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:47:57', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:47:57')[0m
  [1m[35m (0.8ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/172&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/172&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 59ms (ActiveRecord: 3.2ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:47:59 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:48:21' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (11.6ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f7653650-42f9-0133-af04-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"8b7382775f085fcf170748c73e13b896\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:48:37' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (3.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"8b7382775f085fcf170748c73e13b896\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:48:37' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.8ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:48:40' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 72439ms (ActiveRecord: 26.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:49:11 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
Completed 500 Internal Server Error in 31ms

ActionView::MissingTemplate - Missing template lti2_tp/registrations/index, inherited_resources/base/index, application/index with {:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:erb, :builder, :raw, :ruby, :coffee, :arb, :haml]}. Searched in:
  * "/Users/johntibbetts/git/LTI2-Reference/app/views"
  * "/Users/johntibbetts/git/registration-engine/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/bundler/gems/active_admin-e3a7354c0196/app/views"
  * "/Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/kaminari-0.16.3/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tp/app/views"
  * "/Users/johntibbetts/git/LTI2-Reference/lti2_tc/app/views"
:
  actionview (4.1.9) lib/action_view/path_set.rb:46:in `find'
  actionview (4.1.9) lib/action_view/lookup_context.rb:124:in `find'
  actionview (4.1.9) lib/action_view/renderer/abstract_renderer.rb:18:in `find_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:41:in `determine_template'
  actionview (4.1.9) lib/action_view/renderer/template_renderer.rb:8:in `render'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:42:in `render_template'
  actionview (4.1.9) lib/action_view/renderer/renderer.rb:23:in `render'
  actionview (4.1.9) lib/action_view/rendering.rb:99:in `_render_template'
  actionpack (4.1.9) lib/action_controller/metal/streaming.rb:217:in `_render_template'
  actionview (4.1.9) lib/action_view/rendering.rb:82:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/action_controller/metal/renderers.rb:32:in `render_to_body'
  actionpack (4.1.9) lib/abstract_controller/rendering.rb:25:in `render'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:16:in `render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block (2 levels) in render'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `block in ms'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/benchmark.rb:294:in `realtime'
  activesupport (4.1.9) lib/active_support/core_ext/benchmark.rb:12:in `ms'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:41:in `block in render'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:40:in `render'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:238:in `default_render'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:165:in `to_html'
  responders (1.1.2) lib/responders/flash_responder.rb:107:in `to_html'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:158:in `respond'
  actionpack (4.1.9) lib/action_controller/metal/responder.rb:151:in `call'
  actionpack (4.1.9) lib/action_controller/metal/mime_responds.rb:400:in `respond_with'
  inherited_resources (1.6.0) lib/inherited_resources/actions.rb:7:in `index'
  actionpack (4.1.9) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:189:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
  activesupport (4.1.9) lib/active_support/callbacks.rb:113:in `call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:229:in `block in halting'
  activesupport (4.1.9) lib/active_support/callbacks.rb:149:in `block in halting_and_conditional'
  activesupport (4.1.9) lib/active_support/callbacks.rb:86:in `run_callbacks'
  actionpack (4.1.9) lib/abstract_controller/callbacks.rb:19:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `block in instrument'
  activesupport (4.1.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  activesupport (4.1.9) lib/active_support/notifications.rb:159:in `instrument'
  actionpack (4.1.9) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
  actionpack (4.1.9) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'
  activerecord (4.1.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  actionpack (4.1.9) lib/abstract_controller/base.rb:136:in `process'
  actionview (4.1.9) lib/action_view/rendering.rb:30:in `process'
  actionpack (4.1.9) lib/action_controller/metal.rb:196:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'
  actionpack (4.1.9) lib/action_controller/metal.rb:232:in `block in action'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:82:in `dispatch'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:50:in `call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/railtie.rb:194:in `method_missing'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:73:in `block in call'
  actionpack (4.1.9) lib/action_dispatch/journey/router.rb:59:in `call'
  actionpack (4.1.9) lib/action_dispatch/routing/route_set.rb:685:in `call'
  rack (1.5.2) lib/rack/etag.rb:23:in `call'
  rack (1.5.2) lib/rack/conditionalget.rb:25:in `call'
  rack (1.5.2) lib/rack/head.rb:11:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/params_parser.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/flash.rb:254:in `call'
  rack (1.5.2) lib/rack/session/abstract/id.rb:225:in `context'
  rack (1.5.2) lib/rack/session/abstract/id.rb:220:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/cookies.rb:562:in `call'
  activerecord (4.1.9) lib/active_record/query_cache.rb:36:in `call'
  activerecord (4.1.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:621:in `call'
  activerecord (4.1.9) lib/active_record/migration.rb:380:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'
  activesupport (4.1.9) lib/active_support/callbacks.rb:82:in `run_callbacks'
  actionpack (4.1.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/reloader.rb:73:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/remote_ip.rb:76:in `call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:84:in `protected_app_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:79:in `better_errors_call'
  better_errors (2.1.1) lib/better_errors/middleware.rb:57:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'



Started POST "/lti2_tp/__better_errors/ada39baa40204467/variables" for 127.0.0.1 at 2015-09-21 18:49:12 -0700
  [1m[36mLti2Tp::Registry Load (1.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.8ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:55:25 -0700
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"1377063820683", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886923", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"3MY86ql2nY402/YdwhPqslqrzNQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (1.1ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (14.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_consumer_profile_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"1026c650-42e7-0133-af00-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:55:28' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (2.5ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 1808ms (ActiveRecord: 41.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:55:31 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"1059257291896", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442886929", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"SL53uvpsmId0VuNclFWGL6Vw8VE="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (0.8ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 447ms (ActiveRecord: 4.6ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:55:31 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (1.3ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:55:32', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:55:32')[0m
  [1m[35m (2.1ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/173&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/173&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 282ms (ActiveRecord: 28.0ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:55:34 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[36mLtiRegistrationWip Load (7.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (1.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:55:40' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.7ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'f52bf280-42fa-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"dde034d61059a5b110883ec092bca348\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:55:43' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"dde034d61059a5b110883ec092bca348\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:55:50' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (2.2ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.9ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:55:50' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 15410ms (ActiveRecord: 22.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:55:50 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 62ms (ActiveRecord: 1.0ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:56:21 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (19.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (97.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (26.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (12.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (571.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:58:27 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"1258781476272", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887106", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"8znFMB5H365TQcJ12sgD/egjow8="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 44 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 01:58:27' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.2ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations
Completed 302 Found in 328ms (ActiveRecord: 6.5ms)


Started GET "/lti_registration_wips?registration_id=133&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 18:58:27 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"133", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (2.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 01:58:28', 'Elan/LuMoS', 133, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '1026c460-42e7-0133-af00-20c9d07c6451', '2015-09-22 01:58:28')[0m
  [1m[35m (0.7ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/174&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=133&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/174&consumer_key=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 62ms (ActiveRecord: 5.9ms)


Started GET "/lti_registration_wips/167" for 127.0.0.1 at 2015-09-21 18:58:32 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"167"}
  [1m[36mLtiRegistrationWip Load (0.7ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 167 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 01:58:32' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '5c1c9b80-42fb-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"acd77d85cada71df17b24d7b31fbdc4d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:58:36' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"1026c460-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"acd77d85cada71df17b24d7b31fbdc4d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 01:58:42' WHERE `lti2_tp_registrations`.`id` = 133[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (2.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 01:58:42' WHERE `lti2_tp_registrations`.`id` = 133
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133
Completed 302 Found in 9605ms (ActiveRecord: 17.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451&&id=133" for 127.0.0.1 at 2015-09-21 18:58:42 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"1026c460-42e7-0133-af00-20c9d07c6451", "id"=>"133"}
  [1m[35mLti2Tp::Registration Load (1.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 133 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=1026c460-42e7-0133-af00-20c9d07c6451
Completed 302 Found in 56ms (ActiveRecord: 1.4ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 18:58:51 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (23.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (124.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (30.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (10.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (698.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:00:01 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"5607200796446", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887199", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"exNPKAOCqR3fiwIbA3UZUsth+KQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (4.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (2.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: pre
Verify_signature--send_signature: exNPKAOCqR3fiwIbA3UZUsth+KQ=  test_signature: TUn89dxlkl7PqkLcQmwgTLLlzWc=
Verify signature_base_string: POST&http%3A%2F%2Flocalhost%3A4100%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D1026c460-42e7-0133-af00-20c9d07c6451%26oauth_nonce%3D5607200796446%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1442887199%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F1026c650-42e7-0133-af00-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 170ms (ActiveRecord: 7.0ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:00:42 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"1026c460-42e7-0133-af00-20c9d07c6451", "oauth_nonce"=>"8534535344234", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887240", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"Gy8ytX3jtakwEqhG5I9wwJB33to="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '1026c460-42e7-0133-af00-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 44  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: pre
Verify_signature--send_signature: Gy8ytX3jtakwEqhG5I9wwJB33to=  test_signature: 3c/IKM/jSrcjSlLLkI4ZyvJoY4E=
Verify signature_base_string: POST&http%3A%2F%2Flocalhost%3A4100%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3D1026c460-42e7-0133-af00-20c9d07c6451%26oauth_nonce%3D8534535344234%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1442887240%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252F1026c650-42e7-0133-af00-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 77ms (ActiveRecord: 1.8ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:01:38 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451", "reg_key"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 02:01:38', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'c06a5570-42fb-0133-af06-20c9d07c6451', '9082c3aacc5e9e57037b6e6b6543ffb7', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c06a8380-42fb-0133-af06-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 02:01:38', '2')[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=134&return_url=/lti2_tp/registrations
Completed 302 Found in 268ms (ActiveRecord: 2.5ms)


Started GET "/lti_registration_wips?registration_id=134&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:01:38 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"134", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'c06a5570-42fb-0133-af06-20c9d07c6451', `updated_at` = '2015-09-22 02:01:38' WHERE `lti2_tp_registrations`.`id` = 134[0m
  [1m[35m (1.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:01:38', 'Elan/LuMoS', 134, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'c06a5570-42fb-0133-af06-20c9d07c6451', '2015-09-22 02:01:38')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=134&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/175&consumer_key=c06a5570-42fb-0133-af06-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=134&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/175&consumer_key=c06a5570-42fb-0133-af06-20c9d07c6451
Completed 302 Found in 67ms (ActiveRecord: 5.2ms)


Started GET "/lti_registration_wips/175" for 127.0.0.1 at 2015-09-21 19:01:50 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"175"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 175 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:01:50' WHERE `lti2_tp_registrations`.`id` = 134[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'c06a5570-42fb-0133-af06-20c9d07c6451' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:01:50', 'c06a5570-42fb-0133-af06-20c9d07c6451', 'c06a5570-42fb-0133-af06-20c9d07c6451', '2015-09-22 02:01:50')[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd0308ec0-42fb-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"c06a5570-42fb-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0fe84ec7511f8006f1bfbd7782890595\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:01:50' WHERE `lti2_tp_registrations`.`id` = 134
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"c06a5570-42fb-0133-af06-20c9d07c6451\"}', `updated_at` = '2015-09-22 02:01:59' WHERE `lti2_tp_registrations`.`id` = 134[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'c06a5570-42fb-0133-af06-20c9d07c6451' AND `tenants`.`id` != 45) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = '0fe84ec7511f8006f1bfbd7782890595', `updated_at` = '2015-09-22 02:02:06' WHERE `tenants`.`id` = 45[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '0fe84ec7511f8006f1bfbd7782890595', `tenant_id` = 45, `updated_at` = '2015-09-22 02:02:06' WHERE `lti2_tp_registrations`.`id` = 134
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451&&id=134
Completed 302 Found in 15756ms (ActiveRecord: 17.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451&&id=134" for 127.0.0.1 at 2015-09-21 19:02:06 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "id"=>"134"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.6ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:03:31 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "oauth_nonce"=>"1254659529788", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887410", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"4Xan7vjxksvh/QLo/98epjovRhQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c06a5570-42fb-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 45  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'c06a5570-42fb-0133-af06-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 45 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '0fe84ec7511f8006f1bfbd7782890595', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 02:03:31' WHERE `lti2_tp_registrations`.`id` = 134[0m
  [1m[35m (1.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=134&return_url=/lti2_tp/registrations
Completed 302 Found in 330ms (ActiveRecord: 7.0ms)


Started GET "/lti_registration_wips?registration_id=134&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:03:31 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"134", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (3.4ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:03:32', 'Elan/LuMoS', 134, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'c06a5570-42fb-0133-af06-20c9d07c6451', '2015-09-22 02:03:32')[0m
  [1m[35m (0.7ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=134&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/176&consumer_key=c06a5570-42fb-0133-af06-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=134&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/176&consumer_key=c06a5570-42fb-0133-af06-20c9d07c6451
Completed 302 Found in 70ms (ActiveRecord: 6.0ms)


Started GET "/lti_registration_wips/175" for 127.0.0.1 at 2015-09-21 19:03:34 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"175"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 175 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:03:34' WHERE `lti2_tp_registrations`.`id` = 134
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c06a5570-42fb-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '104cce30-42fc-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"c06a5570-42fb-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"e6d65c86a16812e6550ffe6b9fba26a8\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:03:38' WHERE `lti2_tp_registrations`.`id` = 134
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"c06a5570-42fb-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"e6d65c86a16812e6550ffe6b9fba26a8\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:03:38' WHERE `lti2_tp_registrations`.`id` = 134[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 02:03:38' WHERE `lti2_tp_registrations`.`id` = 134
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451&&id=134
Completed 302 Found in 4473ms (ActiveRecord: 12.5ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451&&id=134" for 127.0.0.1 at 2015-09-21 19:03:38 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "id"=>"134"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 134 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=c06a5570-42fb-0133-af06-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:04:57 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (21.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (188.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (44.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (25.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (848.5ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:06:58 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "oauth_nonce"=>"178641101267", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887615", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"96QvhxxGr12Pg+x2UG+0d21Z0M4="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (1.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c06a5570-42fb-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (19.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 45  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 0fe84ec7511f8006f1bfbd7782890595
Verify_signature--send_signature: 96QvhxxGr12Pg+x2UG+0d21Z0M4=  test_signature: c5mBeYI4ILRThUxak9lUza5ZNLg=
Verify signature_base_string: POST&http%3A%2F%2Flocalhost%3A4100%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Dc06a5570-42fb-0133-af06-20c9d07c6451%26oauth_nonce%3D178641101267%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1442887615%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fc06a8380-42fb-0133-af06-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 155ms (ActiveRecord: 20.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:08:17 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/c06a8380-42fb-0133-af06-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"c06a5570-42fb-0133-af06-20c9d07c6451", "oauth_nonce"=>"9100175183179", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887695", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"8Ue7hnP2J3O+4RdqeXLj/ix3xhk="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (2.1ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'c06a5570-42fb-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 45  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
Secret: 0fe84ec7511f8006f1bfbd7782890595
Verify_signature--send_signature: 8Ue7hnP2J3O+4RdqeXLj/ix3xhk=  test_signature: Cq77cB4M4pGuJLXssaRxTrg7hQs=
Verify signature_base_string: POST&http%3A%2F%2Flocalhost%3A4100%2Flti2_tp%2Freregistrations&launch_presentation_return_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Fadmin%252Ftool_actions%26lti_message_type%3DToolProxyReregistrationRequest%26oauth_callback%3Dabout%253Ablank%26oauth_consumer_key%3Dc06a5570-42fb-0133-af06-20c9d07c6451%26oauth_nonce%3D9100175183179%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1442887695%26oauth_version%3D1.0%26tc_profile_url%3Dhttp%253A%252F%252Frails.kinexis.com%253A4000%252Flti2_tc%252Ftool_consumer_profiles%252Fc06a8380-42fb-0133-af06-20c9d07c6451
Invalid signature
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 100ms (ActiveRecord: 3.3ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:08:44 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451", "reg_key"=>"bdec6990-42fc-0133-af06-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 02:08:44', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'bdec6990-42fc-0133-af06-20c9d07c6451', 'ca8788d83f03548b01f30de84a4d7fa1', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/1026c650-42e7-0133-af00-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"bdec81b0-42fc-0133-af06-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 02:08:44', '2')[0m
  [1m[35m (2.2ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations
Completed 302 Found in 294ms (ActiveRecord: 4.2ms)


Started GET "/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:08:44 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"135", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'bdec6990-42fc-0133-af06-20c9d07c6451', `updated_at` = '2015-09-22 02:08:44' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (1.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:08:44', 'Elan/LuMoS', 135, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'bdec6990-42fc-0133-af06-20c9d07c6451', '2015-09-22 02:08:44')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=135&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/177&consumer_key=bdec6990-42fc-0133-af06-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=135&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/177&consumer_key=bdec6990-42fc-0133-af06-20c9d07c6451
Completed 302 Found in 68ms (ActiveRecord: 5.1ms)


Started GET "/lti_registration_wips/177" for 127.0.0.1 at 2015-09-21 19:08:47 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"177"}
  [1m[35mLtiRegistrationWip Load (1.1ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 177 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.0ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:08:47' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'bdec6990-42fc-0133-af06-20c9d07c6451' LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:08:47', 'bdec6990-42fc-0133-af06-20c9d07c6451', 'bdec6990-42fc-0133-af06-20c9d07c6451', '2015-09-22 02:08:47')[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'c85d7d40-42fc-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bdec6990-42fc-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"47641563ff85e61980719478d83874c9\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:08:47' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"bdec6990-42fc-0133-af06-20c9d07c6451\"}', `updated_at` = '2015-09-22 02:08:48' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.6ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'bdec6990-42fc-0133-af06-20c9d07c6451' AND `tenants`.`id` != 46) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `tenants` SET `secret` = '47641563ff85e61980719478d83874c9', `updated_at` = '2015-09-22 02:08:48' WHERE `tenants`.`id` = 46[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '47641563ff85e61980719478d83874c9', `tenant_id` = 46, `updated_at` = '2015-09-22 02:08:48' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451&&id=135
Completed 302 Found in 1249ms (ActiveRecord: 19.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451&&id=135" for 127.0.0.1 at 2015-09-21 19:08:48 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"bdec6990-42fc-0133-af06-20c9d07c6451", "id"=>"135"}
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451
Completed 302 Found in 19ms (ActiveRecord: 0.9ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:09:00 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"bdec6990-42fc-0133-af06-20c9d07c6451", "oauth_nonce"=>"8173716364226", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442887738", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"rhJpngF+I+qVRw2zTExlcJEmY/k="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.8ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bdec6990-42fc-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 46  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (1.2ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'bdec6990-42fc-0133-af06-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.9ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 46 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '47641563ff85e61980719478d83874c9', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 02:09:00' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations
Completed 302 Found in 420ms (ActiveRecord: 7.7ms)


Started GET "/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:09:00 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"135", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:09:00', 'Elan/LuMoS', 135, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'bdec6990-42fc-0133-af06-20c9d07c6451', '2015-09-22 02:09:00')[0m
  [1m[35m (2.1ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=135&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/178&consumer_key=bdec6990-42fc-0133-af06-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=135&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/178&consumer_key=bdec6990-42fc-0133-af06-20c9d07c6451
Completed 302 Found in 72ms (ActiveRecord: 5.1ms)


Started GET "/lti_registration_wips/177" for 127.0.0.1 at 2015-09-21 19:09:02 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"177"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 177 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (2.2ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:09:02' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (1.0ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bdec6990-42fc-0133-af06-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd505bf70-42fc-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bdec6990-42fc-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"5f1bbf18b345ee5fb293bfd3ae1b0320\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:09:08' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (6.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bdec6990-42fc-0133-af06-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bdec81b0-42fc-0133-af06-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"5f1bbf18b345ee5fb293bfd3ae1b0320\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:09:09' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (1.4ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 02:09:09' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (1.3ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451&&id=135
Completed 302 Found in 6298ms (ActiveRecord: 21.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451&&id=135" for 127.0.0.1 at 2015-09-21 19:09:09 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"bdec6990-42fc-0133-af06-20c9d07c6451", "id"=>"135"}
  [1m[35mLti2Tp::Registration Load (1.1ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=bdec6990-42fc-0133-af06-20c9d07c6451
Completed 302 Found in 27ms (ActiveRecord: 1.1ms)


Started PUT "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:11:05 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/reregistrations"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (10.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (102.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (25.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (10.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (532.6ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:32:28 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451", "reg_key"=>"149890a0-4300-0133-af07-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 02:32:31', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '149890a0-4300-0133-af07-20c9d07c6451', 'a6bcbfdcd51a546214b48eabb771a2a2', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"149973c0-4300-0133-af07-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 02:32:31', '2')[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=136&return_url=/lti2_tp/registrations
Completed 302 Found in 405ms (ActiveRecord: 15.4ms)


Started GET "/lti_registration_wips?registration_id=136&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:32:31 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"136", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '149890a0-4300-0133-af07-20c9d07c6451', `updated_at` = '2015-09-22 02:32:31' WHERE `lti2_tp_registrations`.`id` = 136[0m
  [1m[35m (1.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:32:32', 'Elan/LuMoS', 136, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '149890a0-4300-0133-af07-20c9d07c6451', '2015-09-22 02:32:32')
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=136&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/179&consumer_key=149890a0-4300-0133-af07-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=136&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/179&consumer_key=149890a0-4300-0133-af07-20c9d07c6451
Completed 302 Found in 162ms (ActiveRecord: 6.8ms)


Started GET "/lti_registration_wips/179" for 127.0.0.1 at 2015-09-21 19:32:34 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"179"}
  [1m[35mLtiRegistrationWip Load (0.9ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 179 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:32:34' WHERE `lti2_tp_registrations`.`id` = 136[0m
  [1m[35m (2.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.9ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '149890a0-4300-0133-af07-20c9d07c6451' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:32:34', '149890a0-4300-0133-af07-20c9d07c6451', '149890a0-4300-0133-af07-20c9d07c6451', '2015-09-22 02:32:34')[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '1ae93690-4300-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"149890a0-4300-0133-af07-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/149973c0-4300-0133-af07-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"3efef582fef6f238a861da09f247680d\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:32:34' WHERE `lti2_tp_registrations`.`id` = 136
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=failure&lti_errormsg=500-Internal+Server+Error+&lti_errorlog=500-Internal+Server+Error+&&id=136
Completed 302 Found in 456ms (ActiveRecord: 15.5ms)


Started GET "/lti2_tp/registrations?status=failure&lti_errormsg=500-Internal+Server+Error+&lti_errorlog=500-Internal+Server+Error+&&id=136" for 127.0.0.1 at 2015-09-21 19:32:34 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"failure", "lti_errormsg"=>"500-Internal Server Error ", "lti_errorlog"=>"500-Internal Server Error ", "id"=>"136"}
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?lti_errorlog=500-Internal+Server+Error+&lti_errormsg=500-Internal+Server+Error+&status=failure
Completed 302 Found in 29ms (ActiveRecord: 1.0ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:33:40 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451", "reg_key"=>"3fbf5360-4300-0133-af08-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.5ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 02:33:43', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '3fbf5360-4300-0133-af08-20c9d07c6451', '06da7c34674e6400ad8a042c6f0cf5b1', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"3fc05300-4300-0133-af08-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 02:33:43', '2')[0m
  [1m[35m (2.3ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations
Completed 302 Found in 432ms (ActiveRecord: 20.5ms)


Started GET "/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:33:43 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"137", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '3fbf5360-4300-0133-af08-20c9d07c6451', `updated_at` = '2015-09-22 02:33:43' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (2.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:33:43', 'Elan/LuMoS', 137, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '3fbf5360-4300-0133-af08-20c9d07c6451', '2015-09-22 02:33:43')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=137&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/180&consumer_key=3fbf5360-4300-0133-af08-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=137&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/180&consumer_key=3fbf5360-4300-0133-af08-20c9d07c6451
Completed 302 Found in 204ms (ActiveRecord: 7.2ms)


Started GET "/lti_registration_wips/180" for 127.0.0.1 at 2015-09-21 19:33:45 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"180"}
  [1m[35mLtiRegistrationWip Load (0.8ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 180 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:33:45' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (2.3ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '3fbf5360-4300-0133-af08-20c9d07c6451' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:33:45', '3fbf5360-4300-0133-af08-20c9d07c6451', '3fbf5360-4300-0133-af08-20c9d07c6451', '2015-09-22 02:33:45')[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '4557aae0-4300-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"3fbf5360-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"8d0e7e12a8049346062f37ad3305852e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:33:45' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"3fbf5360-4300-0133-af08-20c9d07c6451\"}', `updated_at` = '2015-09-22 02:33:45' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (1.0ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '3fbf5360-4300-0133-af08-20c9d07c6451' AND `tenants`.`id` != 48) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = '8d0e7e12a8049346062f37ad3305852e', `updated_at` = '2015-09-22 02:33:45' WHERE `tenants`.`id` = 48[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '8d0e7e12a8049346062f37ad3305852e', `tenant_id` = 48, `updated_at` = '2015-09-22 02:33:46' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451&&id=137
Completed 302 Found in 760ms (ActiveRecord: 23.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451&&id=137" for 127.0.0.1 at 2015-09-21 19:33:46 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"3fbf5360-4300-0133-af08-20c9d07c6451", "id"=>"137"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451
Completed 302 Found in 18ms (ActiveRecord: 0.8ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-21 19:33:52 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"3fbf5360-4300-0133-af08-20c9d07c6451", "oauth_nonce"=>"5864789567094", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442889231", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"bONDuY6DJqk7OidUbn8Oz6JVyVQ="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.7ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '3fbf5360-4300-0133-af08-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 48  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '3fbf5360-4300-0133-af08-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.5ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 48 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.8ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '8d0e7e12a8049346062f37ad3305852e', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 02:33:52' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (1.7ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations
Completed 302 Found in 252ms (ActiveRecord: 6.7ms)


Started GET "/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:33:52 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"137", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:33:52', 'Elan/LuMoS', 137, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '3fbf5360-4300-0133-af08-20c9d07c6451', '2015-09-22 02:33:52')[0m
  [1m[35m (2.0ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=137&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/181&consumer_key=3fbf5360-4300-0133-af08-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=137&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/181&consumer_key=3fbf5360-4300-0133-af08-20c9d07c6451
Completed 302 Found in 56ms (ActiveRecord: 4.8ms)


Started GET "/lti_registration_wips/180" for 127.0.0.1 at 2015-09-21 19:33:54 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"180"}
  [1m[36mLtiRegistrationWip Load (0.8ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 180 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:33:54' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '3fbf5360-4300-0133-af08-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '4ad376e0-4300-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"3fbf5360-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"d09fe1d2204714a781515f1816be7cdc\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:33:54' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"3fbf5360-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"d09fe1d2204714a781515f1816be7cdc\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:33:54' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 02:33:54' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451&&id=137
Completed 302 Found in 358ms (ActiveRecord: 11.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451&&id=137" for 127.0.0.1 at 2015-09-21 19:33:54 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"3fbf5360-4300-0133-af08-20c9d07c6451", "id"=>"137"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=3fbf5360-4300-0133-af08-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies" for 127.0.0.1 at 2015-09-21 19:34:10 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/tool_proxies"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (9.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (133.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (28.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (9.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (633.2ms)


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:35:20 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7b565550-4300-0133-af08-20c9d07c6451", "reg_key"=>"7b565050-4300-0133-af08-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.9ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 02:35:21', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '7b565050-4300-0133-af08-20c9d07c6451', 'd14efd4b15af49a08e5dae265d37ccf7', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7b565550-4300-0133-af08-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/3fc05300-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"7b565550-4300-0133-af08-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 02:35:21', '2')[0m
  [1m[35m (10.3ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=138&return_url=/lti2_tp/registrations
Completed 302 Found in 296ms (ActiveRecord: 12.7ms)


Started GET "/lti_registration_wips?registration_id=138&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-21 19:35:21 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"138", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '7b565050-4300-0133-af08-20c9d07c6451', `updated_at` = '2015-09-22 02:35:21' WHERE `lti2_tp_registrations`.`id` = 138[0m
  [1m[35m (1.9ms)[0m  COMMIT
  [1m[36m (0.8ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:35:21', 'Elan/LuMoS', 138, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '7b565050-4300-0133-af08-20c9d07c6451', '2015-09-22 02:35:21')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=138&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7b565550-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/182&consumer_key=7b565050-4300-0133-af08-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=138&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7b565550-4300-0133-af08-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/182&consumer_key=7b565050-4300-0133-af08-20c9d07c6451
Completed 302 Found in 110ms (ActiveRecord: 7.6ms)


Started GET "/lti_registration_wips/182" for 127.0.0.1 at 2015-09-21 19:35:22 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"182"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 182 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 02:35:22' WHERE `lti2_tp_registrations`.`id` = 138[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '7b565050-4300-0133-af08-20c9d07c6451' LIMIT 1
  [1m[36mSQL (1.6ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 02:35:22', '7b565050-4300-0133-af08-20c9d07c6451', '7b565050-4300-0133-af08-20c9d07c6451', '2015-09-22 02:35:22')[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (1.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '7f7fd800-4300-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"7b565050-4300-0133-af08-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/7b565550-4300-0133-af08-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"c5ffd74644e908379d7ba88b9f3482a5\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 02:35:23' WHERE `lti2_tp_registrations`.`id` = 138
  [1m[36m (3.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"7b565050-4300-0133-af08-20c9d07c6451\"}', `updated_at` = '2015-09-22 02:35:23' WHERE `lti2_tp_registrations`.`id` = 138[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.8ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '7b565050-4300-0133-af08-20c9d07c6451' AND `tenants`.`id` != 49) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `tenants` SET `secret` = 'c5ffd74644e908379d7ba88b9f3482a5', `updated_at` = '2015-09-22 02:35:23' WHERE `tenants`.`id` = 49[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = 'c5ffd74644e908379d7ba88b9f3482a5', `tenant_id` = 49, `updated_at` = '2015-09-22 02:35:23' WHERE `lti2_tp_registrations`.`id` = 138
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=7b565050-4300-0133-af08-20c9d07c6451&&id=138
Completed 302 Found in 639ms (ActiveRecord: 19.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=7b565050-4300-0133-af08-20c9d07c6451&&id=138" for 127.0.0.1 at 2015-09-21 19:35:23 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"7b565050-4300-0133-af08-20c9d07c6451", "id"=>"138"}
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=7b565050-4300-0133-af08-20c9d07c6451
Completed 302 Found in 19ms (ActiveRecord: 0.8ms)
  [1m[36mLti2Tp::Registry Load (0.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 07:08:27 -0700
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451", "reg_key"=>"4e05de20-4361-0133-af09-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[36mLti2Tp::Tool Load (0.6ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 14:08:30', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', '4e05de20-4361-0133-af09-20c9d07c6451', 'f03c2220469fbdc527874ab3e6ef2d9b', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"4e05e010-4361-0133-af09-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 14:08:30', '2')[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations
Completed 302 Found in 433ms (ActiveRecord: 15.9ms)


Started GET "/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 07:08:30 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"139", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '4e05de20-4361-0133-af09-20c9d07c6451', `updated_at` = '2015-09-22 14:08:30' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 14:08:30', 'Elan/LuMoS', 139, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '4e05de20-4361-0133-af09-20c9d07c6451', '2015-09-22 14:08:30')
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=139&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/183&consumer_key=4e05de20-4361-0133-af09-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=139&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/183&consumer_key=4e05de20-4361-0133-af09-20c9d07c6451
Completed 302 Found in 231ms (ActiveRecord: 6.3ms)


Started GET "/lti_registration_wips/183" for 127.0.0.1 at 2015-09-22 07:08:32 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"183"}
  [1m[35mLtiRegistrationWip Load (0.7ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 183 LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 14:08:32' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '4e05de20-4361-0133-af09-20c9d07c6451' LIMIT 1
  [1m[36mSQL (2.3ms)[0m  [1mINSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 14:08:32', '4e05de20-4361-0133-af09-20c9d07c6451', '4e05de20-4361-0133-af09-20c9d07c6451', '2015-09-22 14:08:32')[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '550f86c0-4361-0133-af05-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4e05de20-4361-0133-af09-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"688fb6ab0a6e778330263c122a841208\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 14:08:33' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (2.1ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"4e05de20-4361-0133-af09-20c9d07c6451\"}', `updated_at` = '2015-09-22 14:08:33' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mTenant Exists (0.7ms)[0m  SELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '4e05de20-4361-0133-af09-20c9d07c6451' AND `tenants`.`id` != 50) LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `tenants` SET `secret` = '688fb6ab0a6e778330263c122a841208', `updated_at` = '2015-09-22 14:08:33' WHERE `tenants`.`id` = 50[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `final_secret` = '688fb6ab0a6e778330263c122a841208', `tenant_id` = 50, `updated_at` = '2015-09-22 14:08:33' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451&&id=139
Completed 302 Found in 810ms (ActiveRecord: 24.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451&&id=139" for 127.0.0.1 at 2015-09-22 07:08:33 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"4e05de20-4361-0133-af09-20c9d07c6451", "id"=>"139"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-22 07:08:42 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"4e05de20-4361-0133-af09-20c9d07c6451", "oauth_nonce"=>"398434772121", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442930922", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"6NPMypAn+CETLQyoXoXQP/j3M1Y="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '4e05de20-4361-0133-af09-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.9ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 50  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
AuthHdr_Parms: {}
in verify_signature
  [1m[36mLti2Tp::Registration Load (0.8ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = '4e05de20-4361-0133-af09-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 50 LIMIT 1
  [1m[36mLti2Tp::Tool Load (0.7ms)[0m  [1mSELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '688fb6ab0a6e778330263c122a841208', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 14:08:42' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://localhost:4100/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations
Completed 302 Found in 248ms (ActiveRecord: 5.9ms)


Started GET "/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 07:08:42 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"139", "return_url"=>"/lti2_tp/registrations"}
  [1m[36mLti2Tp::Registration Load (0.9ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 14:08:42', 'Elan/LuMoS', 139, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '4e05de20-4361-0133-af09-20c9d07c6451', '2015-09-22 14:08:42')[0m
  [1m[35m (0.9ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=139&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/184&consumer_key=4e05de20-4361-0133-af09-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=139&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/184&consumer_key=4e05de20-4361-0133-af09-20c9d07c6451
Completed 302 Found in 52ms (ActiveRecord: 4.0ms)


Started GET "/lti_registration_wips/183" for 127.0.0.1 at 2015-09-22 07:08:44 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"183"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 183 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (1.0ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 14:08:44' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = '4e05de20-4361-0133-af09-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `lti2_tp_registrations` SET `end_registration_id` = '5c26edf0-4361-0133-af05-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4e05de20-4361-0133-af09-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"c41934c19ead71d8d09806331aaee60a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 14:08:44' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (1.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"4e05de20-4361-0133-af09-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/4e05e010-4361-0133-af09-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"c41934c19ead71d8d09806331aaee60a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 14:08:45' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 14:08:45' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451&&id=139
Completed 302 Found in 333ms (ActiveRecord: 12.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451&&id=139" for 127.0.0.1 at 2015-09-22 07:08:45 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"4e05de20-4361-0133-af09-20c9d07c6451", "id"=>"139"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=4e05de20-4361-0133-af09-20c9d07c6451
Completed 302 Found in 17ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies" for 127.0.0.1 at 2015-09-22 07:08:49 -0700

ActionController::RoutingError (No route matches [PUT] "/lti2_tp/tool_proxies"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (16.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (105.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (23.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (9.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (561.6ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.6ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 08:44:40 -0700
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451", "reg_key"=>"bfa75040-436e-0133-af0e-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "launch_presentation_document_target"=>"window"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `updated_at`, `user_id`) VALUES ('2015-09-22 15:44:41', 'http://rails.kinexis.com:4000/admin/tool_actions', 'LTI-2p0', 'registration', 'bfa75040-436e-0133-af0e-20c9d07c6451', '0cd15d56f36a6d14fec63d16284f55b4', 'received', 'http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/82675460-436b-0133-af0e-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://rails.kinexis.com:4000/tool_consumer_profiles/82675460-436b-0133-af0e-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"bfa752d0-436e-0133-af0e-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://rails.kinexis.com:4000/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '2015-09-22 15:44:41', '2')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=145&return_url=/lti2_tp/registrations
Completed 302 Found in 390ms (ActiveRecord: 14.0ms)


Started GET "/lti_registration_wips?registration_id=145&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 08:44:41 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"145", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'bfa75040-436e-0133-af0e-20c9d07c6451', `updated_at` = '2015-09-22 15:44:41' WHERE `lti2_tp_registrations`.`id` = 145
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 15:44:42', 'Elan/LuMoS', 145, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'bfa75040-436e-0133-af0e-20c9d07c6451', '2015-09-22 15:44:42')[0m
  [1m[35m (0.7ms)[0m  COMMIT
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=145&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/194&consumer_key=bfa75040-436e-0133-af0e-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=145&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/194&consumer_key=bfa75040-436e-0133-af0e-20c9d07c6451
Completed 302 Found in 187ms (ActiveRecord: 7.5ms)


Started GET "/lti_registration_wips/194" for 127.0.0.1 at 2015-09-22 08:44:43 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"194"}
  [1m[36mLtiRegistrationWip Load (0.6ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 194 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 15:44:44' WHERE `lti2_tp_registrations`.`id` = 145
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'bfa75040-436e-0133-af0e-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 15:44:44', 'bfa75040-436e-0133-af0e-20c9d07c6451', 'bfa75040-436e-0133-af0e-20c9d07c6451', '2015-09-22 15:44:44')
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'c4f95b70-436e-0133-af0f-20c9d07c6451', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bfa75040-436e-0133-af0e-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"87b1ac358476a3c0e632f5caeed3facb\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 15:44:44' WHERE `lti2_tp_registrations`.`id` = 145[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"bfa75040-436e-0133-af0e-20c9d07c6451\"}', `updated_at` = '2015-09-22 15:44:44' WHERE `lti2_tp_registrations`.`id` = 145
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'bfa75040-436e-0133-af0e-20c9d07c6451' AND `tenants`.`id` != 55) LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `tenants` SET `secret` = '87b1ac358476a3c0e632f5caeed3facb', `updated_at` = '2015-09-22 15:44:44' WHERE `tenants`.`id` = 55
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '87b1ac358476a3c0e632f5caeed3facb', `tenant_id` = 55, `updated_at` = '2015-09-22 15:44:44' WHERE `lti2_tp_registrations`.`id` = 145[0m
  [1m[35m (1.1ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451&&id=145
Completed 302 Found in 616ms (ActiveRecord: 17.9ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451&&id=145" for 127.0.0.1 at 2015-09-22 08:44:44 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"bfa75040-436e-0133-af0e-20c9d07c6451", "id"=>"145"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.7ms)


Started POST "/lti2_tp/reregistrations" for 127.0.0.1 at 2015-09-22 08:44:49 -0700
Processing by Lti2Tp::RegistrationsController#reregister as HTML
  Parameters: {"tc_profile_url"=>"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451", "launch_presentation_return_url"=>"http://rails.kinexis.com:4000/admin/tool_actions", "lti_message_type"=>"ToolProxyReregistrationRequest", "oauth_consumer_key"=>"bfa75040-436e-0133-af0e-20c9d07c6451", "oauth_nonce"=>"2588948548313", "oauth_signature_method"=>"HMAC-SHA1", "oauth_timestamp"=>"1442936689", "oauth_version"=>"1.0", "oauth_callback"=>"about:blank", "oauth_signature"=>"dsGMx0+I8Pd5tkY3koTiSgRlSsk="}
Can't verify CSRF token authenticity
AuthHdr_Parms: {}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 55  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`reg_key` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mTenant Load (0.6ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`id` = 55 LIMIT 1[0m
  [1m[35mLti2Tp::Tool Load (1.1ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`  WHERE `lti2_tp_tools`.`id` = 2 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `lti2_tp_registrations` SET `message_type` = 'reregistration', `reg_password` = '87b1ac358476a3c0e632f5caeed3facb', `status` = 'received', `tool_profile_json` = '{\"base_url_choice\":[{\"default_base_url\":\"http://rails.kinexis.com:4100\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://rails.kinexis.com:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://rails.kinexis.com:4100\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://rails.kinexis.com:4100/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://rails.kinexis.com:4100/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', `updated_at` = '2015-09-22 15:44:50' WHERE `lti2_tp_registrations`.`id` = 145
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:4100/lti_registration_wips?registration_id=145&return_url=/lti2_tp/registrations
Completed 302 Found in 413ms (ActiveRecord: 9.8ms)


Started GET "/lti_registration_wips?registration_id=145&return_url=/lti2_tp/registrations" for 127.0.0.1 at 2015-09-22 08:44:50 -0700
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"145", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2015-09-22 15:44:50', 'Elan/LuMoS', 145, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'bfa75040-436e-0133-af0e-20c9d07c6451', '2015-09-22 15:44:50')
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
RedirectUrl: http://localhost:8888/tool_provider_review?registration_id=145&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/195&consumer_key=bfa75040-436e-0133-af0e-20c9d07c6451
Redirected to http://localhost:8888/tool_provider_review?registration_id=145&status=received&tcp_uri=http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451&return_url=http://rails.kinexis.com:4100/lti_registration_wips/195&consumer_key=bfa75040-436e-0133-af0e-20c9d07c6451
Completed 302 Found in 56ms (ActiveRecord: 3.5ms)


Started GET "/lti_registration_wips/194" for 127.0.0.1 at 2015-09-22 08:44:52 -0700
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"194"}
  [1m[35mLtiRegistrationWip Load (0.6ms)[0m  SELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 194 LIMIT 1
  [1m[36mLti2Tp::Registration Load (1.1ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2015-09-22 15:44:52' WHERE `lti2_tp_registrations`.`id` = 145[0m
  [1m[35m (2.7ms)[0m  COMMIT
  [1m[36mTenant Load (0.9ms)[0m  [1mSELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'c9cfeb70-436e-0133-af0f-20c9d07c6451', `proposed_tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bfa75040-436e-0133-af0e-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"cba00267037d7cac6e274eccca803968\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 15:44:52' WHERE `lti2_tp_registrations`.`id` = 145[0m
  [1m[35m (1.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'reregister', `tool_proxy_json` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"bfa75040-436e-0133-af0e-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://rails.kinexis.com:4000/lti2_tc/tool_consumer_profiles/bfa752d0-436e-0133-af0e-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"cba00267037d7cac6e274eccca803968\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2015-09-22 15:44:52' WHERE `lti2_tp_registrations`.`id` = 145
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (1.2ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `status` = 'reregistered', `updated_at` = '2015-09-22 15:44:52' WHERE `lti2_tp_registrations`.`id` = 145[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://rails.kinexis.com:4100/lti2_tp/registrations?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451&&id=145
Completed 302 Found in 361ms (ActiveRecord: 14.1ms)


Started GET "/lti2_tp/registrations?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451&&id=145" for 127.0.0.1 at 2015-09-22 08:44:52 -0700
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_guid"=>"bfa75040-436e-0133-af0e-20c9d07c6451", "id"=>"145"}
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 145 LIMIT 1[0m
Redirected to http://rails.kinexis.com:4000/admin/tool_actions?status=success&tool_guid=bfa75040-436e-0133-af0e-20c9d07c6451
Completed 302 Found in 14ms (ActiveRecord: 0.7ms)


Started PUT "/lti2_tp/tool_proxies/bfa75040-436e-0133-af0e-20c9d07c6451?correlation=c9cfeb70-436e-0133-af0f-20c9d07c6451" for 127.0.0.1 at 2015-09-22 08:44:56 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"bfa75040-436e-0133-af0e-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"bfa75040-436e-0133-af0e-20c9d07c6451", :oauth_nonce=>"1283856259198", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1442936696", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jdIlOf6+bhMXuOaeJtChS2HGB54="}
  [1m[35mTenant Load (0.6ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.7ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 55  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"bfa75040-436e-0133-af0e-20c9d07c6451", :oauth_nonce=>"1283856259198", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1442936696", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jdIlOf6+bhMXuOaeJtChS2HGB54="}
in verify_signature
  [1m[35mLti2Tp::Registration Load (0.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_name` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1
  [1m[36mCACHE (0.3ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 55  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 791566ms (Views: 1.2ms | ActiveRecord: 2.5ms)


Started PUT "/lti2_tp/tool_proxies/bfa75040-436e-0133-af0e-20c9d07c6451?correlation=c9cfeb70-436e-0133-af0f-20c9d07c6451" for 127.0.0.1 at 2015-09-22 08:58:08 -0700
Processing by Lti2Tp::RegistrationsController#complete_reregistration as HTML
  Parameters: {"correlation"=>"c9cfeb70-436e-0133-af0f-20c9d07c6451", "id"=>"bfa75040-436e-0133-af0e-20c9d07c6451"}
Can't verify CSRF token authenticity
AuthHdr_Parms: {:oauth_consumer_key=>"bfa75040-436e-0133-af0e-20c9d07c6451", :oauth_nonce=>"1283856259198", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1442936696", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jdIlOf6+bhMXuOaeJtChS2HGB54="}
  [1m[35mTenant Load (0.7ms)[0m  SELECT  `tenants`.* FROM `tenants`  WHERE `tenants`.`tenant_key` = 'bfa75040-436e-0133-af0e-20c9d07c6451'  ORDER BY `tenants`.`id` ASC LIMIT 1
  [1m[36mLti2Tp::Registration Load (0.6ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`tenant_id` = 55  ORDER BY `lti2_tp_registrations`.`id` ASC LIMIT 1[0m
AuthHdr_Parms: {:oauth_consumer_key=>"bfa75040-436e-0133-af0e-20c9d07c6451", :oauth_nonce=>"1283856259198", :oauth_signature_method=>"HMAC-SHA1", :oauth_timestamp=>"1442936696", :oauth_version=>"1.0", :oauth_callback=>"about:blank", :oauth_signature=>"jdIlOf6+bhMXuOaeJtChS2HGB54="}
in verify_signature
Timestamp expired
Redirected to http://rails.kinexis.com:4100?status=failure&lti_errormsg=Invalid+signature&lti_errorlog=Invalid+signature
Completed 302 Found in 9098ms (ActiveRecord: 32.7ms)
  [1m[36mLti2Tp::Registry Load (20.5ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.5ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 07:20:37 -0800
  [1m[36mActiveRecord::SchemaMigration Load (16.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c375def0-a412-0133-b258-20c9d07c6451", "reg_key"=>"c375d5b0-a412-0133-b258-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"c6a43b40-a412-0133-b258-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (2.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (15.4ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-23 15:20:38', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'c375d5b0-a412-0133-b258-20c9d07c6451', '2fdead7ec3f5ff23f036a904bf218621', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c375def0-a412-0133-b258-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c375def0-a412-0133-b258-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis8888.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'c6a43b40-a412-0133-b258-20c9d07c6451', '2016-01-23 15:20:38', '2')
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis3001.ngrok.io/lti_registration_wips?registration_id=180&return_url=/lti2_tp/registrations
Completed 302 Found in 1174ms (ActiveRecord: 32.5ms)


Started GET "/lti_registration_wips?registration_id=180&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 07:20:39 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"180", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (2.8ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 180 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.9ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'c375d5b0-a412-0133-b258-20c9d07c6451', `updated_at` = '2016-01-23 15:20:39' WHERE `lti2_tp_registrations`.`id` = 180
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (3.2ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-23 15:20:39', 'Elan/LuMoS', 180, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'c375d5b0-a412-0133-b258-20c9d07c6451', '2016-01-23 15:20:39')[0m
  [1m[35m (0.6ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=180&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c375def0-a412-0133-b258-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/240&consumer_key=c375d5b0-a412-0133-b258-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=180&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c375def0-a412-0133-b258-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/240&consumer_key=c375d5b0-a412-0133-b258-20c9d07c6451
Completed 302 Found in 181ms (ActiveRecord: 17.2ms)


Started GET "/tool_provider_review?registration_id=180&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c375def0-a412-0133-b258-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/240&consumer_key=c375d5b0-a412-0133-b258-20c9d07c6451" for 74.95.0.173 at 2016-01-23 07:20:39 -0800

ActionController::RoutingError (No route matches [GET] "/tool_provider_review"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (9.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (63.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (13.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (10.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (506.2ms)
  [1m[36mLti2Tp::Registry Load (0.6ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 08:05:16 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/00158900-a419-0133-b258-20c9d07c6451", "reg_key"=>"001577e0-a419-0133-b258-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"0377b5a0-a419-0133-b258-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (22.7ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-23 16:05:17', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', '001577e0-a419-0133-b258-20c9d07c6451', 'f69da4248486b6bff74ef5a740458e9c', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/00158900-a419-0133-b258-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"00158900-a419-0133-b258-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis3001.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis3001.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis3001.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis3001.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '0377b5a0-a419-0133-b258-20c9d07c6451', '2016-01-23 16:05:17', '2')
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis3001.ngrok.io/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations
Completed 302 Found in 764ms (ActiveRecord: 54.0ms)


Started GET "/lti_registration_wips?registration_id=135&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 08:05:17 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"135", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '001577e0-a419-0133-b258-20c9d07c6451', `updated_at` = '2016-01-23 16:05:17' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-23 16:05:17', 'Elan/LuMoS', 135, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '001577e0-a419-0133-b258-20c9d07c6451', '2016-01-23 16:05:17')[0m
  [1m[35m (0.4ms)[0m  COMMIT
RedirectUrl: http://kinexis8888.ngrok.io/tool_provider_review?registration_id=135&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/00158900-a419-0133-b258-20c9d07c6451&return_url=http://kinexis3001.ngrok.io/lti_registration_wips/177&consumer_key=001577e0-a419-0133-b258-20c9d07c6451
Redirected to http://kinexis8888.ngrok.io/tool_provider_review?registration_id=135&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/00158900-a419-0133-b258-20c9d07c6451&return_url=http://kinexis3001.ngrok.io/lti_registration_wips/177&consumer_key=001577e0-a419-0133-b258-20c9d07c6451
Completed 302 Found in 37ms (ActiveRecord: 21.3ms)


Started GET "/lti_registration_wips/177" for 74.95.0.173 at 2016-01-23 08:05:21 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"177"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 177 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (4.2ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-23 16:05:21' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36mTenant Exists (23.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '001577e0-a419-0133-b258-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-23 16:05:21', '001577e0-a419-0133-b258-20c9d07c6451', '001577e0-a419-0133-b258-20c9d07c6451', '2016-01-23 16:05:21')
  [1m[36m (11.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (12.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '07889040-a419-0133-b25d-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"001577e0-a419-0133-b258-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/00158900-a419-0133-b258-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0a810709bba5caed08fd9129a8ce90c9\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-23 16:05:21' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (11.0ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (24.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"001577e0-a419-0133-b258-20c9d07c6451\"}', `updated_at` = '2016-01-23 16:05:22' WHERE `lti2_tp_registrations`.`id` = 135
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (2.8ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '001577e0-a419-0133-b258-20c9d07c6451' AND `tenants`.`id` != 46) LIMIT 1[0m
  [1m[35mSQL (2.2ms)[0m  UPDATE `tenants` SET `secret` = '0a810709bba5caed08fd9129a8ce90c9', `updated_at` = '2016-01-23 16:05:22' WHERE `tenants`.`id` = 46
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '0a810709bba5caed08fd9129a8ce90c9', `tenant_id` = 46, `updated_at` = '2016-01-23 16:05:22' WHERE `lti2_tp_registrations`.`id` = 135[0m
  [1m[35m (0.9ms)[0m  COMMIT
Redirected to http://kinexis3001.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=001577e0-a419-0133-b258-20c9d07c6451&&id=135
Completed 302 Found in 1626ms (ActiveRecord: 119.0ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=001577e0-a419-0133-b258-20c9d07c6451&&id=135" for 74.95.0.173 at 2016-01-23 08:05:22 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"001577e0-a419-0133-b258-20c9d07c6451", "id"=>"135"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 135 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=001577e0-a419-0133-b258-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)
  [1m[36mLti2Tp::Registry Load (0.8ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.3ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:24:58 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cc14ffc0-a45e-0133-b258-20c9d07c6451", "reg_key"=>"cc14fb30-a45e-0133-b258-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"d23adcb0-a45e-0133-b258-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.6ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (22.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 00:24:59', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'cc14fb30-a45e-0133-b258-20c9d07c6451', '74079af656930aa3d4061ca3f3120139', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cc14ffc0-a45e-0133-b258-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"cc14ffc0-a45e-0133-b258-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis8888.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'd23adcb0-a45e-0133-b258-20c9d07c6451', '2016-01-24 00:24:59', '2')
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=136&return_url=/lti2_tp/registrations
Completed 302 Found in 714ms (ActiveRecord: 47.2ms)


Started GET "/lti_registration_wips?registration_id=136&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:24:59 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"136", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'cc14fb30-a45e-0133-b258-20c9d07c6451', `updated_at` = '2016-01-24 00:24:59' WHERE `lti2_tp_registrations`.`id` = 136
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:24:59', 'Elan/LuMoS', 136, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'cc14fb30-a45e-0133-b258-20c9d07c6451', '2016-01-24 00:24:59')[0m
  [1m[35m (0.4ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=136&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cc14ffc0-a45e-0133-b258-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/178&consumer_key=cc14fb30-a45e-0133-b258-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=136&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cc14ffc0-a45e-0133-b258-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/178&consumer_key=cc14fb30-a45e-0133-b258-20c9d07c6451
Completed 302 Found in 44ms (ActiveRecord: 23.0ms)


Started GET "/lti_registration_wips/178" for 74.95.0.173 at 2016-01-23 16:25:02 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"178"}
  [1m[36mLtiRegistrationWip Load (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 178 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.2ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 00:25:03' WHERE `lti2_tp_registrations`.`id` = 136
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'cc14fb30-a45e-0133-b258-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:25:03', 'cc14fb30-a45e-0133-b258-20c9d07c6451', 'cc14fb30-a45e-0133-b258-20c9d07c6451', '2016-01-24 00:25:03')
  [1m[36m (11.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (12.7ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd6053d70-a45e-0133-b25e-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9f4b11f0-a1f5-0133-b258-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"cc14fb30-a45e-0133-b258-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cc14ffc0-a45e-0133-b258-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"24c64a88864847f59a67b1e3b68ee47a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 00:25:03' WHERE `lti2_tp_registrations`.`id` = 136[0m
  [1m[35m (5.1ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (12.2ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"cc14fb30-a45e-0133-b258-20c9d07c6451\"}', `updated_at` = '2016-01-24 00:25:04' WHERE `lti2_tp_registrations`.`id` = 136
  [1m[36m (16.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'cc14fb30-a45e-0133-b258-20c9d07c6451' AND `tenants`.`id` != 47) LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `tenants` SET `secret` = '24c64a88864847f59a67b1e3b68ee47a', `updated_at` = '2016-01-24 00:25:04' WHERE `tenants`.`id` = 47
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '24c64a88864847f59a67b1e3b68ee47a', `tenant_id` = 47, `updated_at` = '2016-01-24 00:25:04' WHERE `lti2_tp_registrations`.`id` = 136[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=cc14fb30-a45e-0133-b258-20c9d07c6451&&id=136
Completed 302 Found in 1388ms (ActiveRecord: 84.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=cc14fb30-a45e-0133-b258-20c9d07c6451&&id=136" for 74.95.0.173 at 2016-01-23 16:25:04 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"cc14fb30-a45e-0133-b258-20c9d07c6451", "id"=>"136"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 136 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=cc14fb30-a45e-0133-b258-20c9d07c6451
Completed 302 Found in 3ms (ActiveRecord: 0.5ms)


Started POST "/echo" for 127.0.0.1 at 2016-01-23 16:25:26 -0800

ActionController::RoutingError (No route matches [POST] "/echo"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (6.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (184.7ms)


Started POST "/ndar" for 127.0.0.1 at 2016-01-23 16:28:27 -0800

ActionController::RoutingError (No route matches [POST] "/ndar"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (145.1ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:31:48 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451", "reg_key"=>"c2624660-a45f-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"c69cb4e0-a45f-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.3ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 00:31:48', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'c2624660-a45f-0133-b25f-20c9d07c6451', '81ff3417b17ba9ae0c5df829e3108072', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"c2634b50-a45f-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis8888.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'c69cb4e0-a45f-0133-b25f-20c9d07c6451', '2016-01-24 00:31:48', '2')
  [1m[36m (17.8ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations
Completed 302 Found in 340ms (ActiveRecord: 52.2ms)


Started GET "/lti_registration_wips?registration_id=137&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:31:48 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"137", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'c2624660-a45f-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 00:31:48' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:31:48', 'Elan/LuMoS', 137, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'c2624660-a45f-0133-b25f-20c9d07c6451', '2016-01-24 00:31:48')[0m
  [1m[35m (0.3ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=137&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/179&consumer_key=c2624660-a45f-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=137&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/179&consumer_key=c2624660-a45f-0133-b25f-20c9d07c6451
Completed 302 Found in 38ms (ActiveRecord: 21.9ms)


Started GET "/lti_registration_wips/179" for 74.95.0.173 at 2016-01-23 16:31:57 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"179"}
  [1m[36mLtiRegistrationWip Load (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 179 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 00:31:57' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (2.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'c2624660-a45f-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:31:57', 'c2624660-a45f-0133-b25f-20c9d07c6451', 'c2624660-a45f-0133-b25f-20c9d07c6451', '2016-01-24 00:31:57')
  [1m[36m (6.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'cca5d450-a45f-0133-b260-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"c2624660-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"b60ddeb1696e9233233d08d50a8eeb9e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 00:31:57' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (11.8ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"c2624660-a45f-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 00:31:57' WHERE `lti2_tp_registrations`.`id` = 137
  [1m[36m (11.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'c2624660-a45f-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 48) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `tenants` SET `secret` = 'b60ddeb1696e9233233d08d50a8eeb9e', `updated_at` = '2016-01-24 00:31:57' WHERE `tenants`.`id` = 48
  [1m[36m (5.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = 'b60ddeb1696e9233233d08d50a8eeb9e', `tenant_id` = 48, `updated_at` = '2016-01-24 00:31:58' WHERE `lti2_tp_registrations`.`id` = 137[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=c2624660-a45f-0133-b25f-20c9d07c6451&&id=137
Completed 302 Found in 947ms (ActiveRecord: 64.2ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=c2624660-a45f-0133-b25f-20c9d07c6451&&id=137" for 74.95.0.173 at 2016-01-23 16:31:58 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"c2624660-a45f-0133-b25f-20c9d07c6451", "id"=>"137"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 137 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=c2624660-a45f-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)


Started POST "/ndar" for 127.0.0.1 at 2016-01-23 16:32:19 -0800

ActionController::RoutingError (No route matches [POST] "/ndar"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (7.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (182.2ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`
  [1m[36mLti2Tp::Registry Load (0.2ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.3ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:37:54 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9d472c10-a460-0133-b25f-20c9d07c6451", "reg_key"=>"9d472980-a460-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"a0edb6f0-a460-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.9ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 00:37:54', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', '9d472980-a460-0133-b25f-20c9d07c6451', '8a4c77050f5c57a1b72241eea2d2d18c', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9d472c10-a460-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"9d472c10-a460-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'a0edb6f0-a460-0133-b25f-20c9d07c6451', '2016-01-24 00:37:54', '2')
  [1m[36m (12.5ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=138&return_url=/lti2_tp/registrations
Completed 302 Found in 332ms (ActiveRecord: 35.2ms)


Started GET "/lti_registration_wips?registration_id=138&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 16:37:55 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"138", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '9d472980-a460-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 00:37:55' WHERE `lti2_tp_registrations`.`id` = 138
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:37:55', 'Elan/LuMoS', 138, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '9d472980-a460-0133-b25f-20c9d07c6451', '2016-01-24 00:37:55')[0m
  [1m[35m (1.3ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=138&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9d472c10-a460-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/180&consumer_key=9d472980-a460-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=138&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9d472c10-a460-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/180&consumer_key=9d472980-a460-0133-b25f-20c9d07c6451
Completed 302 Found in 39ms (ActiveRecord: 16.4ms)


Started GET "/lti_registration_wips/180" for 74.95.0.173 at 2016-01-23 16:37:57 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"180"}
  [1m[36mLtiRegistrationWip Load (0.3ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 180 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.5ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 00:37:58' WHERE `lti2_tp_registrations`.`id` = 138
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36mTenant Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '9d472980-a460-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 00:37:58', '9d472980-a460-0133-b25f-20c9d07c6451', '9d472980-a460-0133-b25f-20c9d07c6451', '2016-01-24 00:37:58')
  [1m[36m (10.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (1.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'a3a37710-a460-0133-b261-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"9d472980-a460-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/9d472c10-a460-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"0d403df877e4daa6875d86917c601f63\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 00:37:58' WHERE `lti2_tp_registrations`.`id` = 138[0m
  [1m[35m (11.9ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"9d472980-a460-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 00:37:58' WHERE `lti2_tp_registrations`.`id` = 138
  [1m[36m (11.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '9d472980-a460-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 49) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `tenants` SET `secret` = '0d403df877e4daa6875d86917c601f63', `updated_at` = '2016-01-24 00:37:58' WHERE `tenants`.`id` = 49
  [1m[36m (4.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '0d403df877e4daa6875d86917c601f63', `tenant_id` = 49, `updated_at` = '2016-01-24 00:37:58' WHERE `lti2_tp_registrations`.`id` = 138[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=9d472980-a460-0133-b25f-20c9d07c6451&&id=138
Completed 302 Found in 841ms (ActiveRecord: 53.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=9d472980-a460-0133-b25f-20c9d07c6451&&id=138" for 74.95.0.173 at 2016-01-23 16:37:58 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"9d472980-a460-0133-b25f-20c9d07c6451", "id"=>"138"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 138 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=9d472980-a460-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started POST "/ndar" for 127.0.0.1 at 2016-01-23 16:38:11 -0800

ActionController::RoutingError (No route matches [POST] "/ndar"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (166.0ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:02:32 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/0dfd4640-a464-0133-b25f-20c9d07c6451", "reg_key"=>"0dfd3390-a464-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"11a1b7f0-a464-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.4ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.8ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 01:02:33', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', '0dfd3390-a464-0133-b25f-20c9d07c6451', 'eda7303444de38638fa35b18154683fb', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/0dfd4640-a464-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"0dfd4640-a464-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '11a1b7f0-a464-0133-b25f-20c9d07c6451', '2016-01-24 01:02:33', '2')
  [1m[36m (24.9ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations
Completed 302 Found in 726ms (ActiveRecord: 53.2ms)


Started GET "/lti_registration_wips?registration_id=139&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:02:33 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"139", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.5ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.2ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = '0dfd3390-a464-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 01:02:33' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:02:33', 'Elan/LuMoS', 139, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', '0dfd3390-a464-0133-b25f-20c9d07c6451', '2016-01-24 01:02:33')[0m
  [1m[35m (1.9ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=139&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/0dfd4640-a464-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/181&consumer_key=0dfd3390-a464-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=139&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/0dfd4640-a464-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/181&consumer_key=0dfd3390-a464-0133-b25f-20c9d07c6451
Completed 302 Found in 47ms (ActiveRecord: 25.9ms)


Started GET "/lti_registration_wips/181" for 74.95.0.173 at 2016-01-23 17:02:35 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"181"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 181 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://localhost:8888\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 01:02:36' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY '0dfd3390-a464-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:02:36', '0dfd3390-a464-0133-b25f-20c9d07c6451', '0dfd3390-a464-0133-b25f-20c9d07c6451', '2016-01-24 01:02:36')
  [1m[36m (6.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (6.3ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '14ed06d0-a464-0133-b262-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"0dfd3390-a464-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/0dfd4640-a464-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://localhost:8888\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"60c6939b2f3d1335fde2c1c3f078d89a\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 01:02:36' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (10.7ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"0dfd3390-a464-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 01:02:37' WHERE `lti2_tp_registrations`.`id` = 139
  [1m[36m (9.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY '0dfd3390-a464-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 50) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `tenants` SET `secret` = '60c6939b2f3d1335fde2c1c3f078d89a', `updated_at` = '2016-01-24 01:02:37' WHERE `tenants`.`id` = 50
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '60c6939b2f3d1335fde2c1c3f078d89a', `tenant_id` = 50, `updated_at` = '2016-01-24 01:02:37' WHERE `lti2_tp_registrations`.`id` = 139[0m
  [1m[35m (0.7ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=0dfd3390-a464-0133-b25f-20c9d07c6451&&id=139
Completed 302 Found in 1291ms (ActiveRecord: 66.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=0dfd3390-a464-0133-b25f-20c9d07c6451&&id=139" for 74.95.0.173 at 2016-01-23 17:02:37 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"0dfd3390-a464-0133-b25f-20c9d07c6451", "id"=>"139"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 139 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=0dfd3390-a464-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:15:07 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cffd1ef0-a465-0133-b25f-20c9d07c6451", "reg_key"=>"cffd1c70-a465-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"d41c4a80-a465-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 01:15:08', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'cffd1c70-a465-0133-b25f-20c9d07c6451', 'f715880c3345db90a311719890b257ca', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cffd1ef0-a465-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"cffd1ef0-a465-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'd41c4a80-a465-0133-b25f-20c9d07c6451', '2016-01-24 01:15:08', '2')
  [1m[36m (12.3ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=140&return_url=/lti2_tp/registrations
Completed 302 Found in 321ms (ActiveRecord: 42.4ms)


Started GET "/lti_registration_wips?registration_id=140&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:15:08 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"140", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 140 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'cffd1c70-a465-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 01:15:08' WHERE `lti2_tp_registrations`.`id` = 140
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:15:08', 'Elan/LuMoS', 140, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'cffd1c70-a465-0133-b25f-20c9d07c6451', '2016-01-24 01:15:08')[0m
  [1m[35m (0.3ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=140&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cffd1ef0-a465-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/182&consumer_key=cffd1c70-a465-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=140&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cffd1ef0-a465-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/182&consumer_key=cffd1c70-a465-0133-b25f-20c9d07c6451
Completed 302 Found in 36ms (ActiveRecord: 21.8ms)


Started GET "/lti_registration_wips/182" for 74.95.0.173 at 2016-01-23 17:15:10 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"182"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 182 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 140 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"{lti_tool_provider_url}\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://localhost:4100/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://localhost:8888\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://localhost:8888/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://localhost:8888/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 01:15:11' WHERE `lti2_tp_registrations`.`id` = 140
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'cffd1c70-a465-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:15:11', 'cffd1c70-a465-0133-b25f-20c9d07c6451', 'cffd1c70-a465-0133-b25f-20c9d07c6451', '2016-01-24 01:15:11')
  [1m[36m (11.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'd6a10090-a465-0133-b263-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"cffd1c70-a465-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/cffd1ef0-a465-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"{lti_tool_provider_url}\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://localhost:4100/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://localhost:8888\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://localhost:8888/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://localhost:8888/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"7e6aef42738353f461a952a58203042e\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 01:15:11' WHERE `lti2_tp_registrations`.`id` = 140[0m
  [1m[35m (6.5ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"cffd1c70-a465-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 01:15:11' WHERE `lti2_tp_registrations`.`id` = 140
  [1m[36m (12.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'cffd1c70-a465-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 51) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `tenants` SET `secret` = '7e6aef42738353f461a952a58203042e', `updated_at` = '2016-01-24 01:15:11' WHERE `tenants`.`id` = 51
  [1m[36m (4.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '7e6aef42738353f461a952a58203042e', `tenant_id` = 51, `updated_at` = '2016-01-24 01:15:11' WHERE `lti2_tp_registrations`.`id` = 140[0m
  [1m[35m (0.6ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=cffd1c70-a465-0133-b25f-20c9d07c6451&&id=140
Completed 302 Found in 885ms (ActiveRecord: 61.3ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=cffd1c70-a465-0133-b25f-20c9d07c6451&&id=140" for 74.95.0.173 at 2016-01-23 17:15:11 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"cffd1c70-a465-0133-b25f-20c9d07c6451", "id"=>"140"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 140 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=cffd1c70-a465-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:22:37 -0800
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/dcd20970-a466-0133-b25f-20c9d07c6451", "reg_key"=>"dcd206c0-a466-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"e0392e00-a466-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.5ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 01:22:38', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'dcd206c0-a466-0133-b25f-20c9d07c6451', '1a9b1a7bef5ef2488ebbdab97153f41a', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/dcd20970-a466-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"dcd20970-a466-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', 'e0392e00-a466-0133-b25f-20c9d07c6451', '2016-01-24 01:22:38', '2')
  [1m[36m (14.5ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=141&return_url=/lti2_tp/registrations
Completed 302 Found in 616ms (ActiveRecord: 15.7ms)


Started GET "/lti_registration_wips?registration_id=141&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:22:38 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"141", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.7ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 141 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'dcd206c0-a466-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 01:22:38' WHERE `lti2_tp_registrations`.`id` = 141
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:22:38', 'Elan/LuMoS', 141, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'dcd206c0-a466-0133-b25f-20c9d07c6451', '2016-01-24 01:22:38')[0m
  [1m[35m (0.4ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=141&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/dcd20970-a466-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/183&consumer_key=dcd206c0-a466-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=141&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/dcd20970-a466-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/183&consumer_key=dcd206c0-a466-0133-b25f-20c9d07c6451
Completed 302 Found in 9ms (ActiveRecord: 2.8ms)


Started GET "/lti_registration_wips/183" for 74.95.0.173 at 2016-01-23 17:22:41 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"183"}
  [1m[36mLtiRegistrationWip Load (0.4ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 183 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.6ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 141 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"{lti_tool_provider_url}\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"http://kinexis3001.ngrok.io\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"http://kinexis3001.ngrok.io/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"http://kinexis3001.ngrok.io/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 01:22:41' WHERE `lti2_tp_registrations`.`id` = 141
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'dcd206c0-a466-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:22:41', 'dcd206c0-a466-0133-b25f-20c9d07c6451', 'dcd206c0-a466-0133-b25f-20c9d07c6451', '2016-01-24 01:22:41')
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (2.1ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = 'e336e260-a466-0133-b263-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"dcd206c0-a466-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/dcd20970-a466-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"{lti_tool_provider_url}\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis3001.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis3001.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis3001.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"66e75cfd459bc82eecc2224b5ce9cd38\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 01:22:41' WHERE `lti2_tp_registrations`.`id` = 141[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"dcd206c0-a466-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 01:22:42' WHERE `lti2_tp_registrations`.`id` = 141
  [1m[36m (5.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'dcd206c0-a466-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 52) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE `tenants` SET `secret` = '66e75cfd459bc82eecc2224b5ce9cd38', `updated_at` = '2016-01-24 01:22:42' WHERE `tenants`.`id` = 52
  [1m[36m (11.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '66e75cfd459bc82eecc2224b5ce9cd38', `tenant_id` = 52, `updated_at` = '2016-01-24 01:22:42' WHERE `lti2_tp_registrations`.`id` = 141[0m
  [1m[35m (2.2ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=dcd206c0-a466-0133-b25f-20c9d07c6451&&id=141
Completed 302 Found in 1192ms (ActiveRecord: 27.7ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=dcd206c0-a466-0133-b25f-20c9d07c6451&&id=141" for 74.95.0.173 at 2016-01-23 17:22:42 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"dcd206c0-a466-0133-b25f-20c9d07c6451", "id"=>"141"}
  [1m[36mLti2Tp::Registration Load (0.5ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 141 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=dcd206c0-a466-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)


Started POST "/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:23:35 -0800
Processing by Lti2Tp::RegistrationsController#create as HTML
  Parameters: {"lti_message_type"=>"ToolProxyRegistrationRequest", "lti_version"=>"LTI-2p0", "user_id"=>"2", "roles"=>"urn:lti:sysrole:ims/lis/SysAdmin", "tc_profile_url"=>"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/ffb568e0-a466-0133-b25f-20c9d07c6451", "reg_key"=>"ffb565e0-a466-0133-b25f-20c9d07c6451", "reg_password"=>"[FILTERED]", "launch_presentation_return_url"=>"http://kinexis3000.ngrok.io/admin/tool_actions", "launch_presentation_document_target"=>"window", "tool_proxy_guid"=>"02bf9100-a467-0133-b25f-20c9d07c6451"}
  [1m[35mLti2Tp::Tool Load (0.4ms)[0m  SELECT  `lti2_tp_tools`.* FROM `lti2_tp_tools`   ORDER BY `lti2_tp_tools`.`id` ASC LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `lti2_tp_registrations` (`created_at`, `launch_presentation_return_url`, `lti_version`, `message_type`, `reg_key`, `reg_password`, `status`, `tc_profile_url`, `tenant_basename`, `tenant_name`, `tool_consumer_profile_json`, `tool_id`, `tool_profile_json`, `tool_proxy_guid`, `updated_at`, `user_id`) VALUES ('2016-01-24 01:23:35', 'http://kinexis3000.ngrok.io/admin/tool_actions', 'LTI-2p0', 'registration', 'ffb565e0-a466-0133-b25f-20c9d07c6451', '9c1c58e03bbd6340d2967e0aeded6a57', 'received', 'http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/ffb568e0-a466-0133-b25f-20c9d07c6451', 'Elan University', 'Elan University', '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolConsumerProfile\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolConsumerProfile\",\"@id\":\"http://kinexis3000.ngrok.io/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"guid\":\"ffb568e0-a466-0133-b25f-20c9d07c6451\",\"product_instance\":{\"guid\":\"dcddf9808107-81ea-eaa4-1edf-5d24568c\",\"product_info\":{\"product_name\":{\"default_value\":\"Elan/LuMoS\",\"key\":\"product.name\"},\"product_version\":\"3.1\",\"description\":{\"default_value\":\"Elan University/LuMoS Learning Platform\",\"key\":\"product.version\"},\"technical_description\":{\"default_value\":\"LTI 1, 1.1 and 2.0 compliant\",\"key\":\"product.technicalDescription\"},\"product_family\":{\"code\":\"LuMoS\",\"vendor\":{\"code\":\"lms.LuMoS.org\",\"vendor_name\":{\"default_value\":\"LuMoS Corporation\",\"key\":\"product.vendor.name\"},\"description\":{\"default_value\":\"LuMoS Corporation is a fictitious vendor of a Learning Management System\",\"key\":\"product.vendor.description\"},\"website\":\"http://lms.LuMoS.org/products/omega\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"contact\":{\"email\":\"support@lms.LuMoS.org\"}}}},\"support\":{\"email\":\"john.tibbetts@kinexis.com\"},\"service_owner\":{\"@id\":\"http://ec2.LuMoS.org/ServiceOwner\",\"timestamp\":\"2012-03-28T09:08:16-04:00\",\"service_owner_name\":{\"default_value\":\"Elan University\",\"key\":\"service_owner.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_owner.description\"},\"support\":{\"email\":\"techsupport@elan.edu\"}},\"service_provider\":{\"@id\":\"http://ec2.LuMoS.org/ServiceProvider\",\"guid\":\"ec2.LuMoS.org\",\"timestamp\":\"2012-07-09T012:08:16-04:00\",\"service_provider_name\":{\"default_value\":\"Elan University\",\"key\":\"service_provider.name\"},\"description\":{\"default_value\":\"Elan University EC2 Cloud\",\"key\":\"service_provider.description\"},\"support\":{\"email\":\"support@yasp.LuMoS.org\"}}},\"capability_offered\":[\"basic-lti-launch-request\",\"Result.autocreate\",\"Result.sourcedId\",\"Result.uri\",\"User.id\",\"User.username\",\"Context.id\",\"CourseOffering.label\",\"CourseSection.sourcedId\",\"Person.sourcedId\",\"Person.email.primary\",\"Person.name.given\",\"Person.name.family\",\"Person.name.full\",\"Membership.role\",\"ToolProxy.custom.url\",\"ToolProxyBinding.custom.url\",\"LtiLink.custom.url\",\"ToolConsumerProfile.url\"],\"service_offered\":[{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.collection\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"POST\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxy.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tools/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolproxy+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:Result.item\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/resources/Result/{sourcedId}\",\"format\":[\"application/vnd.ims.lis.v2.result+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:LtiLinkSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/ltilink/{link_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxyBindingSettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}/context/{context_id}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestService\",\"@id\":\"ltitcp:ToolProxySettings\",\"endpoint\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_settings/{tool_proxy_guid}\",\"format\":[\"application/vnd.ims.lti.v2.toolsettings+json\",\"application/vnd.ims.lti.v2.toolsettings.simple+json\"],\"action\":[\"GET\",\"PUT\"]}]}', 2, '{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"http://kinexis8888.ngrok.io\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"Echo\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"http://kinexis8888.ngrok.io/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"http://kinexis8888.ngrok.io/lti2_tp/tool_proxies\",\"format\":[\"\"]}]}', '02bf9100-a467-0133-b25f-20c9d07c6451', '2016-01-24 01:23:35', '2')
  [1m[36m (6.0ms)[0m  [1mCOMMIT[0m
Redirected to http://kinexis8888.ngrok.io/lti_registration_wips?registration_id=142&return_url=/lti2_tp/registrations
Completed 302 Found in 223ms (ActiveRecord: 7.1ms)


Started GET "/lti_registration_wips?registration_id=142&return_url=/lti2_tp/registrations" for 74.95.0.173 at 2016-01-23 17:23:35 -0800
Processing by LtiRegistrationWipsController#index as HTML
  Parameters: {"registration_id"=>"142", "return_url"=>"/lti2_tp/registrations"}
  [1m[35mLti2Tp::Registration Load (0.3ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 142 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_proxy_guid` = 'ffb565e0-a466-0133-b25f-20c9d07c6451', `updated_at` = '2016-01-24 01:23:35' WHERE `lti2_tp_registrations`.`id` = 142
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `lti_registration_wips` (`created_at`, `product_name`, `registration_id`, `registration_return_url`, `support_email`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:23:35', 'Elan/LuMoS', 142, '/lti2_tp/registrations', 'john.tibbetts@kinexis.com', 'ffb565e0-a466-0133-b25f-20c9d07c6451', '2016-01-24 01:23:35')[0m
  [1m[35m (0.5ms)[0m  COMMIT
RedirectUrl: http://kinexis3001.ngrok.io/tool_provider_review?registration_id=142&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/ffb568e0-a466-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/184&consumer_key=ffb565e0-a466-0133-b25f-20c9d07c6451
Redirected to http://kinexis3001.ngrok.io/tool_provider_review?registration_id=142&message_type=registration&tcp_uri=http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/ffb568e0-a466-0133-b25f-20c9d07c6451&return_url=http://kinexis8888.ngrok.io/lti_registration_wips/184&consumer_key=ffb565e0-a466-0133-b25f-20c9d07c6451
Completed 302 Found in 9ms (ActiveRecord: 2.8ms)


Started GET "/lti_registration_wips/184" for 74.95.0.173 at 2016-01-23 17:23:37 -0800
Processing by LtiRegistrationWipsController#show as HTML
  Parameters: {"id"=>"184"}
  [1m[36mLtiRegistrationWip Load (0.5ms)[0m  [1mSELECT  `lti_registration_wips`.* FROM `lti_registration_wips`  WHERE `lti_registration_wips`.`id` = 184 LIMIT 1[0m
  [1m[35mLti2Tp::Registration Load (0.4ms)[0m  SELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 142 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `lti2_tp_registrations` SET `tool_profile_json` = '{\n    \"base_url_choice\": [\n        {\n            \"default_base_url\": \"http://kinexis3001.ngrok.io\",\n            \"selector\": {\n                \"applies_to\": [\n                    \"IconEndpoint\",\n                    \"MessageHandler\"\n                ]\n            }\n        }\n    ],\n    \"lti_version\": \"LTI-2p0\",\n    \"message\": [\n        {\n            \"message_type\": [\n                \"ToolProxyRegistrationRequest\",\n                \"ToolProxyReregistrationRequest\"\n            ],\n            \"parameter\": [\n                {\n                    \"name\": \"tc_profile_url\",\n                    \"variable\": \"ToolConsumerProfile.url\"\n                }\n            ],\n            \"path\": \"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"\n        }\n    ],\n    \"product_instance\": {\n        \"guid\": \"fd75124a-140e-470f-944c-114d2d92bb40\",\n        \"product_info\": {\n            \"description\": {\n                \"default_value\": \"New Deal Art Registry\",\n                \"key\": \"tool.description\"\n            },\n            \"product_family\": {\n                \"code\": \"assessment-tool\",\n                \"vendor\": {\n                    \"code\": \"fabericious.org\",\n                    \"contact\": {\n                        \"email\": \"barbara.bernstein@kinexis.com\"\n                    },\n                    \"description\": {\n                        \"default_value\": \"Access to New Deal Art sites\",\n                        \"key\": \"tool.vendor.description\"\n                    },\n                    \"vendor_name\": {\n                        \"default_value\": \"Ndar\",\n                        \"key\": \"tool.vendor.name\"\n                    },\n                    \"timestamp\": \"2012-04-05T09:08:16-04:00\",\n                    \"website\": \"{tp_deployment_url}\"\n                }\n            },\n            \"product_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"tool.name\"\n            },\n            \"product_version\": \"10.3\",\n            \"technical_description\": {\n                \"default_value\": \"Support provided for all LTI 1 extensions as well as LTI 2\",\n                \"key\": \"tool.technical\"\n            }\n        },\n        \"service_provider\": {\n            \"description\": {\n                \"default_value\": \"Provider of high performance managed hosting environments\",\n                \"key\": \"service_provider.description\"\n            },\n            \"guid\": \"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\n            \"service_provider_name\": {\n                \"default_value\": \"Amazon Cloud\",\n                \"key\": \"service_provider.name\"\n            },\n            \"support\": {\n                \"email\": \"support@ec2.fabericious.com\"\n            },\n            \"timestamp\": \"2012-04-05T09:08:16-04:00\"\n        },\n        \"support\": {\n            \"email\": \"helpdesk@fabericious.com\"\n        }\n    },\n    \"resource_handler\": [\n        {\n            \"description\": {\n                \"default_value\": \"Ndar service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n                    \"path\": \"/ndar\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"NDAR\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"setting\"\n            }\n        },\n        {\n            \"description\": {\n                \"default_value\": \"Echo service\",\n                \"key\": \"resource.description\"\n            },\n            \"message\": [\n                {\n                    \"message_type\": \"basic-lti-launch-request\",\n                    \"parameter\": [\n                        {\n                            \"fixed\": \"Narcissus\",\n                            \"name\": \"referrer\"\n                        },\n                        {\n                            \"fixed\": \"3.14159\",\n                            \"name\": \"pi\"\n                        },\n                        {\n                            \"name\": \"user_primary_email\",\n                            \"variable\": \"Person.email.primary\"\n                        }\n                    ],\n					\"enabled_capability\": [\n						\"User.id\",\n						\"Membership.role\",\n						\"Person.name.family\",\n						\"Person.name.given\",\n						\"Person.email.primary\"\n					],\n\n                    \"path\": \"/echo\"\n                }\n            ],\n            \"resource_name\": {\n                \"default_value\": \"EchoPHP\",\n                \"key\": \"resource.name\"\n            },\n            \"resource_type\": {\n                \"code\": \"echo\"\n            }\n        }\n    ],\n    \"service_offered\": [\n        {\n            \"@id\": \"{tp_deployment_url}/lti2_tp/ToolProxy.collection\",\n            \"@type\": \"RestService\",\n            \"action\": [\n                \"PUT\"\n            ],\n            \"endpoint\": \"{tp_deployment_url}/lti2_tp/tool_proxies\",\n            \"format\": [\n                \"\"\n            ]\n        }\n    ]\n}\n', `updated_at` = '2016-01-24 01:23:38' WHERE `lti2_tp_registrations`.`id` = 142
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mTenant Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE `tenants`.`tenant_name` = BINARY 'ffb565e0-a466-0133-b25f-20c9d07c6451' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `tenants` (`created_at`, `tenant_key`, `tenant_name`, `updated_at`) VALUES ('2016-01-24 01:23:38', 'ffb565e0-a466-0133-b25f-20c9d07c6451', 'ffb565e0-a466-0133-b25f-20c9d07c6451', '2016-01-24 01:23:38')
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `end_registration_id` = '04c51180-a467-0133-b263-20c9d07c6451', `tool_proxy_json` = '{\"@context\":[\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxy\",{\"ltitcp\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/c2634b50-a45f-0133-b25f-20c9d07c6451#\"}],\"@type\":\"ToolProxy\",\"tool_proxy_guid\":\"ffb565e0-a466-0133-b25f-20c9d07c6451\",\"lti_version\":\"LTI-2p0\",\"tool_consumer_profile\":\"http://kinexis3000.ngrok.io/lti2_tc/tool_consumer_profiles/ffb568e0-a466-0133-b25f-20c9d07c6451\",\"tool_profile\":{\"base_url_choice\":[{\"default_base_url\":\"http://kinexis3001.ngrok.io\",\"selector\":{\"applies_to\":[\"IconEndpoint\",\"MessageHandler\"]}}],\"lti_version\":\"LTI-2p0\",\"message\":[{\"message_type\":[\"ToolProxyRegistrationRequest\",\"ToolProxyReregistrationRequest\"],\"parameter\":[{\"name\":\"tc_profile_url\",\"variable\":\"ToolConsumerProfile.url\"}],\"path\":\"http://kinexis8888.ngrok.io/lti2_tp/reregistrations\"}],\"product_instance\":{\"guid\":\"fd75124a-140e-470f-944c-114d2d92bb40\",\"product_info\":{\"description\":{\"default_value\":\"New Deal Art Registry\",\"key\":\"tool.description\"},\"product_family\":{\"code\":\"assessment-tool\",\"vendor\":{\"code\":\"fabericious.org\",\"contact\":{\"email\":\"barbara.bernstein@kinexis.com\"},\"description\":{\"default_value\":\"Access to New Deal Art sites\",\"key\":\"tool.vendor.description\"},\"vendor_name\":{\"default_value\":\"Ndar\",\"key\":\"tool.vendor.name\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\",\"website\":\"{tp_deployment_url}\"}},\"product_name\":{\"default_value\":\"NDAR\",\"key\":\"tool.name\"},\"product_version\":\"10.3\",\"technical_description\":{\"default_value\":\"Support provided for all LTI 1 extensions as well as LTI 2\",\"key\":\"tool.technical\"}},\"service_provider\":{\"description\":{\"default_value\":\"Provider of high performance managed hosting environments\",\"key\":\"service_provider.description\"},\"guid\":\"18e7ea50-3d6d-4f6b-aff2-ed3ab577716c\",\"service_provider_name\":{\"default_value\":\"Amazon Cloud\",\"key\":\"service_provider.name\"},\"support\":{\"email\":\"support@ec2.fabericious.com\"},\"timestamp\":\"2012-04-05T09:08:16-04:00\"},\"support\":{\"email\":\"helpdesk@fabericious.com\"}},\"resource_handler\":[{\"description\":{\"default_value\":\"Ndar service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\"],\"path\":\"/ndar\"}],\"resource_name\":{\"default_value\":\"NDAR\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"setting\"}},{\"description\":{\"default_value\":\"Echo service\",\"key\":\"resource.description\"},\"message\":[{\"message_type\":\"basic-lti-launch-request\",\"parameter\":[{\"fixed\":\"Narcissus\",\"name\":\"referrer\"},{\"fixed\":\"3.14159\",\"name\":\"pi\"},{\"name\":\"user_primary_email\",\"variable\":\"Person.email.primary\"}],\"enabled_capability\":[\"User.id\",\"Membership.role\",\"Person.name.family\",\"Person.name.given\",\"Person.email.primary\",\"Person.email.primary\"],\"path\":\"/echo\"}],\"resource_name\":{\"default_value\":\"EchoPHP\",\"key\":\"resource.name\"},\"resource_type\":{\"code\":\"echo\"}}],\"service_offered\":[{\"@id\":\"{tp_deployment_url}/lti2_tp/ToolProxy.collection\",\"@type\":\"RestService\",\"action\":[\"PUT\"],\"endpoint\":\"{tp_deployment_url}/lti2_tp/tool_proxies\",\"format\":[\"\"]}]},\"security_contract\":{\"shared_secret\":\"5dbc63499707fdd1e786ece9c3ba3226\",\"tool_service\":[{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.collection\",\"action\":[\"POST\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxy.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:Result.item\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:LtiLinkSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxyBindingSettings\",\"action\":[\"GET\",\"PUT\"]},{\"@type\":\"RestServiceProfile\",\"service\":\"ltitcp:ToolProxySettings\",\"action\":[\"GET\",\"PUT\"]}]}}', `updated_at` = '2016-01-24 01:23:38' WHERE `lti2_tp_registrations`.`id` = 142[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `lti2_tp_registrations` SET `status` = 'register', `tool_proxy_response` = '{\"@context\":\"http://purl.imsglobal.org/ctx/lti/v2/ToolProxyId\",\"@type\":\"ToolProxy\",\"@id\":null,\"tool_proxy_guid\":\"ffb565e0-a466-0133-b25f-20c9d07c6451\"}', `updated_at` = '2016-01-24 01:23:38' WHERE `lti2_tp_registrations`.`id` = 142
  [1m[36m (12.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mTenant Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `tenants`  WHERE (`tenants`.`tenant_name` = BINARY 'ffb565e0-a466-0133-b25f-20c9d07c6451' AND `tenants`.`id` != 53) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `tenants` SET `secret` = '5dbc63499707fdd1e786ece9c3ba3226', `updated_at` = '2016-01-24 01:23:38' WHERE `tenants`.`id` = 53
  [1m[36m (11.6ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `lti2_tp_registrations` SET `final_secret` = '5dbc63499707fdd1e786ece9c3ba3226', `tenant_id` = 53, `updated_at` = '2016-01-24 01:23:38' WHERE `lti2_tp_registrations`.`id` = 142[0m
  [1m[35m (0.8ms)[0m  COMMIT
Redirected to http://kinexis8888.ngrok.io/lti2_tp/registrations?status=success&tool_proxy_guid=ffb565e0-a466-0133-b25f-20c9d07c6451&&id=142
Completed 302 Found in 795ms (ActiveRecord: 32.6ms)


Started GET "/lti2_tp/registrations?status=success&tool_proxy_guid=ffb565e0-a466-0133-b25f-20c9d07c6451&&id=142" for 74.95.0.173 at 2016-01-23 17:23:38 -0800
Processing by Lti2Tp::RegistrationsController#index as HTML
  Parameters: {"status"=>"success", "tool_proxy_guid"=>"ffb565e0-a466-0133-b25f-20c9d07c6451", "id"=>"142"}
  [1m[36mLti2Tp::Registration Load (0.4ms)[0m  [1mSELECT  `lti2_tp_registrations`.* FROM `lti2_tp_registrations`  WHERE `lti2_tp_registrations`.`id` = 142 LIMIT 1[0m
Redirected to http://kinexis3000.ngrok.io/admin/tool_actions?status=success&tool_proxy_guid=ffb565e0-a466-0133-b25f-20c9d07c6451
Completed 302 Found in 2ms (ActiveRecord: 0.4ms)


Started GET "/search?q=polska+najlepsza&num=100&start=100" for 188.68.224.62 at 2016-01-23 17:24:47 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (36.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (155.1ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 17:24:47 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (113.0ms)


Started GET "/search?q=praca&num=100&start=100" for 188.68.224.62 at 2016-01-23 17:40:21 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.4ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 17:40:21 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.2ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 19:25:47 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (113.1ms)


Started GET "/search?q=polska+najlepsza&num=100&start=100" for 188.68.224.62 at 2016-01-23 19:25:48 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (114.8ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 19:41:21 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (112.4ms)


Started GET "/search?q=wakacje&num=100&start=100" for 188.68.224.62 at 2016-01-23 19:41:21 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.7ms)


Started GET "/search?q=wakacje&num=100&start=100" for 188.68.224.62 at 2016-01-23 21:28:48 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (9.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (3.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (135.8ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 21:28:48 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (108.8ms)


Started GET "/search?q=wczasy&num=100&start=100" for 188.68.224.62 at 2016-01-23 21:45:11 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (4.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (7.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (869.1ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-23 21:46:12 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (10.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (170.2ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 00:29:49 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (113.7ms)


Started GET "/search?q=wakacje&num=100&start=100" for 188.68.224.62 at 2016-01-24 00:29:49 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (114.0ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 02:30:49 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (116.0ms)


Started GET "/search?q=praca&num=100&start=100" for 188.68.224.62 at 2016-01-24 02:31:00 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (111.1ms)


Started GET "/search?q=wczasy&num=100&start=100" for 188.68.224.62 at 2016-01-24 04:00:07 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (119.7ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 04:00:07 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (116.7ms)


Started GET "/search?q=google&num=100&start=100" for 188.68.224.62 at 2016-01-24 04:32:02 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.4ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 04:40:19 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (120.9ms)


Started GET "/search?q=wczasy&num=100&start=100" for 188.68.224.62 at 2016-01-24 06:01:01 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (7.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (12.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (662.4ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 06:01:03 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (12.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (24.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (8.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (734.7ms)
  [1m[36mLti2Tp::Registry Load (0.3ms)[0m  [1mSELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`[0m
  [1m[35mLti2Tp::Registry Load (0.2ms)[0m  SELECT `lti2_tp_registries`.* FROM `lti2_tp_registries`


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 07:44:48 -0800
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (9.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (134.5ms)


Started GET "/search?q=wp.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 07:44:49 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.9ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 08:02:11 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (140.3ms)


Started GET "/search?q=polska+najlepsza&num=100&start=100" for 188.68.224.62 at 2016-01-24 08:02:11 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (138.4ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 09:45:50 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (8.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (131.8ms)


Started GET "/search?q=wczasy&num=100&start=100" for 188.68.224.62 at 2016-01-24 09:45:50 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (127.8ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 11:20:49 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (110.9ms)


Started GET "/search?q=onet.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 11:20:50 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (112.8ms)


Started GET "/search?q=wp.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 11:46:49 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (109.0ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 11:46:49 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (107.5ms)


Started GET "/search?q=polska+najlepsza&num=100&start=100" for 188.68.224.62 at 2016-01-24 13:21:49 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (127.5ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 13:21:50 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (114.6ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 14:51:24 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (7.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (8.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (138.7ms)


Started GET "/search?q=wp.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 14:51:24 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (2.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (126.9ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 15:22:49 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (6.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (14.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (151.5ms)


Started GET "/search?q=wakacje&num=100&start=100" for 188.68.224.62 at 2016-01-24 15:22:49 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (13.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (124.3ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 16:52:23 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (5.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (9.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (6.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (160.1ms)


Started GET "/search?q=onet.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 16:52:24 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (119.7ms)


Started GET "/search?q=praca&num=100&start=100" for 188.68.224.62 at 2016-01-24 18:53:23 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (6.6ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (6.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (139.2ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 18:53:23 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (3.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (4.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.7ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (125.0ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 21:21:25 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (4.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (7.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (2.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (6.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (146.3ms)


Started GET "/search?q=onet.pl&num=100&start=100" for 188.68.224.62 at 2016-01-24 21:21:25 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (4.2ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.9ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (1.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.0ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (129.7ms)


Started GET "/httptest.php" for 188.68.224.62 at 2016-01-24 23:09:13 -0800

ActionController::RoutingError (No route matches [GET] "/httptest.php"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (5.5ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (1.4ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (119.4ms)


Started GET "/search?q=google&num=100&start=100" for 188.68.224.62 at 2016-01-24 23:09:14 -0800

ActionController::RoutingError (No route matches [GET] "/search"):
  actionpack (4.1.9) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'
  railties (4.1.9) lib/rails/rack/logger.rb:38:in `call_app'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `block in call'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `block in tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:26:in `tagged'
  activesupport (4.1.9) lib/active_support/tagged_logging.rb:68:in `tagged'
  railties (4.1.9) lib/rails/rack/logger.rb:20:in `call'
  quiet_assets (1.1.0) lib/quiet_assets.rb:27:in `call_with_quiet_assets'
  actionpack (4.1.9) lib/action_dispatch/middleware/request_id.rb:21:in `call'
  rack (1.5.2) lib/rack/methodoverride.rb:21:in `call'
  rack (1.5.2) lib/rack/runtime.rb:17:in `call'
  activesupport (4.1.9) lib/active_support/cache/strategy/local_cache_middleware.rb:26:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  actionpack (4.1.9) lib/action_dispatch/middleware/static.rb:84:in `call'
  rack (1.5.2) lib/rack/sendfile.rb:112:in `call'
  railties (4.1.9) lib/rails/engine.rb:514:in `call'
  railties (4.1.9) lib/rails/application.rb:144:in `call'
  rack (1.5.2) lib/rack/lock.rb:17:in `call'
  rack (1.5.2) lib/rack/content_length.rb:14:in `call'
  rack (1.5.2) lib/rack/handler/webrick.rb:60:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:138:in `service'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/httpserver.rb:94:in `run'
  /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/2.2.0/webrick/server.rb:294:in `block in start_thread'


  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.1ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (3.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_route.html.erb (0.8ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/routes/_table.html.erb (4.3ms)
  Rendered /Users/johntibbetts/.rbenv/versions/2.2.2/lib/ruby/gems/2.2.0/gems/actionpack-4.1.9/lib/action_dispatch/middleware/templates/rescues/routing_error.html.erb within rescues/layout (113.5ms)
